!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Scintilla",[],t):"object"==typeof exports?exports.Scintilla=t():e.Scintilla=t()}(window,function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=41)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._content={},this._size=0}return i(e,[{key:"set",value:function(e,t){return this.has(e)||this._size++,this._content[e]=t,this}},{key:"get",value:function(e){return this.has(e)?this._content[e]:null}},{key:"has",value:function(e){return this._content.hasOwnProperty(e)}},{key:"contains",value:function(e){for(var t in this._content)if(entries[t]===e)return!0;return!1}},{key:"keys",value:function(){return Object.keys(this._content)}},{key:"values",value:function(){var e=[],t=this._content;for(var n in t)e.push(entries[n]);return e}},{key:"remove",value:function(e){if(!this.has(e))return null;var t=this._content[e];return delete this._content[e],this._size--,t}},{key:"delete",value:function(e){return!!this.has(e)&&(delete this._content[e],this._size--,!0)}},{key:"deleteAt",value:function(e){this._size--,delete this._content[e]}},{key:"deleteByIndexedArray",value:function(e){for(var t=0;t<e.length;t++)delete this._content[e[t]],this._size--}},{key:"clear",value:function(){for(var e in this._content)delete this._content[e];this._size=0}},{key:"slowSize",value:function(){return Object.keys(_contents).length}},{key:"each",value:function(e){var t=this._content;for(var n in t)if(!1===e(n,t[n]))break;return this}},{key:"size",get:function(){return this._size}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LOADER_STATE=t.AssetTypeHandler=void 0;var i,s=(i=n(34))&&i.__esModule?i:{default:i};t.AssetTypeHandler=new s.default,t.LOADER_STATE={NONE:0,IDLE:1,PENDING:2,LOADING:3,PROCESSING:4,ERROR:5,FINISHED:6,DONE:7}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,[{key:"isFunction",value:function(e){return!!(e&&e.constructor&&e.call&&e.apply)}},{key:"getValue",value:function(e,t,n){var s=void 0===e?"undefined":i(e);return e&&"number"!==s&&"string"!==s&&e.hasOwnProperty(t)&&void 0!==e[t]?e[t]:n}},{key:"getPropertyValue",value:function(e,t,n){if(e&&"number"!=typeof e){if(e.hasOwnProperty(t))return e[t];if(t.indexOf(".")){for(var i=t.split("."),s=e,a=n,r=0;r<i.length;r++){if(!s.hasOwnProperty(i[r])){a=n;break}a=s[i[r]],s=s[i[r]]}return a}return n}return n}},{key:"getFileExtension",value:function(e){return e.substring(e.lastIndexOf(".")+1,e.length)||""}},{key:"getURL",value:function(e,t){return e?e.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)?e:t+e:null}}]),e}();t.default=new a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.default=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"createFileRequest",value:function(t,n){var i=e.merge(n,t.xhrSettings),s=new XMLHttpRequest;return s.open("GET",t.source,i.async),s.responseType=t.xhrSettings.responseType,s.timeout=i.timeout,s.onload=t.onLoad.bind(t),s.onerror=t.onError.bind(t),s.onprogress=t.onProgress.bind(t),s.send(),s}},{key:"createSettings",value:function(e,t,n){return void 0===e&&(e=""),void 0===t&&(t=!0),void 0===n&&(n=0),{responseType:e,timeout:n,async:t}}},{key:"merge",value:function(t,n){var i={};if(void 0===t&&(i=e.createSettings()),n)for(var s in n)void 0!==n[s]&&(i[s]=n[s]);return i}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=o(n(11)),a=o(n(0)),r=o(n(12));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.context=t.context,this.active=!0,this._keyMapping=new a.default,this._keyWatch=new a.default,this._keyGarbage=[],this.lastKey=null,this._onKeyDown=null,this._onKeyUp=null,this._onKeyPress=null,this.reset()}return i(e,[{key:"reset",value:function(){for(var e in this._keyMapping.clear(),this._keyWatch.clear(),this._keyGarbage=[],r.default)if(r.default.hasOwnProperty(e)){var t=r.default[e];this._keyMapping.set(t,new s.default(t,this.game))}}},{key:"init",value:function(){var e=this;this.reset(),this._onKeyDown=function(t){return e.processKeyDown(t)},this._onKeyUp=function(t){return e.processKeyUp(t)},window.addEventListener("keydown",this._onKeyDown,!1),window.addEventListener("keyup",this._onKeyUp,!1)}},{key:"stop",value:function(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this._onKeyDown=null,this._onKeyUp=null,this._onKeyPress=null,this._keyMapping.clear()}},{key:"processKeyUp",value:function(e){var t=e.keyCode;e.preventDefault(),this.active&&this._keyMapping.get(t).onKeyUp()}},{key:"processKeyDown",value:function(e){var t=e.keyCode;if(e.preventDefault(),this.active){this.lastKey=t;var n=this._keyMapping.get(t);n.onKeyDown(),this._keyWatch.has(t)||this._keyWatch.set(t,n)}}},{key:"update",value:function(){var e=this;this._keyWatch.each(function(t,n){n.update(),n.event()==KeyEvent.IDLE&&e._keyGarbage.push(t)}),this._keyGarbage.length>0&&(this._keyWatch.deleteByIndexedArray(this._keyGarbage),this._keyGarbage.splice(0,this._keyGarbage.length))}},{key:"pressed",value:function(e){return this._keyMapping.get(e).isPressed()}},{key:"release",value:function(e){return this._keyMapping.get(e).isReleased()}},{key:"press",value:function(e){return this._keyMapping.get(e).status}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=n,this.game=t,this.__enable=!0,this.__renderers=[],this.__isDirty=!0}return i(e,[{key:"add",value:function(e){void 0!==e&&(this.__renderers.push(e),this.renderer.__renderLayer=this,this.__isDirty=!0)}},{key:"remove",value:function(e){var t=this.__renderers.indexOf(e);if(-1!==t)return this.removeChildAt(t)}},{key:"removeAt",value:function(e){var t=this.getChildAt(e);return this.__renderers.splice(e,1),t}},{key:"at",value:function(e){if(e<0||e>=this.__renderers.length)throw new Error("RenderLayer.at: Renderer at "+e+' does not exist in the render layer list: "'+name+'".');return this.__renderers[e]}},{key:"render",value:function(){if(this.__enable){this.__isDirty&&(this._updateDepth(),this.__isDirty=!1);for(var e=0;e<this.__renderers.length;e++)this.__renderers[e].render(this.game.context)}}},{key:"clear",value:function(){this.__renderers.splice(0,this.__renderers.length)}},{key:"_updateDepth",value:function(){this.__renderers.sort(function(e,t){return e.depth>t.depth?1:e.depth<t.depth?-1:e.z>t.z?1:-1})}},{key:"length",get:function(){return this.__renderers.length}},{key:"name",get:function(){return this._name}},{key:"enable",get:function(){return this.__enable},set:function(e){(e=!!e)!==this._enabled&&(this._enabled=e)}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.default=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,null,[{key:"create",value:function(t,n,i){var s={width:n,height:i,id:Math.random().toString(36).substr(2,9),class:"",container:"body",style:"padding: 0;margin: auto;display: block;top: 0; bottom: 0;left: 0;right: 0;border:1px solid #d3d3d3;background-color: #f1f1f1;"},a=void 0;return(a=document.createElement("canvas")).setAttribute("id",s.id),a.setAttribute("width",s.width),a.setAttribute("height",s.height),a.setAttribute("style",s.style),e.appendDOM(a,t),a}},{key:"appendDOM",value:function(e,t){var n=null;t&&("string"==typeof t?n=document.getElementById(t):"object"===(void 0===t?"undefined":i(t))&&1===t.nodeType&&(n=t)),n||(n=document.body),n.appendChild(e)}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(1),a=u(n(13)),r=u(n(3)),o=u(n(2));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.cache=t.cache,this._filesQueue=new a.default,this._successFiles=new a.default,this._failedFiles=new a.default,this._processedFiles=new a.default,this._filesQueueCount=0,this._loadedFilesCount=0,this.isDownloading=!1,this._totalFiles=0;var n=t.config.loader;this.xhr=r.default.createSettings(o.default.getValue(config,"responseType",n.responseType),o.default.getValue(config,"async",n.async),o.default.getValue(config,"timeout",n.timeout)),this.progress=0,this.path="",this.baseURL="",this.state=s.LOADER_STATE.IDLE,s.AssetTypeHandler.inject(this)}return i(e,[{key:"setPath",value:function(e){return""!==e&&"/"!==e.substr(-1)&&(e=e.concat("/")),this.path=e,this}},{key:"setBaseURL",value:function(e){return""!==e&&"/"!==e.substr(-1)&&(e=e.concat("/")),this.baseURL=e||"",this}},{key:"addAsset",value:function(e){return this.isOK()?(e.path=this.path,this._filesQueue.set(e),this._filesQueueCount++,e):-1}},{key:"reset",value:function(){this.isDownloading=!1,this._filesQueue.clear(),this._successFiles.clear(),this._failedFiles.clear(),this._processedFiles.clear(),this._filesQueueCount=0,this._loadedFilesCount=0,this.progress=0,this.state=s.LOADER_STATE.IDLE}},{key:"start",value:function(){if(!this.isOK())return-1;this.progress=0,this._loadedFilesCount=0,this.state=s.LOADER_STATE.LOADING,this._filesQueueCount=this._filesQueue.size,0===this._filesQueue.size?(console.log(0),this.loadFinished()):(this.isDownloading=!0,this._successFiles.clear(),this._failedFiles.clear(),this.processFileQueue())}},{key:"processFileQueue",value:function(){var e=this;this._filesQueue.each(function(t){t.state!==s.LOADER_STATE.FINISHED&&t.state!==s.LOADER_STATE.PENDING||t.load(e)})}},{key:"next",value:function(e,t){t?this._failedFiles.set(e):this._successFiles.set(e),this._filesQueue.delete(e),this._loadedFilesCount++,this.updateProgress(),this._loadedFilesCount<this._filesQueueCount?(console.log("asdasd"),this.processFileQueue()):this.loadFinished()}},{key:"loadFinished",value:function(){this.state!==s.LOADER_STATE.PROCESSING&&(this.progress=1,this.isDownloading=!1,this.state=s.LOADER_STATE.PROCESSING,this._processedFiles.clear(),0===this._successFiles.size?this.processingDone():(console.log("asdasd"),this._successFiles.each(function(e){e.onProcessing(this.processingUpdate.bind(this))},this)))}},{key:"processingUpdate",value:function(e){return e.state===s.LOADER_STATE.ERROR?(this._failedFiles.set(e),this.deleteFromSuccessQueue(e)):(this._processedFiles.set(e),this.deleteFromSuccessQueue(e))}},{key:"deleteFromSuccessQueue",value:function(e){this._successFiles.delete(e),0===this._successFiles.size&&this.state===s.LOADER_STATE.PROCESSING&&this.processingDone()}},{key:"processingDone",value:function(){console.log("done"),this._successFiles.clear(),this._filesQueue.clear();var e=this.game.cache;this._processedFiles.size>0&&(this._processedFiles.each(function(t){switch(t.type){case"image":e.addImage(t.tag,t.url,t.data);break;case"audio":t.data=requestXHR.response,e.addSound(t.tag,t.url,t.data,!0),t.autoDecode&&this.game.sound.decode(t.tag)}}),this._processedFiles.clear()),this.state=s.LOADER_STATE.DONE,this.game.scene.preloadComplete(),console.log("asdasd")}},{key:"isLoading",value:function(){return this.state===s.LOADER_STATE.LOADING||this.state===s.LOADER_STATE.PROCESSING}},{key:"isOK",value:function(){return this.state===s.LOADER_STATE.IDLE||this.state===s.LOADER_STATE.DONE||this.state===s.LOADER_STATE.ERROR}},{key:"downloadIsDone",value:function(){return this._filesQueue.length==this._successCount+this._fileErrorCount}},{key:"updateProgress",value:function(){0!=this._filesQueueCount&&(this.progress=1-this._loadedFilesCount/this._filesQueueCount),this.progress=0}},{key:"totalQueuedFiles",get:function(){return this._filesQueueCount-this._loadedFilesCount}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=o(n(2)),a=o(n(3)),r=n(1);function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=s.default.getValue(t,"type",null),this.tag=s.default.getValue(t,"tag",null),null==this.type||null==this.tag)throw new Error('Loader.File: Invalid tag "'+tag+'".');this.url=s.default.getValue(t,"url",null),void 0===this.url?this.url=s.default.getValue(t,"path","")+this.tag+"."+s.default.getValue(t,"ext",""):this.url=s.default.getValue(t,"path","").concat(this.url),this.xhrSettings=a.default.createSettings(s.default.getValue(t,"responseType",void 0)),s.default.getValue(t,"xhrSettings",!1)&&(this.xhrSettings=a.default.merge(this.xhrSettings,s.default.getValue(t,"xhrSettings",{}))),console.log(this.xhrSettings),this.loader=null,this.state=r.LOADER_STATE.PENDING,this.totalBytes=0,this.loadedBytes=0,this.progress=0,this.data=void 0,this.source=null,this.xhrRequest=null,this.config=s.default.getValue(t,"config",{}),this.crossOrigin=void 0}return i(e,[{key:"load",value:function(e){this.loader=e,this.state===r.LOADER_STATE.FINISHED?(this.onDone(),this.loader.nextFile(this)):(this.source=s.default.getURL(this.url,e.baseURL),0===this.source.indexOf("data:")||null==this.source?console.warn("Loader.File.load: unsupported URI."):this.xhrRequest=a.default.createFileRequest(this,e.xhr))}},{key:"onLoad",value:function(e){this.XHRreset(),e.target&&200!==e.target.status?this.loader.next(this,!0):this.loader.next(this,!1)}},{key:"onError",value:function(){this.XHRreset(),this.loader.next(this,!0)}},{key:"onProgress",value:function(e){e.lengthComputable&&(this.loadedBytes=e.loaded,this.totalBytes=e.total,this.progress=Math.min(this.loadedBytes/this.totalBytes,1))}},{key:"onDone",value:function(){this.state=r.LOADER_STATE.DONE}},{key:"onProcessing",value:function(e){this.state=r.LOADER_STATE.PROCESSING,this.onDone(),e(this)}},{key:"XHRreset",value:function(){this.xhrRequest.onload=void 0,this.xhrRequest.onerror=void 0,this.xhrRequest.onprogress=void 0}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=t.MathUtils={randomRange:function(e,t){return Math.random()*(t-e)+e},irandomRange:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},lerp:function(e,t,n){return(1-n)*e+n*t},lerpAngle:function(e,t,n){var i=t,s=e;Math.abs(i-s)>180&&(i>s?s+=360:i+=360);var a=s+(i-s)*n;return a>=0&&a<=360?a:a%360},distance:function(e,t,n,i){return Math.sqrt((e-=n)*e+(t-=i)*t)},angleBetween:function(e,t,n,i){var s=this.toDegree(Math.atan2(i-t,n-e));return s<0&&s>=-180&&(s=360+s),s},degToRad:Math.PI/180,radToDeg:180/Math.PI,TAU:2*Math.PI,toDegree:function(e){return e*tobiJS.Math.radToDeg},toRadian:function(e){return e*tobiJS.Math.degToRad}};e.exports=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=r(n(4)),a=r(n(37));function r(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.mouse=null,this.keyboard=null}return i(e,[{key:"init",value:function(){this.keyboard=new s.default(this.game),this.mouse=new a.default(this.game),this.keyboard.init(),this.mouse.init()}},{key:"update",value:function(){this.keyboard.update(),this.mouse.update()}},{key:"reset",value:function(){this.keyboard.reset(),this.mouse.reset()}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=t.KeyEvent={NONE:-1,IDLE:0,PRESSED:1,RELEASED:2},a=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=n,this.keyCode=t,this._enabled=!0,this.status=!1,this.press=!1,this.release=!1,this._event=s.NONE,this.pressTime=0,this.pressDuration=-2500,this.releaseTime=0,this.releaseDuration=-2500}return i(e,[{key:"onKeyDown",value:function(){this._enabled&&(this.press||(this.status=!0,this.press=!0,this.release=!1,this.pressTime=this.game.time.time,this.pressDuration=0,this.releaseDuration=this.game.time.time-this.releaseTime))}},{key:"onKeyUp",value:function(){this._enabled&&(this.release||(this.status=!1,this.press=!1,this.release=!0,this.releaseTime=this.game.time.time,this.pressDuration=this.game.time.time-this.pressTime,this.releaseDuration=0))}},{key:"update",value:function(){this._enabled&&(this.press?this.pressDuration=this.game.time.time-this.pressTime:this.releaseDuration=this.game.time.time-this.releaseTime,this.press?0==this.pressDuration&&(this._event=s.PRESSED):0==this.releaseDuration?this._event=s.RELEASED:this._event=s.IDLE,this._event==s.IDLE&&(this._event=s.NONE))}},{key:"isPressing",value:function(){return this.status}},{key:"isPressed",value:function(){return this.press&&0==this.pressDuration}},{key:"isReleased",value:function(){return!this.press&&0==this.releaseDuration}},{key:"event",value:function(){return this._event}},{key:"reset",value:function(){this.status=!1,this._event=s.NONE,this.press=!1,this.release=!1,this.pressTime=0,this.pressDuration=-2500,this.releaseTime=0,this.releaseDuration=-2500}},{key:"enabled",get:function(){return this._enabled},set:function(e){(e=!!e)!==this._enabled&&(e||this.reset(),this._enabled=e)}}]),e}();t.default=a},function(e,t,n){"use strict";e.exports={Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,Pause:19,CapsLock:20,Escape:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Delete:46,Num0:48,Num1:49,Num2:50,Num3:51,Num4:52,Num5:53,Num6:54,Num7:55,Num8:56,Num9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LSystem:91,RSystem:92,SelectK:93,Numpad0:96,Numpad1:97,Numpad2:98,Numpad3:99,Numpad4:100,Numpad5:101,Numpad6:102,Numpad7:103,Numpad8:104,Numpad9:105,Multiply:106,Add:107,Subtract:109,DecimalPoint:110,Divide:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NumLock:144,ScrollLock:145,SemiColon:186,Equal:187,Comma:188,Dash:189,Period:190,Slash:191,LBraket:219,BackSlash:220,RBracket:221,Quote:222}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._content=[],this._size=0,Array.isArray(t))for(var n=0;n<t.length;n++)this.set(t[n])}return i(e,[{key:"set",value:function(e){return-1===this._content.indexOf(e)&&this._content.push(e),this}},{key:"at",value:function(e){var t=this._content.indexOf(e);return t>-1?this._content[t]:null}},{key:"has",value:function(e){return this._content.indexOf(e)>-1}},{key:"delete",value:function(e){var t=this._content.indexOf(e);return t>-1&&this._content.splice(t,1),this}},{key:"clear",value:function(){return this._content.length=0,this}},{key:"each",value:function(e,t){var n,i=this._content.slice(),s=i.length;if(t)for(n=0;n<s&&!1!==e.call(t,i[n],n);n++);else for(n=0;n<s&&!1!==e(i[n],n);n++);return this}},{key:"size",get:function(){return this._content.length}},{key:"length",get:function(){return this._content.length}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=t.Color={webRGB:function(e,t,n,i){return"rgba("+e.toString()+","+t.toString()+","+n.toString()+","+(i/255).toString()+")"},HSLtoRGB:function(e,t,n,i){var s=255;void 0===i&&null===i||(s=i),e/=255;var a={r:n/=255,b:n,g:n};if(0!=(t/=255)){var r=n<.5?n*(1+t):n+t-n*t,o=2*n-r;a.r=this.hueToColor(o,r,e+1/3),a.g=this.hueToColor(o,r,e),a.b=this.hueToColor(o,r,e-1/3)}return a.r=Math.floor(255*a.r),a.g=Math.floor(255*a.g),a.b=Math.floor(255*a.b),this.webRGB(a.r,a.g,a.b,s)},hueToColor:function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},RGBtoHex:function(e,t,n){return"#"+this.componentToHex(e)+this.componentToHex(t)+this.componentToHex(n)},componentToHex:function(e){var t=e.toString(16);return 1==t.length?"0"+t:t}};e.exports=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.draw=t.draw,this.context=t.render.context,this.x=8,this.y=12,this.lineHeight=14,this.column=100,this.font="12px Verdana",this.textColor="white",this.bgcolor="black",this.textShadow="black"}return i(e,[{key:"test",value:function(){this.context.setTransform(1,0,0,1,0,0),this.context.strokeStyle=this.bgcolor,this.context.font=this.font,this.draw.alpha(.5),this.draw.rectangle(0,0,this.game.width,72,this.bgcolor),this.draw.alpha(1),this.drawLine("FPS: "+Math.round(this.game.time.fps)+" / 60"),this.drawLine("Colliders count "+this.game.physics.length),this.x+=this.game.width/2,this.y=20,this.x=8,this.y=20}},{key:"drawLine",value:function(e){var t=this.x;this.context.fillStyle=this.textShadow,this.context.fillText(e,t+1,this.y+1),this.context.fillStyle=this.textColor,this.context.fillText(e,t,this.y),this.y+=this.lineHeight}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.a=null,this.b=null,this.overlapN=new scintilla.Vector,this.overlapV=new scintilla.Vector,this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this.indexShapeA=-1,this.indexShapeB=-1,this.clear()}return i(e,[{key:"clear",value:function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this.indexShapeA=-1,this.indexShapeB=-1,this}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=(i=n(9))&&i.__esModule?i:{default:i},r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._x=t||0,this._y=n||0}return s(e,[{key:"set",value:function(e,t){this._x=e,this._y=t||e}},{key:"move",value:function(e,t){this._x+=e,this._y+=t}},{key:"scale",value:function(e,t){return this._x*=e,this._y*=t||e,this}},{key:"rotate",value:function(e){var t=this._x,n=this._y;return this._x=t*Math.cos(e)-n*Math.sin(e),this._y=t*Math.sin(e)+n*Math.cos(e),this}},{key:"rotateAround",value:function(e,t){var n=this._x-t.x,i=this._y-t.y,s=Math.cos(e),a=Math.sin(e);return this._x=t.x+(s*n-a*i),this._y=t.y+(a*n+s*i),this}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this}},{key:"normalize",value:function(){var e=this.length();return e>0&&(this._x=this._x/e,this._y=this._y/e),this}},{key:"reverse",value:function(){return this._x=-this._x,this._y=-this._y,this}},{key:"add",value:function(e){return this._x+=e.x,this._y+=e.y,this}},{key:"sub",value:function(e){return this._x-=e.x,this._y-=e.y,this}},{key:"perp",value:function(){var e=this._x;return this._x=this._y,this._y=-e,this}},{key:"dot",value:function(t){return e.dot(this,t)}},{key:"project",value:function(t){return e.project(this,t)}},{key:"clone",value:function(){return new e(this._x,this._y)}},{key:"length",value:function(){return Math.sqrt(this.squaredLenght())}},{key:"squaredLenght",value:function(){return e.dot(this,this)}},{key:"x",set:function(e){return this._x=e,this._x},get:function(){return this._x}},{key:"y",set:function(e){return this._y=e,this._y},get:function(){return this._y}},{key:"magnitude",get:function(){return Math.sqrt(this._x*this._x+this._y*this._y)}},{key:"normal",get:function(){var e=this.magnitude;return new tobiJS.Vector(this._x/e,this._y/e)}}],[{key:"scalar",value:function(e,t){return e.x*t.y-e.y*t.x}},{key:"distance",value:function(e,t){return a.default.distance(e.x,e.y,t.x,t.y)}},{key:"angleBetween",value:function(e,t){return a.default.angleBetween(e.x,e.y,t.x,t.y)}},{key:"dot",value:function(e,t){return e.x*t.x+e.y*t.y}},{key:"project",value:function(t,n){var i=e.dot(t,n);return new e(i/(n.x*n.x+n.y*n.y)*n.x,i/(n.x*n.x+n.y*n.y)*n.y)}},{key:"projectNormal",value:function(t,n){var i=e.dot(t,n);return new e(i/n.x,i/n.y)}},{key:"reflect",value:function(t,n){var i=e.project(t,n);return i.scale(2),i.sub(t),i}},{key:"reflectNormal",value:function(t,n){var i=e.projectNormal(t,n);return i.scale(2),i.sub(t),i}},{key:"lerp",value:function(t,n,i){return new e(a.default.lerp(t.x,n.x,i),a.default.lerp(t.y,n.y,i))}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=(i=n(17))&&i.__esModule?i:{default:i},r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.VECTORS=[];for(var t=0;t<10;t++)VECTORS.push(new a.default);this.ARRAYS=[];for(var n=0;n<5;n++)ARRAYS.push([])}return s(e,[{key:"flattenPointsOn",value:function(e,t,n){for(var i=Number.MAX_VALUE,s=-Number.MAX_VALUE,a=e.length,r=0;r<a;r++){var o=e[r].dot(t);o<i&&(i=o),o>s&&(s=o)}n[0]=i,n[1]=s}},{key:"isSeparatingAxis",value:function(e,t,n,i,s,a){var r=ARRAYS.pop(),o=ARRAYS.pop(),u=VECTORS.pop().copy(t).sub(e),l=u.dot(s);if(flattenPointsOn(n,s,r),flattenPointsOn(i,s,o),o[0]+=l,o[1]+=l,r[0]>o[1]||o[0]>r[1])return VECTORS.push(u),ARRAYS.push(r),ARRAYS.push(o),!0;if(a){var h,c,f=0;r[0]<o[0]?(a.aInB=!1,r[1]<o[1]?(f=r[1]-o[0],a.bInA=!1):f=(h=r[1]-o[0])<(c=o[1]-r[0])?h:-c):(a.bInA=!1,r[1]>o[1]?(f=r[0]-o[1],a.aInB=!1):f=(h=r[1]-o[0])<(c=o[1]-r[0])?h:-c);var d=Math.abs(f);d<a.overlap&&(a.overlap=d,a.overlapN.copy(s),f<0&&a.overlapN.reverse())}return VECTORS.push(u),ARRAYS.push(r),ARRAYS.push(o),!1}},{key:"testPolygonPolygon",value:function(e,t,n){for(var i=e.shape.getPoints(),s=e.shape.getNormals(),a=s.length,r=t.shape.getPoints(),o=t.shape.getNormals(),u=o.length;a--;)if(isSeparatingAxis(e.position,t.position,i,r,s[a],n))return!1;for(;u--;)if(isSeparatingAxis(e.position,t.position,i,r,o[u],n))return!1;return n&&(n.a=e,n.b=t,n.overlapV.copy(n.overlapN).scale(n.overlap)),!0}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=r(n(18)),a=r(n(16));function r(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=null,this.sat=null,this.response=null,this.game=t,this.colliadables=[]}return i(e,[{key:"init",value:function(){this.sat=new s.default,this.response=new a.default}},{key:"getColliadables",value:function(){return this.colliadables}},{key:"addColliderObj",value:function(e){this.colliadables.push(e)}},{key:"removeColliderObj",value:function(e){var t=this.colliadables.indexOf(e);-1!=t&&this.colliadables.splice(t,1)}},{key:"clear",value:function(){this.colliadables=[],this.colliadables.length=0}},{key:"update",value:function(e){var t=this.colliadables.length;if(!(t<2))for(var n=0;n<t;n++){var i=this.colliadables[n],s=i.shape;if(!i._gameObject._selfDestroy&&i._gameObject.active){var a=n+1;if(a>=t)break;for(var r=a;r<t;r++){var o=this.colliadables[r],u=o.shape;!o._gameObject._selfDestroy&&o._gameObject.active&&o.bounds.box.intersects(i.bounds.box)&&!0===this.sat["test"+s.getType()+u.getType()].call(this,i,o,this.response.clear())&&(i._gameObject.onCollision&&i._gameObject.onCollision(o._gameObject,this.response),o._gameObject.onCollision&&o._gameObject.onCollision(i._gameObject,this.response))}}}}},{key:"length",get:function(){return this.colliadables.length}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n;n=void 0===t?null:t,this.game=n,this.camera=null,this.x=0,this.y=0,this.width=0,this.height=0,this.view=0,null!=n&&(this.width=n.width,this.height=n.height)}return i(e,[{key:"instanceDestroy",value:function(e){e.destroy&&e.destroy();var t=this.instances.indexOf(e);this.instances.splice(t,1)}},{key:"addGameObject",value:function(e,t){var n=void 0;return(n=0==arguments.length?new scintilla.GameObject:void 0!==t&&t?e.clone():e)._id=this.instances.length,n._game=this.game,this.instances.push(n),n.start(),n}},{key:"setBounds",value:function(e,t,n,i){this.x=e,this.y=t,this.width=n,this.height=i}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=r(n(0)),a=r(n(20));function r(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this._scenes=new s.default,this.current_scene_name="",this.change_scene=null,this._setup=!1,this._clearCache=!1,this.current_scene=null,this.onStartCallback=null,this.onLoadingCallback=null,this.onLoadingRenderCallback=null,this.onPreloadCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onDestroyCallback=null}return i(e,[{key:"add",value:function(e,t){var n;scintilla.Scene.prototype.isPrototypeOf(t)?(n=t).game=this.game:n=null,null!=n&&this._scenes.set(e,n)}},{key:"new",value:function(e){if(this._scenes.has(e))throw'Could not create new Scene. The scene name "'+name+'" already exists.';var t=new a.default(this.game);return this._scenes.set(e,t),t}},{key:"set",value:function(e,t){void 0===t&&(t=!1),this.change_scene=e,this._clearCache=t}},{key:"restart",value:function(e){void 0===e&&(e=!1),this.change_scene=this.current_scene_name,this._clearCache=e}},{key:"remove",value:function(e){this.current_scene_name===e&&(this.current_scene=null,this.onStartCallback=null,this.onLoadingCallback=null,this.onLoadingRenderCallback=null,this.onPreloadCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onDestroyCallback=null),delete this.scenes[e]}},{key:"setupScene",value:function(e){this.current_scene=this._scenes.get(e),this.onStartCallback=this.current_scene.start||null,this.onLoadingCallback=this.current_scene.loading||null,this.onLoadingRenderCallback=this.current_scene.loadingRender||null,this.onPreloadCallback=this.current_scene.preload||null,this.onUpdateCallback=this.current_scene.update||null,this.onRenderCallback=this.current_scene.render||null,this.onDestroyCallback=this.current_scene.destroy||null,this.current_scene_name=e,this.game.time.refresh(),this._setup=!1}},{key:"clearCurrentScene",value:function(){this.current_scene_name&&(this.onDestroyCallback&&this.onDestroyCallback.call(this.current_scene,this.game),this._clearCache&&this.game.cache.clear())}},{key:"preUpdate",value:function(){if(this.game.systemInited&&null!=this.change_scene){if(this.clearCurrentScene(),this.setupScene(this.change_scene),this.current_scene_name!==this.change_scene)return;this.change_scene=null,this.onPreloadCallback?(this.game.load.reset(),this.onPreloadCallback.call(this.current_scene,this.game),0===this.game.load.totalQueuedFiles?this.preloadComplete():this.game.load.start()):this.preloadComplete()}}},{key:"preloadComplete",value:function(){!1===this._setup&&this.onLoadingCallback&&this.onLoadingCallback.call(this.current_scene,this.game),!1===this._setup&&this.onStartCallback?(this._setup=!0,this.onStartCallback.call(this.current_scene,this.game)):this._setup=!0}},{key:"update",value:function(){this._setup?this.onUpdateCallback&&this.onUpdateCallback.call(this.current_scene,this.game):this.onLoadingCallback&&this.onLoadingCallback.call(this.current_scene,this.game)}},{key:"render",value:function(){this._setup?this.onRenderCallback&&this.onRenderCallback.call(this.current_scene,this.game):this.onLoadingRenderCallback&&this.onLoadingRenderCallback.call(this.current_scene,this.game)}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.cache=t.cache,this.context=t.render.context}return i(e,[{key:"font",value:function(e,t){this.context.font=t+"px "+e}},{key:"text",value:function(e,t,n,i){void 0===i&&(i="black"),this.context.fillStyle=i,this.context.fillText(e,t,n)}},{key:"sprite",value:function(e,t,n,i){var s=this.cache.getAsset("images",e);if(null!=s){void 0===i&&(i[0]=0,i[1]=0);var a=this.context;a.save(),a.translate(t-s.width*i[0],n-s.height*i[1]),a.drawImage(s,0,0,s.width,s.height),a.restore()}}},{key:"spriteTransformed",value:function(e,t,n,i,s,a){}},{key:"rectangle",value:function(e,t,n,i,s){this.context.fillStyle=s,this.context.fillRect(e,t,n,i)}},{key:"outlineRectangle",value:function(e,t,n,i,s,a){this.context.beginPath(),this.context.lineWidth=a,this.context.setLineDash([6]),this.context.strokeStyle=s,this.context.rect(e,t,n,i),this.context.stroke()}},{key:"alpha",value:function(e){this.context.globalAlpha=e}},{key:"color",value:function(e){this.context.fillStyle=e}},{key:"boundingbox",value:function(e,t){void 0===t&&(t="black"),this.context.setTransform(1,0,0,1,0,0),this.outlineRectangle(e.min.x,e.min.y,e.max.x-e.min.x,e.max.y-e.min.y,t,2)}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RENDERING_TYPE={NEAREST:0,LINEAR:1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=r(n(0)),a=r(n(5));function r(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.__renderLayers=[],this.__renderLayersMap=new s.default,this.add("default")}return i(e,[{key:"add",value:function(e){if(this.contains(e))throw new Error('Render.add: There is already a RenderLayer called: "'+e+'".');this.__renderLayersMap.set(e,this.__renderLayers.length),this.__renderLayers.push(new a.default(this.game,e))}},{key:"remove",value:function(e){if("string"!=typeof e)throw new Error("Render.remove: The value name is not a string.");if("default"===e)throw new Error('Render.remove: You can not remove the "default" layer.');if(!this.__renderLayersMap.has(e))throw new Error('Render.remove: Could not remove layer. There is no layer named "'+e+'".');var t=this.__renderLayersMap.get(e);this.__renderLayers.splice(t,1),this.__renderLayersMap.delete(e)}},{key:"contains",value:function(e){if("string"!=typeof e)throw new Error("Render.contains: The value name is not a string.");return this.__renderLayers.indexOf(e)>-1}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=(o(n(0)),o(n(5)),o(n(24))),a=o(n(6)),r=n(23);function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this._backgroundColor="#000",this.canvas=a.default.create(this.game.parent,this.game.width,this.game.height),this.context=this.canvas.getContext("2d",{alpha:!1}),this.layer=new s.default(t),this.imageRendering=t.config.pixelelated?r.RENDERING_TYPE.NEAREST:r.RENDERING_TYPE.LINEAR,this._alpha=1,this.clear=!0}return i(e,[{key:"renderBegin",value:function(){this.clear&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.fillStyle=this._backgroundColor,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)}},{key:"renderEnd",value:function(){this.context.globalAlpha=1,this.context.globalCompositeOperation="source-over"}},{key:"render",value:function(){if(this.__enable){this.context.setTransform(1,0,0,1,0,0),1!==this._alpha&&(ctx.globalAlpha=1,this._alpha=1),this.context.globalAlpha=1,this.context.globalCompositeOperation="source-over";for(var e=0;e<this.layers.__renderLayers.length;e++)this.layers.__renderLayers[e].enable&&this.layers.__renderLayers[e].render();this.game.scene.render(),null!=this.game.debug&&(this.context.setTransform(1,0,0,1,0,0),this.game.debug.test())}}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e}},{key:"alpha",get:function(){return this._alpha},set:function(e){return this._alpha!==e&&(this.currentContext.globalAlpha=e,this._alpha=e),this._alpha}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),void 0===n&&(n=!1),this.game=t,this.isRunning=!1,this.setTimeOutMode=n,this._isTimeOutMode=!1;for(var i=["ms","moz","webkit","o"],s=0;s<i.length&&!window.requestAnimationFrame;s++)window.requestAnimationFrame=window[i[s]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[s]+"CancelAnimationFrame"];this._onLoopingCallback=null,this._timeOutCallback=null}return i(e,[{key:"start",value:function(){this.isRunning=!0;var e=this;!window.requestAnimationFrame||this.setTimeOutMode?(this._isTimeOutMode=!0,this._onLoopingCallback=function(){return e.updateTimeout()},this._timeOutCallback=window.setTimeout(this._onLoopingCallback,0)):(this._isTimeOutMode=!1,this._onLoopingCallback=function(t){return e.updateRequestAnimationFrame(t)},this._timeOutCallback=window.requestAnimationFrame(this._onLoopingCallback,this.game.canvas))}},{key:"updateRequestAnimationFrame",value:function(e){this.game.update(e),this._timeOutCallback=window.requestAnimationFrame(this._onLoopingCallback,this.game.canvas)}},{key:"updateTimeout",value:function(){this.game.update(Date.now()),this._timeOutCallback=window.setTimeout(this._onLoopingCallback,this.game.time.timeOut_toCall)}},{key:"stop",value:function(){this._isTimeOutMode?clearTimeout(this._timeOutCallback):window.cancelAnimationFrame(this._timeOutCallback),this.isRunning=!1}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.startTime=0,this.time=0,this.currentTime=0,this.previousTime=0,this.elapsed=0,this.elapsed_mili=0,this.timeOut_toCall=0,this.timeOut_expected=0,this.fps=60,this.fpsDesired=60,this.timeStep_mili=1/this.fpsDesired,this.timeStep=1e3/this.fpsDesired,this.accumalator=0,this.accumulatorMax=10*this.timeStep,this.accumulatorDelta=this.timeStep,this.updateStart=0,this.updateLast=0,this.updateAverage=0,this.updateDelta=0,this.deltaTime=0,this._lastFpsUpdate=0,this._framesThisSecond=0}return i(e,[{key:"start",value:function(){this.startTime=Date.now(),this.time=Date.now()}},{key:"refresh",value:function(){var e=this.time;this.time=Date.now(),this.elapsed_mili=this.time-e}},{key:"update",value:function(e){var t=this.time;return this.time=Date.now(),this.elapsed_mili=this.time-t,!(e<this.previousTime+this.timeStep||(this.previousTime=this.currentTime,this.currentTime=e,this.elapsed=this.currentTime-this.previousTime,this.deltaTime=0,this.game.updateGameMethod._isTimeOutMode&&(this.timeOut_toCall=Math.floor(Math.max(0,1e3/this.fpsDesired-(this.timeOut_expected-time))),this.timeOut_expected=time+this.timeOut_toCall),this.accumalator+=Math.max(Math.min(3*this.timeStep,this.elapsed),0),this.accumulatorDelta=this.timeStep,this.game.debugMode&&this.fpsUpdate(e),0))}},{key:"fpsUpdate",value:function(e){e>this._lastFpsUpdate+1e3&&(this.fps=.25*this._framesThisSecond+.75*this.fps,this._lastFpsUpdate=e,this._framesThisSecond=0),this._framesThisSecond++}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this._cache={images:{},sounds:{}}}return i(e,[{key:"addImage",value:function(e,t,n){this.tagExists("images",e)&&this.removeTagAt("images",e);var i={tag:e,url:t,data:n};console.log(n),this._cache.images[e]=i}},{key:"addSound",value:function(e,t,n,i){var s=!1;i||(s=!0);var a={tag:e,url:t,data:n,usingWebAudio:i,decoded:s,isDecoding:!1};this._cache.sounds[e]=a}},{key:"soundDecoded",value:function(e,t){var n=this.getAssetInfo("sounds",e);n.data=t,n.decoded=!0,n.isDecoding=!1}},{key:"tagExists",value:function(e,t){return!!this._cache[e][t]}},{key:"removeTagAt",value:function(e,t){delete this._cache[e][t]}},{key:"getAsset",value:function(e,t){return this.tagExists(e,t)?this._cache[e][t].data:null}},{key:"getAssetInfo",value:function(e,t){return this.tagExists(e,t)?this._cache[e][t]:null}},{key:"clear",value:function(){for(var e in this._cache)for(var t in this._cache[e])delete this._cache[e][t]}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=(i=n(2))&&i.__esModule?i:{default:i};t.default=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),void 0===t&&(t={});var n=s.default.getValue,i=s.default.getPropertyValue;this.width=n(t,"width",640),this.height=n(t,"height",480),this.parent=n(t,"parent",null),this.debug=n(t,"debug",!1),this.loader={baseURL:i(t,"loader.baseURL",""),path:i(t,"loader.path",""),responseType:i(t,"loader.responseType",""),async:i(t,"loader.async",!0)},this.pixelated=n(t,"pixelated",!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=p(n(29)),a=(p(n(6)),p(n(28))),r=p(n(7)),o=p(n(27)),u=p(n(26)),l=p(n(10)),h=p(n(25)),c=p(n(22)),f=p(n(21)),d=p(n(19)),y=p(n(15));function p(e){return e&&e.__esModule?e:{default:e}}var v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent="body",this.width=800,this.height=600,this.config=new s.default(config),this.systemInited=!1,this.isRunning=!1,this.debugMode=!1,this.timeMode=!1,this._spiraling=0,this._lastFrameCount=0,this.debug=null,this.cache=null,this.load=null,this.canvas=null,this.scene=null,this.sound=null,this.draw=null,this.render=null,this.universe=null,this.world=null,this.input=null,this.time=null,this.component=null,this.instance=null,this.animationCache=null,this.updateGameMethod=null,this.pool=null,this.context=null,this.parseConfiguration(this.config),this.init()}return i(e,[{key:"parseConfiguration",value:function(e){e.debug&&(this.debugMode=e.debug),e.width&&(this.width=e.width),e.height&&(this.height=e.height),e.parent&&(this.parent=e.parent)}},{key:"init",value:function(){this.systemInited||(this.cache=new a.default(this),this.load=new r.default(this),this.time=new o.default(this),this.render=new h.default(this),this.draw=new c.default(this),this.scene=new f.default(this),this.input=new l.default(this),this.physics=new d.default(this),this.debugMode&&(this.debug=new y.default(this)),this.time.start(),this.input.init(),this.updateGameMethod=new u.default(this,this.timeMode),this.updateGameMethod.start(),this.systemInited=!0,this.isRunning=!0,console.log("scintilla started!"))}},{key:"update",value:function(e){if(this.systemInited)if(this.time.update(e),this._spiraling>1)this.time.deltaTime=0,this._spiraling=0,this.time.accumalator=0,this.render.render(this.time.accumulatorDelta);else{for(var t=0;this.time.accumalator>=this.time.accumulatorDelta;)if(this.time.deltaTime=Math.min(this.time.accumalator,this.time.accumulatorDelta)/1e3,this.logic(this.time.deltaTime),this.time.accumalator-=this.time.accumulatorDelta,t++,this.time.refresh(),t>=240){this.time.accumalator=0;break}t>this._lastFrameCount?this._spiraling++:t<this._lastFrameCount&&(this._spiraling=0),this._lastFrameCount=t,this.render.render(this.time.accumalator/this.time.accumulatorDelta)}}},{key:"logic",value:function(e){this.scene.preUpdate(),this.scene.update(e),this.input.update(),this.physics.update()}},{key:"destroy",value:function(){this.updateGameMethod.destroy(),this.physics.destroy(),this.universe.destroy(),this.sound.destroy(),this.input.destroy(),this.debug=null,this.cache=null,this.load=null,this.canvas=null,this.scene=null,this.sound=null,this.draw=null,this.universe=null,this.world=null,this.input=null,this.time=null,this.render=null,this.component=null,this.instance=null,this.animationCache=null,this.updateGameMethod=null}}]),e}();t.default=v,e.exports=v},function(e,t,n){"use strict";var i={create:function(e,t,n){if("function"==typeof URL)e.src=URL.createObjectURL(t);else{var i=new FileReader;i.onload=function(){e.removeAttribute("crossOrigin"),e.src="data:"+(t.type||n)+";base64,"+i.result.split(",")[1]},i.onerror=e.onerror,i.readAsDataURL(t)}},revoke:function(e){"function"==typeof URL&&URL.revokeObjectURL(e.src)}};e.exports=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(1),a=u(n(8)),r=u(n(31)),o=u(n(2));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n,i,s,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r={type:"image",tag:"string"==typeof e?e:o.default.getValue(e,"tag",""),ext:o.default.getValue(e,"ext",o.default.getFileExtension(n)),url:o.default.getValue(e,"file",n),path:i,responseType:"blob",xhrSettings:o.default.getValue(e,"xhr",s),config:o.default.getValue(e,"config",a)};return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),i(t,[{key:"onProcessing",value:function(e){this.state=s.LOADER_STATE.PROCESSING,this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){r.default.revoke(t.data),t.onDone(),e(t)},this.data.onerror=function(){r.default.revoke(t.data),t.state=s.LOADER_STATE.ERROR,e(t)},r.default.create(this.data,this.xhrRequest.response,"image/"+this.config.ext)}}]),t}();t.default=l,s.AssetTypeHandler.register("image",function(e,t,n,i){return this.addAsset(new l(e,t,this.path,i)),this}),e.exports=l},function(e,t,n){"use strict";e.exports={ImageFile:n(32)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.list={}}return i(e,[{key:"inject",value:function(e){for(var t in this.list)e[t]=this.list[t]}},{key:"register",value:function(e,t){this.list[e]=t}},{key:"destroyfunction",value:function(){this.list={}}}]),e}();t.default=s},function(e,t,n){"use strict";e.exports={File:n(8),AssetsTypes:n(33),LoaderState:n(1),LoaderManager:n(7),XHR:n(3)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||1,this.a=[],this.a[0]=t,this.a[1]=0,this.a[2]=0,this.a[3]=0,this.a[4]=t,this.a[5]=0,this.a[6]=0,this.a[7]=0,this.a[8]=t}return i(e,[{key:"at",value:function(e,t){return this.a[e*t*3]}},{key:"set",value:function(e,t,n){return this.a[t*e*3]=n,this}},{key:"setAll",value:function(e,t,n,i,s,a,r,o,u){return this.a[0]=e,this.a[1]=t,this.a[2]=n,this.a[3]=i,this.a[4]=s,this.a[5]=a,this.a[6]=r,this.a[7]=o,this.a[8]=u,this}},{key:"translate",value:function(e,t){return this.a[4]+=e,this.a[5]+=t,this}},{key:"scale",value:function(e,t){return this.a[0]*=e,this.a[1]*=e,this.a[2]*=t,this.a[3]*=t,this.a[4]*=e,this.a[5]*=t,this}},{key:"rotate",value:function(e){var t=Math.cos(e),n=Math.sin(e),i=this.a,s=this.c,a=this.x;return this.a=i*t-this.b*n,this.b=i*n+this.b*t,this.c=s*t-this.d*n,this.d=s*n+this.d*t,this.x=a*t-this.y*n,this.y=a*n+this.y*t,this}},{key:"multiply",value:function(t){return e.multiply(this,t)}},{key:"print",value:function(){for(var e="",t=0;t<3;t++){for(var n=0;n<3;n++)e+=this.at(t,n).toString()+" ";e+="<br>"}console.log(e)}}],[{key:"identity",value:function(){return new e(1)}},{key:"zero",value:function(){return new e(0)}},{key:"transpose",value:function(t){return(t=e.zero()).setAll(t.a[0],t.a[3],t.a[6],t.a[1],t.a[4],t.a[7],t.a[2],t.a[5],t.a[8])}},{key:"multiply",value:function(t,n){for(var i=e.zero(),s=void 0,a=0;a<3;++a)for(var r=0;r<3;++r)for(var o=0;o<3;++o)s=i.get(a,o),s+=t.get(a,r)*n.get(r,o),i.set(a,o,s);return i}}]),e}();t.default=s,e.exports=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.MouseButton={LEFT_BUTTON:0,MIDDLE_BUTTON:1,RIGHT_BUTTON:2,WHEEL_UP:3,WHEEL_DOWN:4};var s=t.MouseEvent={NONE:0,PRESS:1,PRESSED:2,RELEASE:3},a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=0,this.y=0,this.game=t,this.canvas=t.render.canvas,this.button=0,this.wheelDelta=0,this.active=!0,this._mouseButtons=[],this._mouseButtonsLocks=[],this._mouseButtonsLocksPressed=[],this._mouseDownDuration=[],this._onMouseDown=null,this._onMouseMove=null,this.reset()}return i(e,[{key:"reset",value:function(){for(var e=0;e<3;e++)this._mouseButtons[e]=!1,this._mouseButtonsLocks[e]=s.NONE,this._mouseButtonsLocksPressed[e]=s.NONE,this._mouseDownDuration[e]=0}},{key:"init",value:function(){var e=this;this._onMouseDown=function(t){return e.onMouseDown(t)},this._onMouseUp=function(t){return e.onMouseUp(t)},this._onMouseMove=function(t){return e.onMouseMove(t)},this.canvas.addEventListener("mousedown",this._onMouseDown,!0),this.canvas.addEventListener("mousemove",this._onMouseMove,!0),this.canvas.addEventListener("mouseup",this._onMouseUp,!0),this.canvas.addEventListener("mouseover",this._onMouseOver,!0),this.canvas.addEventListener("mouseout",this._onMouseOut,!0)}},{key:"onMouseMove",value:function(e){if(this.active){var t=this.canvas.getBoundingClientRect();this.x=Math.floor((e.clientX-t.left)/(t.right-t.left)*this.canvas.width),this.y=Math.floor((e.clientY-t.top)/(t.bottom-t.top)*this.canvas.height)}}},{key:"onMouseDown",value:function(e){if(this.active){var t=e.button;this._mouseButtonsLocksPressed[t]!=KeyEvent.PRESSED&&this._mouseButtonsLocksPressed[t]!=KeyEvent.PRESS&&(this._mouseButtonsLocksPressed[t]=s.PRESSED,this._mouseDownDuration[t]=1),this._mouseButtons[t]=!0,this._mouseButtonsLocks[t]=s.PRESS,e.preventDefault()}}},{key:"onMouseUp",value:function(e){if(this.active){var t=e.button;this._mouseButtons[t]=!1,this._mouseButtonsLocks[t]=s.RELEASE,this._mouseButtonsLocksPressed[t]=s.NONE,e.preventDefault()}}},{key:"pressed",value:function(e){var t=!1;return this._mouseButtonsLocksPressed[e]==s.PRESSED&&(t=!0,this._mouseButtonsLocksPressed[e]=s.PRESS),this._mouseButtons[e]&&t}},{key:"release",value:function(e){var t;t=this._mouseButtonsLocks[e]!=s.PRESSED&&this._mouseButtonsLocks[e]!=s.PRESS&&this._mouseButtonsLocks[e]!=s.NONE;var n=!this._mouseButtons[e]&&t;return this._mouseButtonsLocks[e]=s.NONE,n}},{key:"press",value:function(e){var t;return t=this._mouseButtonsLocks[e]!=s.RELEASE&&this._mouseButtonsLocks[e]!=s.NONE,this._mouseButtons[e]&&t}},{key:"update",value:function(){for(var e=0;e<this._mouseButtons.length;e++)this._mouseButtonsLocksPressed[e]==s.PRESSED&&(this._mouseDownDuration[e]>0?this._mouseDownDuration[e]--:this._mouseButtonsLocksPressed[e]=s.PRESS)}},{key:"posRelativeTo",value:function(e){var t={x:0,y:0};return t.x=this.x-e.x,t.y=this.y-e.y,t}}]),e}();t.default=a},function(e,t,n){"use strict";e.exports={Key:n(11),Keyboard:n(4),Mouse:n(4),Input:n(10)}},function(e,t,n){"use strict";e.exports={Set:n(13),Map:n(0)}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";(function(t){var i=i||{VERSION:"0.0.1",Struct:n(39),KeyCode:n(12),Input:n(38),MathUtils:n(9),Matrix:n(36),Loader:n(35),Game:n(30),Color:n(14)};i.ShapeType={Rect:1,Circle:2,Polygon:3},e.exports=i,t.scintilla=i}).call(this,n(40))}])});