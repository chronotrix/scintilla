{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///../node_modules/webpack/buildin/global.js","webpack:///./Scintilla.js","webpack:///./cache/cache.js","webpack:///./cache/resources/imageResource.js","webpack:///./cache/resources/resource.js","webpack:///./core/config.js","webpack:///./core/game.js","webpack:///./core/gameSystemManager.js","webpack:///./core/scenesystem.js","webpack:///./entities/camera.js","webpack:///./entities/entity.js","webpack:///./entities/entityFactory.js","webpack:///./entities/entityhierarchy.js","webpack:///./entities/entityupdatelist.js","webpack:///./entities/index.js","webpack:///./entities/sceneentity.js","webpack:///./input/index.js","webpack:///./input/input.js","webpack:///./input/key.js","webpack:///./input/keyboard.js","webpack:///./input/keycode.js","webpack:///./input/mouse.js","webpack:///./input/mousebutton.js","webpack:///./loader/URLobject.js","webpack:///./loader/XHR.js","webpack:///./loader/assets/imagefile.js","webpack:///./loader/assets/index.js","webpack:///./loader/assets/textfile.js","webpack:///./loader/file.js","webpack:///./loader/index.js","webpack:///./loader/listinjector.js","webpack:///./loader/loaderstate.js","webpack:///./loader/loadmanager.js","webpack:///./math/boundingbox.js","webpack:///./math/mathutils.js","webpack:///./math/matrix.js","webpack:///./math/rect.js","webpack:///./math/vector.js","webpack:///./modules/core/transform.js","webpack:///./modules/core/updateModules.js","webpack:///./modules/core/updateTransform.js","webpack:///./modules/index.js","webpack:///./modules/module.js","webpack:///./modules/moduleAttacher.js","webpack:///./modules/moduleManager.js","webpack:///./modules/moduleProvider.js","webpack:///./modules/renderables/drawImage.js","webpack:///./modules/renderables/index.js","webpack:///./modules/renderables/renderable.js","webpack:///./modules/renderables/sprite.js","webpack:///./others/debug.js","webpack:///./physics/physics.js","webpack:///./physics/sat.js","webpack:///./physics/satresponse.js","webpack:///./render/canvas/canvas.js","webpack:///./render/define.js","webpack:///./render/draw.js","webpack:///./render/index.js","webpack:///./render/render.js","webpack:///./render/renderlayer.js","webpack:///./render/renderlayersmanagement.js","webpack:///./scene/scene.js","webpack:///./scene/scenemanager.js","webpack:///./structures/index.js","webpack:///./structures/list.js","webpack:///./structures/map.js","webpack:///./structures/set.js","webpack:///./structures/useful/index.js","webpack:///./structures/useful/mergesort.js","webpack:///./time/time.js","webpack:///./time/updatetime.js","webpack:///./utils/color.js","webpack:///./utils/objectutils.js","webpack:///./utils/pathutils.js"],"names":["scintilla","VERSION","Struct","require","Render","KeyCode","MouseButton","Input","MathUtils","Matrix","Module","Entity","Cache","Loader","Game","Color","ShapeType","Rect","Circle","Polygon","module","exports","global","game","_cache","images","sounds","tag","url","data","tagExists","removeTagAt","img","webAudio","decoded","audio","usingWebAudio","isDecoding","sound","getAssetInfo","cacheType","asset","property","register","ImageResource","source","name","width","height","isLoaded","imageUrl","type","Image","complete","getContext","naturalWidth","naturalHeight","ResourceType","None","Resource","Config","config","undefined","callback","getValue","callback_2","getPropertyValue","parent","debug","loader","baseURL","path","responseType","async","pixelated","systemInited","isRunning","debugMode","timeMode","_spiraling","_lastFrameCount","scene","input","time","updateGameMethod","pool","systems","context","parseConfiguration","init","physics","system","start","console","log","update","deltaTime","accumalator","display","accumulatorDelta","countFrames","Math","min","logic","refresh","timeStep","render","renderBegin","renderEnd","preUpdate","destroy","universe","cache","load","canvas","draw","world","component","instance","animationCache","gameSystems","GameSystemManager","sys","_game","key","systemName","SceneSystem","Camera","x","y","view","root","instancesInView","target","scale","angle","_width","_height","position","set","vector","setPosition","round","_name","_active","value","EntityFactory","entityList","entityName","entity","modules","attach","sprite","current_scene","add","EntityHierarchy","children","child","addChildAt","length","index","removeChild","splice","_changeDepth","Error","indexOf","removeChildAt","getChildAt","EntityUpdateList","_instances","_destroyInstances","_pendingInstances","push","identity","each","element","active","transform","removeSize","size","insertSize","eraseList","concat","childs","SceneEntity","_isDirty","origin","Key","Keyboard","Mouse","mouse","keyboard","reset","KeyEvent","NONE","IDLE","PRESSED","RELEASED","keycode","keyCode","_enabled","status","press","release","_event","pressTime","pressDuration","releaseTime","releaseDuration","_keyMapping","_keyWatch","_keyGarbage","lastKey","_onKeyDown","_onKeyUp","_onKeyPress","clear","prop","hasOwnProperty","self","event","processKeyDown","processKeyUp","window","addEventListener","removeEventListener","preventDefault","keyObj","get","onKeyUp","onKeyDown","has","deleteByIndexedArray","isPressed","isReleased","Backspace","Tab","Enter","Shift","Ctrl","Alt","Pause","CapsLock","Escape","Space","PageUp","PageDown","End","Home","Left","Up","Right","Down","Insert","Delete","Num0","Num1","Num2","Num3","Num4","Num5","Num6","Num7","Num8","Num9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","LSystem","RSystem","SelectK","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","Multiply","Add","Subtract","DecimalPoint","Divide","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","NumLock","ScrollLock","SemiColon","Equal","Comma","Dash","Period","Slash","LBraket","BackSlash","RBracket","Quote","MouseEvent","PRESS","RELEASE","button","wheelDelta","_mouseButtons","_mouseButtonsLocks","_mouseButtonsLocksPressed","_mouseDownDuration","_onMouseDown","_onMouseMove","i","onMouseDown","_onMouseUp","onMouseUp","onMouseMove","_onMouseOver","_onMouseOut","rect","getBoundingClientRect","floor","clientX","left","right","clientY","top","bottom","buttonLock","hit","object","vec2","Middle","WheelUp","WheelDown","URLObject","create","response","URL","src","createObjectURL","reader","FileReader","onload","removeAttribute","result","split","onerror","readAsDataURL","revoke","revokeObjectURL","file","settings","xhrSettings","XHR","merge","xmlHttpRequest","XMLHttpRequest","open","timeout","onLoad","bind","onError","onprogress","onProgress","onReadyStateChange","onreadystatechange","send","doAsync","a","b","out","createSettings","setting","ImageFile","assetTag","fileConfig","ext","getExtension","processingCallback","state","PROCESSING","crossOrigin","onDone","ERROR","xhrRequest","addAsset","TextFile","useExternal","responseText","endPointPath","File","PENDING","totalBytes","loadedBytes","progress","gameLoader","FINISHED","nextFile","getURL","warn","createFileRequest","xhr","XHRreset","next","error","lengthComputable","loaded","total","DONE","AssetsTypes","LoaderState","LoaderManager","ListInjector","list","toObj","func","AssetTypeHandler","LOADER_STATE","LOADING","LoadManager","_filesQueue","_filesLoading","_successFiles","_failedFiles","_processedFiles","_filesQueueCount","_loadedFilesCount","isDownloading","_totalFiles","gameConfig","inject","substr","baseUrl","isOK","loadFinished","processFileQueue","delete","loadAsset","concludedFile","hasError","updateProgress","processingDone","onProcessing","processingUpdate","deleteFromSuccessQueue","addImage","requestXHR","addSound","autoDecode","decode","preloadComplete","_successCount","_fileErrorCount","BoundingBox","xx","yy","w","h","max","box","prototype","isPrototypeOf","minX","minY","maxX","maxY","pos","rotation","anchor","coords","negx","negy","Vector","center","gameObject","local","setup","_cosSin","frame","worldPosition","org","camera","worldScale","worldRotation","shape","Infinity","getType","points","getPoints","forEach","point","cos_and_sin","coord","cos","sin","randomRange","random","irandomRange","lerp","fromValue","toValue","t","lerpAngle","end","difference","abs","rangeZero","distance","x0","y0","x1","y1","sqrt","angleBetween","toDegree","atan2","degToRad","PI","radToDeg","TAU","radians","tobiJS","toRadian","degrees","j","setTransform","c","d","e","f","g","radianAngle","radianRotate","a00","a01","a10","a11","a20","a21","other","setAll","mat","str","val","at","copy","zero","k","intersects","contains","vec","rect1","rect2","_x","_y","dx","dy","s","otherVector","mag","dot","project","squaredLenght","magnitude","dp","proj","axis","r","sub","projectNormal","Transform","matrix","bounds","globalBounds","UpdateModules","modulesManager","_pendingModules","mod","attached","layer","renderLayers","UpdateTransform","parentMatrix","wt","pt","_oldRotation","setModelMatrix","multiply","toString","ModuleProvider","ModuleAttacher","Renderables","moduleManager","_type","instace","ModuleManager","moduleName","ModuleProviderManager","proxyModules","manager","args","DrawImage","resolution","drawImage","Renderable","Sprite","_layerID","_depth","_visible","_alpha","_depthDirty","_depthSorting","alpha","getAsset","setSource","image","changeFrame","setFrame","spr","setSprite","Debug","lineHeight","column","font","textColor","bgcolor","textShadow","strokeStyle","rectangle","drawLine","fps","drawCalls","textLine","fillStyle","fillText","Physics","sat","colliadables","obj","objA","shapeA","_gameObject","_selfDestroy","jit","objB","shapeB","call","onCollision","SAT","VECTORS","v","ARRAYS","normal","Number","MAX_VALUE","len","posA","posB","pointsA","pointsB","rangeA","pop","rangeB","offsetV","projectedOffset","flattenPointsOn","overlap","aInB","bInA","option1","option2","absOverlap","overlapN","reverse","normalsA","getNormals","normalsALen","normalsB","normalsBLen","isSeparatingAxis","overlapV","SATResponse","indexShapeA","indexShapeB","defaultDef","id","class","container","style","CO","document","createElement","setAttribute","Canvas","appendDOM","appendTo","overflowHidden","getElementById","nodeType","body","appendChild","RENDERING_TYPE","NEAREST","LINEAR","Draw","fontname","text","color","ctx","save","translate","restore","xscale","yscale","fillRect","outlineWidth","beginPath","lineWidth","setLineDash","stroke","globalAlpha","bb","outlineRectangle","RenderLayer","RenderLayerManagement","imageRendering","pixelelated","_backgroundColor","_enable","clearRect","globalCompositeOperation","enable","test","currentContext","layerName","renderList","__drawCalls","__enable","__isDirty","renderer","remove","__renderers","sort","sortDepth","RenderLayersManagement","__renderLayersMap","erase","Scene","instances","clone","cl","arguments","GameObject","_id","SceneManager","entityUpdateList","_scenes","current_scene_name","change_scene","_setup","_clearCache","onStartCallback","onLoadingCallback","onLoadingRenderCallback","onPreloadCallback","onUpdateCallback","onRenderCallback","onDestroyCallback","sceneName","newScene","clearCache","scenes","unject","clearCurrentScene","setupScene","totalQueuedFiles","lateUpdate","Utils","SetData","Map","List","elements","unique","Array","isArray","unshift","idx","childToErase","listToRemove","otherList","clearOther","params","content","predicate","childA","childB","idx0","idx1","indexA","indexB","cA","cB","_content","_size","entries","Object","keys","values","array","_contents","scope","slice","MergeSort","begin","begin_right","left_size","right_size","msort","mid","Time","startTime","currentTime","previousTime","elapsed","elapsed_mili","timeOut_toCall","timeOut_expected","fpsDesired","timeStep_mili","accumulatorMax","updateStart","updateLast","updateAverage","updateDelta","_lastFpsUpdate","_framesThisSecond","Date","now","previousDateNow","timestamp","_isTimeOutMode","fpsUpdate","UpdateTime","setTimeOutMode","vendors","requestAnimationFrame","cancelAnimationFrame","_onLoopingCallback","_timeOutCallback","updateTimeout","setTimeout","updateRequestAnimationFrame","clearTimeout","webRGB","HSLtoRGB","l","alp","q","p","hueToColor","RGBtoHex","componentToHex","hex","ObjectUtils","constructor","apply","defaultValue","match","PathUtils","filename","substring","lastIndexOf"],"mappings":"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","file":"scintilla.dev.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Scintilla\"] = factory();\n\telse\n\t\troot[\"Scintilla\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./Scintilla.js\");\n","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\r\n} catch (e) {\r\n\t// This works if the window reference is available\r\n\tif (typeof window === \"object\") g = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n","/**\r\n* @author       Tobias Beise Ulrich\r\n* @license      MIT\r\n*\r\n* @overview\r\n*\r\n* --- Scintilla ---\r\n*\r\n* v0.0.1\r\n*\r\n* tobiasbu.github.io\r\n*\r\n* Scintilla is simple 2D game engine for HTML5 games.\r\n* The first version is only for browsers based in canvas.\r\n*\r\n*/\r\n\r\n/**\r\n* @namespace scintilla\r\n*/\r\nvar scintilla = scintilla || {\r\n  VERSION: '0.0.1',\r\n\r\n  // DATA STRUCTURES\r\n  Struct : require('./structures'),\r\n  // RENDER\r\n  Render : require('./render'),\r\n  // INPUT\r\n  KeyCode : require('./input/keycode'),\r\n  MouseButton : require('./input/mousebutton'),\r\n  Input : require('./input'),\r\n  // MATH\r\n  MathUtils : require('./math/mathutils'),\r\n  Matrix : require('./math/matrix'),\r\n  // ENTITIES\r\n  Module : require('./modules'),\r\n  Entity : require('./entities'),\r\n  // CORE\r\n  Cache : require('./cache/cache'),\r\n  Loader : require('./loader'),\r\n  Game : require('./core/game'),\r\n  // UTILITIES\r\n  Color : require('./utils/color')\r\n};\r\n\r\nscintilla.ShapeType = {\r\nRect : 1,\r\nCircle : 2,\r\nPolygon : 3\r\n}\r\n\r\n\r\nmodule.exports = scintilla;\r\n\r\nglobal.scintilla = scintilla;","import ImageResource from \"./resources/imageResource\";\r\nimport GameSystemManager from \"../core/gameSystemManager\";\r\n\r\n/**\r\n* Cache manager - holds file data\r\n* @class Cache\r\n* @constructor\r\n*/\r\nexport default class Cache {\r\n\r\nconstructor(game) {\r\n  this.game = game;\r\n  this._cache = {\r\n      images : {},\r\n      sounds : {}\r\n  }\r\n}\r\n\r\n  addImage(tag, url, data) {\r\n\r\n    if (this.tagExists('images',tag))\r\n      this.removeTagAt('images',tag);\r\n\r\n    \r\n    var img = new ImageResource(data,tag)\r\n\r\n    this._cache.images[tag] = img;\r\n\r\n  }\r\n\r\n  addSound(tag, url,data,webAudio) {\r\n\r\n    var decoded = false;\r\n\r\n    if (!webAudio)\r\n    {\r\n        decoded = true;\r\n    }\r\n\r\n    var audio = {\r\n            tag: tag,\r\n            url: url,\r\n            data: data,\r\n            usingWebAudio: webAudio,\r\n            decoded: decoded,\r\n            isDecoding: false\r\n    };\r\n\r\n    this._cache.sounds[tag] = audio;\r\n\r\n  }\r\n\r\n  soundDecoded(tag, data) {\r\n\r\n    var sound = this.getAssetInfo(\"sounds\",tag);\r\n\r\n    sound.data = data;\r\n    sound.decoded = true;\r\n    sound.isDecoding = false;\r\n\r\n  }\r\n\r\n  tagExists(cacheType, tag) {\r\n\r\n    if (this._cache[cacheType][tag])\r\n      return true;\r\n\r\n    return false;\r\n\r\n  }\r\n\r\n  removeTagAt(cacheType, tag) {\r\n\r\n    delete this._cache[cacheType][tag];\r\n\r\n  }\r\n\r\n  getAsset(cacheType, tag) { // return the cache container\r\n\r\n    if (this.tagExists(cacheType,tag)) {\r\n\r\n      var asset = this._cache[cacheType][tag];\r\n\r\n        return asset;\r\n\r\n\r\n    } else {\r\n      return null;\r\n    }\r\n\r\n  }\r\n\r\n  getAssetInfo(cacheType, tag) { // return the raw data\r\n\r\n    if (this.tagExists(cacheType,tag)) {\r\n\r\n      var asset = this._cache[cacheType][tag];\r\n\r\n      //if (cacheType == 'images')\r\n        return asset;\r\n\r\n\r\n    } else {\r\n      return null;\r\n    }\r\n\r\n  }\r\n\r\n  clear() {\r\n\r\n    //console.log(this._cache[property][tag]);\r\n\r\n    for (var property in this._cache) {\r\n\r\n         for (var tag in this._cache[property]) {\r\n\r\n            delete this._cache[property][tag];\r\n\r\n         }\r\n    }\r\n\r\n  }\r\n\r\n  // SOUND STUFF\r\n\r\n}\r\n\r\nGameSystemManager.register('Cache', Cache, 'cache');","import Resource, { ResourceType } from \"./resource\";\r\n\r\n/**\r\n* Image that holds image data.\r\n* @class Image\r\n* @constructor\r\n*/\r\nexport default class ImageResource extends Resource {\r\n\r\n    constructor(source, name) {\r\n\r\n      super(source, name);\r\n      \r\n      this.width = 100;\r\n      this.height = 100;\r\n      this.isLoaded = false;\r\n      this.source = source;\r\n      this.imageUrl = null;\r\n      this.type = ResourceType.Image;\r\n\r\n      if (!source)\r\n        return this;\r\n      \r\n\r\n      if ((this.source.complete || this.source.getContext) && this.source.width && this.source.height) {\r\n\r\n          this.width = this.source.naturalWidth || this.source.width;\r\n          this.height = this.source.naturalHeight || this.source.height;\r\n\r\n      }\r\n  }\r\n\r\n}","\r\n\r\nexport const ResourceType = {\r\n    None : -1,\r\n    Image : 0,\r\n}\r\n\r\nexport default class Resource {\r\n\r\n    constructor(data, name)\r\n    {\r\n        this.data = data || null;\r\n        this.name = name;\r\n        this.type = ResourceType.None;\r\n    }\r\n\r\n}","\r\nimport ObjectUtils from '../utils/objectutils';\r\n\r\nexport default class Config {\r\n\r\n    constructor(config)\r\n    {\r\n        if (config === undefined) \r\n            config = {};\r\n\r\n        var callback = ObjectUtils.getValue;\r\n        var callback_2 = ObjectUtils.getPropertyValue;\r\n\r\n        // view and canvas\r\n        this.width = callback(config, 'width', 640);\r\n        this.height = callback(config, 'height', 480);\r\n        this.parent = callback(config, 'parent', null);\r\n        this.debug =  callback(config, 'debug', false);\r\n        \r\n        // loader\r\n        this.loader = {\r\n            baseURL : callback_2(config, 'loader.baseURL', ''),\r\n            path : callback_2(config, 'loader.path', ''),\r\n            responseType : callback_2(config, 'loader.responseType', ''),\r\n            async : callback_2(config, 'loader.async', true),\r\n        }\r\n\r\n        this.pixelated = callback(config, 'pixelated', false);\r\n        /* this.loaderEnableParallel = GetValue(config, 'loader.enableParallel', true);\r\n            this.loaderMaxParallelDownloads = GetValue(config, 'loader.maxParallelDownloads', 4);\r\n            this.loaderCrossOrigin = GetValue(config, 'loader.crossOrigin', undefined);\r\n            \r\n            this.loaderUser = GetValue(config, 'loader.user', '');\r\n            this.loaderPassword = GetValue(config, 'loader.password', '');\r\n    this.loaderTimeout = GetValue(config, 'loader.timeout', 0);*/\r\n\r\n\r\n    }\r\n\r\n}","\r\nimport Config from './config';\r\nimport Time from '../time/time'\r\nimport UpdateTime from '../time/updatetime'\r\nimport Input from '../input/input'\r\nimport SceneManager from '../scene/scenemanager'\r\nimport Physics from '../physics/physics'\r\nimport Debug from '../others/debug'\r\nimport GameSystemManager from './gameSystemManager';\r\n\r\n/**\r\n* Main class of engine. Holds all main data.\r\n* @class Game\r\n* @constructor\r\n*/\r\nexport default class Game {\r\n\r\n  /**\r\n  * @property {string|HTMLElement} parent - The Games DOM parent.\r\n  * @default\r\n  */\r\n constructor()\r\n {\r\n  this.parent = 'body';\r\n  this.width = 800;\r\n  this.height = 600;\r\n\r\n  // object\r\n  this.config = new Config(config);\r\n\r\n  // boolean\r\n  this.systemInited = false;\r\n  this.isRunning = false;\r\n  this.debugMode = false;\r\n\r\n  // float\r\n  this.timeMode = false;\r\n\r\n  // time\r\n  this._spiraling = 0;\r\n  this._lastFrameCount = 0;\r\n\r\n\r\n  //objects\r\n  this.debug = null;\r\n  this.scene = null;\r\n  this.sound = null;\r\n  this.input = null;\r\n  this.time = null;\r\n  this.updateGameMethod = null;\r\n  this.pool = null;\r\n  this.systems =  null;\r\n\r\n  this.context = null;\r\n\r\n  this.parseConfiguration(this.config);\r\n\r\n  this.init();\r\n }\r\n\r\n  parseConfiguration(config) {\r\n\r\n    //this.config = config;\r\n\r\n    if (config['debug'])\r\n    {\r\n        this.debugMode = config['debug'];\r\n\r\n    }\r\n\r\n    if (config['width'])\r\n    {\r\n        this.width = config['width'];\r\n    }\r\n\r\n    if (config['height'])\r\n    {\r\n        this.height = config['height'];\r\n    }\r\n\r\n    if (config['parent'])\r\n    {\r\n        this.parent = config['parent'];\r\n    }\r\n\r\n  }\r\n  /**\r\n    * Initialize engine\r\n    *\r\n    * @method tobiJS.Game#init()\r\n    * @protected\r\n    */\r\n  init() {\r\n\r\n    if (this.systemInited)\r\n        return;\r\n\r\n    this.time = new Time(this);\r\n    this.physics = new Physics(this);\r\n    this.input = new Input(this);\r\n    this.scene = new SceneManager(this);\r\n    this.system = new GameSystemManager(this);\r\n    \r\n    \r\n    this.system.init();\r\n\r\n    \r\n\r\n    this.scene.init();\r\n    this.time.start();\r\n    this.input.init();\r\n\r\n    if (this.debugMode)\r\n      this.debug = new Debug(this);\r\n      \r\n    this.updateGameMethod = new UpdateTime(this,this.timeMode);\r\n    this.updateGameMethod.start();\r\n\r\n\r\n\r\n    this.systemInited = true;\r\n    this.isRunning = true;\r\n\r\n\r\n    console.log(\"scintilla started!\");\r\n\r\n  }\r\n  \r\n  /**\r\n    * core game loop\r\n    *\r\n    * @method tobiJS.Game#update()\r\n    * @protected\r\n    */\r\n  update(time) {\r\n\r\n    if (this.systemInited) {\r\n\r\n\r\n\r\n      this.time.update(time);\r\n\r\n      if (this._spiraling > 1) {\r\n\r\n          this.time.deltaTime = 0;\r\n          this._spiraling = 0;\r\n          this.time.accumalator = 0;\r\n\r\n          this.display(this.time.accumulatorDelta);\r\n\r\n      } else {\r\n\r\n      var countFrames = 0;\r\n\r\n      while (this.time.accumalator >= this.time.accumulatorDelta) {\r\n\r\n        //  this.time.updateStart = window.performance.now();\r\n\r\n          this.time.deltaTime = Math.min(this.time.accumalator,this.time.accumulatorDelta) / 1000;\r\n\r\n          this.logic(this.time.deltaTime);\r\n\r\n          //this.time.updateLast =  window.performance.now();\r\n        //  this.time.updateAverage = this.time.updateLast - this.time.updateStart;\r\n\r\n          this.time.accumalator -= this.time.accumulatorDelta;\r\n\r\n          countFrames++;\r\n\r\n          this.time.refresh();\r\n\r\n          if (countFrames >= 240) { // SPIRAL\r\n              //panic();\r\n              this.time.accumalator = 0;\r\n\r\n              break;\r\n          }\r\n      }\r\n\r\n        if (countFrames > this._lastFrameCount)\r\n           this._spiraling++;\r\n       else if (countFrames < this._lastFrameCount)\r\n          this._spiraling = 0;\r\n\r\n          this._lastFrameCount = countFrames;\r\n\r\n          this.display(this.time.accumalator/this.time.accumulatorDelta);\r\n            //this.render.render(this.time.accumalator/this.time.accumulatorDelta);\r\n\r\n      }\r\n\r\n\r\n\r\n    }\r\n  }\r\n\r\n  display(timeStep) {\r\n    this.system.render.renderBegin();\r\n    this.system.render.render(timeStep);\r\n    this.system.render.renderEnd();\r\n  }\r\n\r\n  logic(timeStep) {\r\n\r\n    // Core Managers\r\n\r\n    this.input.update();\r\n    //this.sound.update();\r\n\r\n    // Scene Update\r\n    this.physics.update();\r\n    this.scene.preUpdate();\r\n    this.scene.update(timeStep);\r\n\r\n    \r\n    \r\n    //this.universe.preUpdate(timeStep);\r\n\r\n\r\n    //this.world.camera.update();\r\n\r\n    //this.universe.update(timeStep);\r\n    \r\n    //\r\n\r\n    //this.universe._updateTransform();\r\n\r\n\r\n  }\r\n\r\n  destroy() {\r\n\r\n    this.updateGameMethod.destroy();\r\n    this.physics.destroy();\r\n    this.universe.destroy();\r\n    this.sound.destroy();\r\n    this.input.destroy();\r\n\r\n    this.debug = null;\r\n    this.cache = null;\r\n    this.load = null;\r\n    this.canvas = null;\r\n    this.scene = null;\r\n    this.sound = null;\r\n    this.draw = null;\r\n    this.universe = null;\r\n    this.world = null;\r\n    this.input = null;\r\n    this.time = null;\r\n    this.render = null;\r\n    this.component = null;\r\n    this.instance = null;\r\n    this.animationCache = null;\r\n    this.updateGameMethod = null;\r\n\r\n\r\n  }\r\n\r\n}\r\n\r\n//scintilla.Game.prototype.constructor = scintilla.Game;\r\n\r\n\r\nmodule.exports = Game;","import SceneSystem from \"./scenesystem\";\r\n\r\n\r\nvar gameSystems = {};\r\n\r\nexport default class GameSystemManager\r\n{\r\n\r\n    constructor(game)\r\n    {\r\n        this.game = game;\r\n        //this.systems = {};\r\n    }\r\n\r\n    init() {\r\n        // register all game systems\r\n        for (let property in gameSystems) {\r\n\r\n            var sys = gameSystems[property];\r\n            this[sys.name] = new sys.system(this.game);\r\n        }\r\n\r\n        // initialize systems\r\n        for (let property in gameSystems) {\r\n\r\n            \r\n            var sys = this[gameSystems[property].name];\r\n            if (sys.init === undefined) continue;\r\n\r\n            sys.init();\r\n        }\r\n    }\r\n\r\n    get(system) {\r\n        return this[system];\r\n    }\r\n\r\n    inject(scene) {\r\n        \r\n        scene.game = this._game;\r\n\r\n        for (let property in SceneSystem)\r\n        {\r\n            \r\n            let sys = gameSystems[SceneSystem[property]];\r\n            scene[sys.name] = this[sys.name];\r\n        }\r\n\r\n        /*for (let property in gameSystems) {\r\n\r\n            let sys = gameSystems[property];\r\n            scene[sys.name] = property[sys.system];\r\n        }*/\r\n    }\r\n\r\n    unject(scene) {\r\n\r\n        for (let property in gameSystems) {\r\n            scene[sys.name] = undefined;\r\n        }\r\n    }\r\n\r\n    update(time, deltaTime) {\r\n\r\n    }\r\n\r\n    static register(key, system, systemName)\r\n    {\r\n        gameSystems[key] = {name: systemName, system: system};\r\n    }\r\n    \r\n\r\n    \r\n}\r\n","\r\n\r\nvar SceneSystem = [\r\n    'Cache',\r\n    'Draw',\r\n    'Loader',\r\n    'EntityFactory'\r\n]\r\n\r\nexport default SceneSystem;\r\n","\r\nimport Rect from '../math/rect'\r\nimport Vector from '../math/vector'\r\n\r\nexport default class Camera {\r\n  \r\n  constructor(game,x,y,width,height) {\r\n\r\n    this.game = game;\r\n    this.view = new Rect(x,y,width,height);\r\n    this.root = null; // who is the node (world)\r\n    this.instancesInView = 0;\r\n\r\n    this.target = null;\r\n    this.scale = new Vector(1,1);\r\n    this.angle = 0;\r\n\r\n    this._width = width;\r\n    this._height = height;\r\n\r\n  }\r\n\r\n  update() {\r\n    this.instancesInView = 0;\r\n    this.root.position.x = -this.view.x;\r\n    this.root.position.y = -this.view.y;\r\n    this.root.scale = this.scale;\r\n    this.root.angle = this.angle;\r\n  }\r\n\r\n  setScale(x,y) {\r\n    this.scale.set(x,y);\r\n  }\r\n\r\n  setPosition(x,y) {\r\n    this.view.x = x;\r\n    this.view.y = y;\r\n  }\r\n\r\n  setFocus(vector) {\r\n\r\n    this.setPosition(Math.round(vector.x - (this.view.width/2)), Math.round(vector.y - (this.view.height/2)));\r\n\r\n  }\r\n\r\n  setFocusXY(x,y) {\r\n\r\n    this.setPosition(Math.round(x - (this.view.width/2)), Math.round(y - (this.view.height/2)));\r\n\r\n  }\r\n\r\n  setTarget(target) {\r\n\r\n    this.target = target;\r\n\r\n  }\r\n\r\n  reset() {\r\n\r\n        this.target = null;\r\n        this.view.x = 0;\r\n        this.view.y = 0;\r\n        this.angle = 0;\r\n        this.scale.set(1,1)\r\n  }\r\n\r\n}\r\n","\r\n\r\n/*\r\n*\r\n* Base class for Entities\r\n*\r\n*/\r\nexport default class Entity {\r\n\r\n    constructor(name, game)\r\n    {\r\n        this._name = name || 'New Entity';\r\n        this._active = true;\r\n        this.game = game || undefined; \r\n    }\r\n\r\n    get active() {return this._active;}\r\n    set active(value)\r\n    {\r\n        value = !!value;\r\n\r\n        if (value !== this._active)\r\n            this._active = value;\r\n\r\n        return this._active;\r\n    }\r\n\r\n    get name() {return this._name;}\r\n    set name(value)\r\n    {\r\n        value = !!value;\r\n\r\n        if (value !== this._name)\r\n            this._name = value;\r\n\r\n        return this._name;\r\n    }\r\n\r\n    destroy()\r\n    {\r\n        \r\n    }\r\n\r\n};","import GameSystemManager from \"../core/gameSystemManager\";\r\nimport SceneEntity from \"./sceneentity\";\r\n\r\nexport default class EntityFactory {\r\n    \r\n    constructor(game) {\r\n        this.game = game;\r\n        this.scene = null;\r\n        this.entityList = null;\r\n    }\r\n\r\n    init()\r\n    {\r\n        this.entityList = this.game.system.entityList;\r\n        this.scene = this.game.scene;\r\n    }\r\n\r\n    sprite(tag, entityName) {\r\n        var entity = new SceneEntity(entityName,this.game);\r\n        entity.modules.attach.sprite(tag);\r\n\r\n        if (this.scene.current_scene !== null)\r\n        {\r\n            this.entityList.add(entity);\r\n\r\n        }\r\n\r\n        return entity;\r\n    }\r\n\r\n}\r\n\r\nGameSystemManager.register('EntityFactory', EntityFactory, 'create');","\r\nimport Entity from './entity'\r\n\r\n// Hierarchy Tree of instances\r\n// Instance is a children of the Hierarchy tree\r\nexport default class EntityHierarchy extends Entity {\r\n\r\n  constructor(name, game) {\r\n    super(name, game);    \r\n    this.children = [];\r\n    this.parent = null;\r\n  }\r\n\r\n  get childCount() {return this.children.length;}\r\n\r\n  addChild(child) {\r\n    return this.addChildAt(child,this.children.length);\r\n  }\r\n\r\n  addChildAt(child,index) {\r\n        if(index >= 0 && index <= this.children.length)\r\n        {\r\n            if(child.parent)\r\n            {\r\n                child.parent.removeChild(child);\r\n            }\r\n\r\n            child.parent = this;\r\n\r\n            this.children.splice(index, 0, child);\r\n\r\n            this._changeDepth = true;\r\n\r\n            //if(this.stage)child.setStageReference(this.stage);\r\n\r\n            return child;\r\n        }\r\n        else\r\n        {\r\n            throw new Error(child + 'addChildAt: The index '+ index +' supplied is out of bounds ' + this.children.length);\r\n        }\r\n  }\r\n\r\n  removeChild(child)\r\n  {\r\n      var index = this.children.indexOf( child );\r\n\r\n      if(index === -1) return;\r\n\r\n      return this.removeChildAt( index );\r\n  }\r\n\r\n  removeChildAt(index)\r\n  {\r\n    var child = this.getChildAt( index );\r\n\r\n    child.parent = undefined;\r\n    this.children.splice( index, 1 );\r\n    return child;\r\n\r\n  }\r\n\r\n\r\n  getChildAt(index)\r\n  {\r\n      if (index < 0 || index >= this.children.length)\r\n      {\r\n          throw new Error('Hierarchy.getChildAt: Index '+ index +' does not exist in the child list');\r\n      }\r\n      return this.children[index];\r\n\r\n  }\r\n\r\n\r\n  /*preUpdate(time) {\r\n\r\n    for (var i = 0; i < this.children.length; i++)\r\n    {\r\n          this.children[i].preUpdate(time);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  update() {\r\n\r\n    for (var i = 0; i < this.children.length; i++)\r\n    {\r\n          this.children[i].update();\r\n    }\r\n\r\n\r\n  }\r\n\r\n  _updateTransform() {\r\n    for (var i = 0; i < this.children.length; i++)\r\n    {\r\n        this.children[i]._updateTransform();\r\n    }\r\n  }*/\r\n}","import List from \"../structures/list\";\r\nimport GameSystemManager from \"../core/gameSystemManager\";\r\nimport UpdateTransform from '../modules/core/updateTransform'\r\nimport UpdateModules from '../modules/core/updateModules'\r\nimport Matrix from '../math/matrix'\r\n\r\nexport default class EntityUpdateList {\r\n\r\n    constructor(game)\r\n    {\r\n        this.game = game;\r\n        this._instances = null;\r\n        this._destroyInstances = null;\r\n        this._pendingInstances = null;\r\n    }\r\n\r\n    get length() {return this._instances.size;}\r\n\r\n    init()\r\n    {\r\n        this._instances = new List();\r\n        this._destroyInstances = new List();\r\n        this._pendingInstances = new List();\r\n    }\r\n\r\n    add(instance) {\r\n        if (this._instances.indexOf(instance) === -1 && this._pendingInstances.indexOf(instance) === -1)\r\n        {\r\n            this._pendingInstances.push(instance);\r\n        }\r\n\r\n        return instance;\r\n    }\r\n\r\n    remove(instance) {\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n        let parent = Matrix.identity();\r\n\r\n        this._instances.each(element => {\r\n            \r\n            if (element.active)\r\n            {\r\n                \r\n                UpdateTransform(element.transform, parent);\r\n\r\n                UpdateModules(element.modules, this.game);\r\n\r\n                if (element.update !== undefined)\r\n                    element.update();\r\n            }\r\n\r\n            \r\n        });\r\n    }\r\n\r\n    lateUpdate()\r\n    {\r\n        let removeSize = this._destroyInstances.size;\r\n        let insertSize = this._pendingInstances.size;\r\n        \r\n        if (insertSize === 0 && removeSize === 0)\r\n            return;\r\n\r\n\r\n        if (removeSize > 0)\r\n            this._instances.eraseList(this._destroyInstances, removeSize);\r\n\r\n        \r\n        /*this._pendingInstances.each(instance => {\r\n\r\n            this.initializeModules(instance);\r\n\r\n            this._instances.push(instance);\r\n        })\r\n\r\n        this._pendingInstances.clear();*/\r\n\r\n        this._instances.concat(this._pendingInstances, true);\r\n\r\n        this._pendingInstances.childs.length = 0;\r\n        this._destroyInstances.childs.length = 0;\r\n\r\n    }\r\n\r\n    /*initializeModules(instace)\r\n    {\r\n        let modules = instace.modules.attached;\r\n\r\n        modules.each(element => {\r\n            if (element.initialize !== undefined)\r\n                element.initialize(instace, this.game);\r\n        });\r\n    }*/\r\n\r\n}\r\n\r\nGameSystemManager.register('EntityUpdateList', EntityUpdateList, 'entityList');\r\n\r\n","\r\nmodule.exports = {\r\n    Entity : require('./entity'),\r\n    SceneEntity : require('./sceneentity'),\r\n    EntityUpdateList : require('./entityupdatelist'),\r\n    EntityFactory : require('./entityFactory')\r\n}","\r\nimport EntityHierarchy from './entityhierarchy'\r\nimport BoundingBox from '../math/boundingbox'\r\nimport Transform from '../modules/core/transform'\r\nimport ModuleManager from '../modules/moduleManager';\r\n\r\nexport default class SceneEntity extends EntityHierarchy\r\n{\r\n    constructor(name, game)\r\n    {\r\n        name = name || 'New SceneEntity';\r\n        super(name, game || null)\r\n        this.transform = new Transform();\r\n        this.type = null;\r\n        this.pool = null;\r\n        this.modules = new ModuleManager(this);\r\n        //this.bounds = new BoundingBox();\r\n        //this._transformDirty = false;\r\n        //this._currentScene = null;\r\n        \r\n        \r\n    }\r\n\r\n    get ['position']() { return this.transform.position; }\r\n    set ['position'](value) { this.transform.position = value; this.transform._isDirty = true; }\r\n    set ['position.x'](value) { this.transform.position.x = value; this.transform._isDirty = true;}\r\n    set ['position.y'](value) { this.transform.position.y = value; this.transform._isDirty = true;}\r\n\r\n    get ['origin']() { return this.transform.origin; }\r\n    set ['origin'](value) { this.transform.origin = value; this.transform._isDirty = true; }\r\n    set ['origin.x'](value) { this.transform.origin.x = value; this.transform._isDirty = true;}\r\n    set ['origin.y'](value) { this.transform.origin.y = value; this.transform._isDirty = true;}\r\n\r\n    get ['scale']() { return this.transform.scale; }\r\n    set ['scale'](value) { this.transform.scale = value; this.transform._isDirty = true; }\r\n    set ['scale.x'](value) { this.transform.scale.x = value; this.transform._isDirty = true;}\r\n    set ['scale.y'](value) { this.transform.scale.y = value; this.transform._isDirty = true;}\r\n\r\n    get ['angle']() { return this.transform.angle; }\r\n    set ['angle'](value) { this.transform.angle = value; this.transform._isDirty = true; }\r\n   \r\n    \r\n}","\r\nmodule.exports = {\r\n\r\n    Key : require('./key'),\r\n    Keyboard : require('./keyboard'),\r\n    Mouse : require('./keyboard'),\r\n    Input : require('./input')\r\n    \r\n}","\r\nimport Keyboard from \"./keyboard\";\r\nimport Mouse from \"./mouse\";\r\n\r\nexport default class Input {\r\n\r\n  constructor(game) {\r\n\r\n  this.game = game;\r\n  this.mouse = null;\r\n  this.keyboard = null;\r\n\r\n  }\r\n\r\n  init() {\r\n\r\n    //this.mouse = new tobiJS.Mouse(this.game);\r\n    this.keyboard = new Keyboard(this.game);\r\n    this.mouse = new Mouse(this.game);\r\n    this.keyboard.init();\r\n    this.mouse.init();\r\n\r\n  }\r\n\r\n  update() {\r\n\r\n    this.keyboard.update();\r\n    this.mouse.update();\r\n\r\n  }\r\n\r\n  reset()\r\n  {\r\n    this.keyboard.reset();\r\n    this.mouse.reset();\r\n  }\r\n\r\n}\r\n","\r\n\r\nexport const KeyEvent = {\r\n    NONE : -1,\r\n    IDLE: 0,\r\n    PRESSED : 1,\r\n    RELEASED : 2,\r\n};\r\n\r\nexport default class Key {\r\n    \r\n    constructor(keycode, game) {\r\n\r\n        this.game = game;\r\n        this.keyCode = keycode; \r\n\r\n        this._enabled = true;       \r\n        this.status = false;\r\n        this.press = false;\r\n        this.release = false;\r\n\r\n        this._event = KeyEvent.NONE;\r\n\r\n        this.pressTime = 0;\r\n        this.pressDuration = -2500;\r\n        this.releaseTime = 0;\r\n        this.releaseDuration = -2500;\r\n\r\n    }\r\n\r\n\r\n    onKeyDown()\r\n    {\r\n        if (!this._enabled)\r\n            return;\r\n\r\n        if (this.press)\r\n            return;\r\n\r\n        // set key properties\r\n        this.status = true;\r\n        this.press = true;\r\n        this.release = false;\r\n\r\n        // set press time duration\r\n        this.pressTime = this.game.time.time;\r\n        this.pressDuration = 0;\r\n        this.releaseDuration = this.game.time.time - this.releaseTime;\r\n    \r\n    }\r\n\r\n    onKeyUp()\r\n    {\r\n        if (!this._enabled)\r\n            return;\r\n\r\n        if (this.release)\r\n            return;\r\n\r\n        // set key properties\r\n        this.status = false;\r\n        this.press = false;\r\n        this.release = true;\r\n\r\n        // set press time duration\r\n        this.releaseTime = this.game.time.time;\r\n        this.pressDuration = this.game.time.time - this.pressTime;\r\n        this.releaseDuration = 0;\r\n\r\n    }\r\n\r\n    update()\r\n    {\r\n        if (!this._enabled)\r\n            return;\r\n\r\n  \r\n\r\n        if (this.press)\r\n        {\r\n            this.pressDuration = this.game.time.time - this.pressTime;\r\n            \r\n        }\r\n        else\r\n        {\r\n            this.releaseDuration = this.game.time.time - this.releaseTime;\r\n        }\r\n\r\n\r\n        if (this.press)\r\n        {\r\n            if (this.pressDuration == 0)\r\n            {\r\n                this._event = KeyEvent.PRESSED;\r\n            }\r\n\r\n        } else {\r\n\r\n            if (this.releaseDuration == 0)\r\n            {\r\n                this._event = KeyEvent.RELEASED;\r\n            } else {\r\n                this._event = KeyEvent.IDLE;\r\n            }\r\n\r\n        }\r\n\r\n        if (this._event == KeyEvent.IDLE)\r\n        {\r\n            this._event = KeyEvent.NONE;\r\n        }\r\n        \r\n    }\r\n\r\n    isPressing()\r\n    {\r\n        return this.status;\r\n    }\r\n\r\n    isPressed()\r\n    {\r\n        return (this.press && this.pressDuration == 0);\r\n    }\r\n\r\n    isReleased()\r\n    {\r\n        return (!this.press && this.releaseDuration == 0)\r\n    }\r\n\r\n    event()\r\n    {\r\n        return this._event;\r\n    }\r\n\r\n    reset()\r\n    {   \r\n        this.status = false;\r\n        this._event = KeyEvent.NONE;\r\n        this.press = false;\r\n        this.release = false;\r\n    \r\n        this.pressTime = 0;\r\n        this.pressDuration = -2500;\r\n        this.releaseTime = 0;\r\n        this.releaseDuration = -2500;\r\n    }\r\n\r\n    get enabled() {return this._enabled;}\r\n    set enabled(value) {\r\n        value = !!value;\r\n\r\n        if (value !== this._enabled)\r\n        {\r\n            if (!value)\r\n                this.reset();\r\n\r\n            this._enabled = value;\r\n        }\r\n    }\r\n};\r\n\r\n\r\n\r\n  \r\n","\r\n\r\nimport Key from './key'\r\nimport Map from '../structures/map'\r\nimport KeyCode from './keycode'\r\n\r\nexport default class Keyboard {\r\n  \r\n  constructor(game) {\r\n\r\n  this.game = game;\r\n  this.context = game.context;\r\n  this.active = true;\r\n  //this._keys = [];\r\n  this._keyMapping = new Map();\r\n  this._keyWatch = new Map();\r\n  this._keyGarbage = [];\r\n  //this._keyLock = [];\r\n  //this._keyLockPressed = [];\r\n  //this._keyDownDuration = [];\r\n  this.lastKey = null;\r\n\r\n  //callbacks\r\n  this._onKeyDown = null;\r\n  this._onKeyUp = null;\r\n  this._onKeyPress = null;\r\n  this.reset();\r\n}\r\n\r\n  reset() {\r\n\r\n    this._keyMapping.clear();\r\n    this._keyWatch.clear();\r\n    this._keyGarbage = [];\r\n    for (var prop in KeyCode){\r\n\r\n      if (KeyCode.hasOwnProperty(prop)) {\r\n        var value = KeyCode[prop];\r\n        this._keyMapping.set(value, new Key(value,this.game));\r\n      }\r\n      /*if (scintilla.KeyCode.hasOwnProperty(prop)) {\r\n\r\n        \r\n\r\n            var value = scintilla.KeyCode[prop];\r\n            this._keys[value] = false;\r\n            this._keyLock[value] = scintilla.KeyEvent.NONE;\r\n            this._keyLockPressed[value] = scintilla.KeyEvent.NONE;\r\n            this._keyDownDuration[value] = 0;\r\n      }*/\r\n    }\r\n\r\n  }\r\n\r\n  init() {\r\n\r\n    var self = this;\r\n\r\n    this.reset();\r\n\r\n      this._onKeyDown = function (event) {\r\n            return self.processKeyDown(event);\r\n    };\r\n\r\n    this._onKeyUp = function (event) {\r\n        return self.processKeyUp(event);\r\n    };\r\n\r\n    window.addEventListener('keydown', this._onKeyDown, false);\r\n    window.addEventListener('keyup', this._onKeyUp, false);\r\n  }\r\n\r\n  stop() {\r\n\r\n    window.removeEventListener('keydown', this._onKeyDown);\r\n    window.removeEventListener('keyup', this._onKeyUp);\r\n    this._onKeyDown = null;\r\n    this._onKeyUp = null;\r\n    this._onKeyPress = null;\r\n\r\n    this._keyMapping.clear();\r\n  }\r\n\r\n  processKeyUp(event) {\r\n\r\n    var key = event.keyCode;\r\n\r\n    event.preventDefault();\r\n\r\n    if (!this.active)\r\n      return;\r\n\r\n      var keyObj = this._keyMapping.get(key);\r\n      keyObj.onKeyUp();\r\n\r\n      /*this._keyLock[key] = scintilla.KeyEvent.RELEASE;\r\n      this._keyLockPressed[key] = scintilla.KeyEvent.NONE;\r\n      this._keys[key] = false;*/\r\n\r\n  }\r\n\r\n  processKeyDown(event) { \r\n\r\n    var key = event.keyCode;\r\n\r\n    event.preventDefault();\r\n\r\n    if (!this.active)\r\n    return;\r\n\r\n    this.lastKey = key;\r\n\r\n    var keyObj = this._keyMapping.get(key);\r\n    keyObj.onKeyDown();\r\n\r\n    if (!this._keyWatch.has(key))\r\n    {\r\n      this._keyWatch.set(key, keyObj);\r\n    }\r\n\r\n    //_keyMapping[]\r\n    //this._keys[key] = true;\r\n    /* if (this._keyLockPressed[key] != scintilla.KeyEvent.PRESSED && this._keyLockPressed[key] != scintilla.KeyEvent.PRESS) {\r\n      this._keyLockPressed[key] = scintilla.KeyEvent.PRESSED;\r\n      this._keyDownDuration[key] = 1;\r\n    }\r\n\r\n    this._keyLock[key] = scintilla.KeyEvent.PRESS;\r\n    this._keys[key] = true;\r\n    */\r\n\r\n\r\n  }\r\n\r\n  /*processKeyPress : function(event) { // commom characters\r\n\r\n    var key = event.keyCode;\r\n\r\n    event.preventDefault();\r\n\r\n    if (!this.active)\r\n      return;\r\n\r\n\r\n      this._keyLock[key] = tobiJS.KeyEvent.PRESS;\r\n      this._keys[key] = true;\r\n\r\n\r\n\r\n  },*/\r\n\r\n  update() {\r\n\r\n      /*var keys = this._keyMapping.keys();\r\n      for (var key in keys)\r\n      {\r\n        if (keys.hasOwnProperty(key)) {\r\n\r\n          var value = this._keyMapping.get(key);\r\n          value.update();\r\n\r\n        }\r\n      }*/\r\n\r\n    //var keyswatch = this._keyWatch; //.keys();\r\n\r\n      var self = this;\r\n\r\n    this._keyWatch.each(function (key, value) {\r\n        //var value = this._keyWatch.get(key);\r\n        value.update();\r\n\r\n        //console.log(value);\r\n\r\n        if (value.event() == KeyEvent.IDLE)\r\n        {\r\n        \r\n          // value.reset();\r\n            self._keyGarbage.push(key);\r\n        }\r\n    });\r\n      /*for (var key in keys)\r\n      {\r\n        //console.log(\"UPDATE\")\r\n\r\n        if (keys.hasOwnProperty(key)) {\r\n\r\n            var value = this._keyWatch.get(key);\r\n            value.update();\r\n\r\n            if (value.event() == scintilla.KeyEvent.IDLE)\r\n            {\r\n              // value.reset();\r\n                this._keyGarbage.push(key);\r\n            }\r\n        }\r\n      }*/\r\n\r\n      if (this._keyGarbage.length > 0)\r\n      {\r\n        this._keyWatch.deleteByIndexedArray(this._keyGarbage);\r\n        this._keyGarbage.splice(0, this._keyGarbage.length)\r\n      }\r\n\r\n  }\r\n\r\n  pressed(keycode) {\r\n\r\n    /*var keyLock = false;\r\n\r\n  if (this._keyLockPressed[keycode] == scintilla.KeyEvent.PRESSED) {\r\n      keyLock = true;\r\n      this._keyLockPressed[keycode] = scintilla.KeyEvent.PRESS;\r\n    }\r\n\r\n    var hit = this._keys[keycode] && keyLock;*/\r\n\r\n    //return hit;\r\n\r\n    return this._keyMapping.get(keycode).isPressed();\r\n    \r\n  /* if (this._keyMapping.has(keycode))\r\n    {\r\n      \r\n    } \r\n    else \r\n    {\r\n      return false;\r\n    }*/\r\n\r\n  }\r\n\r\n  release(keycode) {\r\n\r\n    /*var keyLock = false;\r\n\r\n    if (this._keyLock[keycode] ==  scintilla.KeyEvent.PRESSED ||\r\n      this._keyLock[keycode] ==  scintilla.KeyEvent.PRESS ||\r\n      this._keyLock[keycode] ==  scintilla.KeyEvent.NONE)\r\n      keyLock = false;\r\n    else\r\n      keyLock = true;\r\n\r\n    var hit = !this._keys[keycode] && keyLock;\r\n\r\n    this._keyLock[keycode] = scintilla.KeyEvent.NONE;\r\n\r\n    return hit;*/\r\n    return this._keyMapping.get(keycode).isReleased();\r\n\r\n  }\r\n\r\n  press(keycode) {\r\n\r\n\r\n    /*var key = this._keyWatch.get(keycode);\r\n\r\n    if (key === undefined)\r\n      return false;*/\r\n\r\n    return this._keyMapping.get(keycode).status;\r\n\r\n    /*var keyLock = false;\r\n\r\n    if (this._keyLock[keycode] ==  scintilla.KeyEvent.RELEASE ||\r\n      this._keyLock[keycode] ==  scintilla.KeyEvent.NONE)\r\n      keyLock = false;\r\n    else\r\n      keyLock = true;\r\n\r\n    var hit = this._keys[keycode] && keyLock;\r\n\r\n    return hit;*/\r\n\r\n  }\r\n}\r\n\r\n ","\r\nconst KeyCode = {\r\n    Backspace: 8,\r\n    Tab: 9,\r\n    Enter: 13,\r\n    Shift: 16,\r\n    Ctrl: 17,\r\n    Alt: 18,\r\n    Pause: 19,\r\n    CapsLock: 20,\r\n    Escape: 27,\r\n    Space:32,\r\n    PageUp: 33,\r\n    PageDown: 34,\r\n    End: 35,\r\n    Home: 36,\r\n    Left: 37,\r\n    Up: 38,\r\n    Right: 39,\r\n    Down: 40,\r\n    Insert: 45,\r\n    Delete:\t46,\r\n    Num0: 48,\r\n    Num1: 49,\r\n    Num2: 50,\r\n    Num3: 51,\r\n    Num4: 52,\r\n    Num5:\t53,\r\n    Num6: 54,\r\n    Num7: 55,\r\n    Num8: 56,\r\n    Num9: 57,\r\n    A: 65,\r\n    B: 66,\r\n    C: 67,\r\n    D: 68,\r\n    E: 69,\r\n    F: 70,\r\n    G: 71,\r\n    H: 72,\r\n    I: 73,\r\n    J: 74,\r\n    K: 75,\r\n    L: 76,\r\n    M: 77,\r\n    N: 78,\r\n    O: 79,\r\n    P: 80,\r\n    Q: 81,\r\n    R: 82,\r\n    S: 83,\r\n    T: 84,\r\n    U: 85,\r\n    V: 86,\r\n    W: 87,\r\n    X: 88,\r\n    Y: 89,\r\n    Z: 90,\r\n    LSystem: 91,\r\n    RSystem: 92,\r\n    SelectK:\t93,\r\n    Numpad0: 96,\r\n    Numpad1: 97,\r\n    Numpad2: 98,\r\n    Numpad3: 99,\r\n    Numpad4: 100,\r\n    Numpad5: 101,\r\n    Numpad6: 102,\r\n    Numpad7: 103,\r\n    Numpad8: 104,\r\n    Numpad9: 105,\r\n    Multiply: 106,\r\n    Add: 107,\r\n    Subtract: 109,\r\n    DecimalPoint: 110,\r\n    Divide: 111,\r\n    F1:\t112,\r\n    F2:\t113,\r\n    F3:\t114,\r\n    F4:\t115,\r\n    F5:\t116,\r\n    F6:\t117,\r\n    F7:\t118,\r\n    F8:\t119,\r\n    F9:\t120,\r\n    F10: 121,\r\n    F11: 122,\r\n    F12: 123,\r\n    NumLock: 144,\r\n    ScrollLock: 145,\r\n    SemiColon: 186,\r\n    Equal: 187,\r\n    Comma: 188,\r\n    Dash: 189,\r\n    Period:\t190,\r\n    Slash: 191,\r\n    LBraket: 219,\r\n    BackSlash: 220,\r\n    RBracket: 221,\r\n    Quote: 222,\r\n};\r\n    \r\nmodule.exports = KeyCode;","\r\n\r\nimport MouseButton from './mousebutton'\r\n  \r\n  export const MouseEvent = {\r\n  NONE : 0,\r\n  PRESS : 1,\r\n  PRESSED : 2,\r\n  RELEASE : 3\r\n  };\r\n\r\n\r\n  \r\n\r\nexport default class Mouse {\r\n  \r\n  constructor(game) {\r\n\r\n    this.x = 0;\r\n    this.y = 0;\r\n    this.game = game;\r\n    this.canvas = game.system.get('render').canvas;\r\n    this.button = 0;\r\n    this.wheelDelta = 0;\r\n    this.active = true;\r\n\r\n    this._mouseButtons = [];\r\n    this._mouseButtonsLocks = [];\r\n    this._mouseButtonsLocksPressed = [];\r\n    this._mouseDownDuration = [];\r\n\r\n    //callbacks\r\n    this._onMouseDown = null;\r\n    this._onMouseMove = null;\r\n\r\n    this.reset();\r\n  }\r\n\r\n  reset() {\r\n\r\n    for (var i = 0; i < 3; i++){\r\n\r\n\r\n            this._mouseButtons[i] = false;\r\n            this._mouseButtonsLocks[i] = MouseEvent.NONE;\r\n            this._mouseButtonsLocksPressed[i] = MouseEvent.NONE;\r\n            this._mouseDownDuration[i] = 0;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  init() {\r\n\r\n\r\n    var self = this;\r\n\r\n    this._onMouseDown = function (event) {\r\n            return self.onMouseDown(event);\r\n    };\r\n\r\n    this._onMouseUp = function (event) {\r\n            return self.onMouseUp(event);\r\n    };\r\n\r\n    this._onMouseMove = function (event) {\r\n            return self.onMouseMove(event);\r\n    };\r\n\r\n    this.canvas.addEventListener('mousedown', this._onMouseDown, true);\r\n    this.canvas.addEventListener('mousemove', this._onMouseMove, true);\r\n    this.canvas.addEventListener('mouseup', this._onMouseUp, true);\r\n    this.canvas.addEventListener('mouseover', this._onMouseOver, true);\r\n    this.canvas.addEventListener('mouseout', this._onMouseOut, true);\r\n\r\n  }\r\n\r\n  onMouseMove(event) {\r\n\r\n    if (!this.active)\r\n      return;\r\n\r\n\r\n    var rect = this.canvas.getBoundingClientRect();\r\n\r\n\r\n    this.x = Math.floor((event.clientX-rect.left)/(rect.right-rect.left)*this.canvas.width);\r\n    this.y = Math.floor((event.clientY-rect.top)/(rect.bottom-rect.top)*this.canvas.height);\r\n    //this.x = event.clientX - rect.left;\r\n    //this.y = event.clientY - rect.top;\r\n\r\n  }\r\n\r\n  onMouseDown(event) {\r\n\r\n    if (!this.active)\r\n      return;\r\n\r\n\r\n\r\n    var value = event.button;\r\n\r\n    if (this._mouseButtonsLocksPressed[value] != KeyEvent.PRESSED && this._mouseButtonsLocksPressed[value] != KeyEvent.PRESS) {\r\n      this._mouseButtonsLocksPressed[value] = MouseEvent.PRESSED;\r\n      this._mouseDownDuration[value] = 1;\r\n    }\r\n\r\n    this._mouseButtons[value] = true;\r\n    this._mouseButtonsLocks[value] = MouseEvent.PRESS;\r\n\r\n    event.preventDefault();\r\n\r\n  }\r\n\r\n  onMouseUp(event) {\r\n\r\n    if (!this.active)\r\n      return;\r\n\r\n    var value = event.button;\r\n\r\n    this._mouseButtons[value] = false;\r\n    this._mouseButtonsLocks[value] = MouseEvent.RELEASE;\r\n    this._mouseButtonsLocksPressed[value] = MouseEvent.NONE;\r\n\r\n    event.preventDefault();\r\n\r\n\r\n  }\r\n\r\n  pressed(button) {\r\n\r\n    var buttonLock = false;\r\n\r\n    if (this._mouseButtonsLocksPressed[button] == MouseEvent.PRESSED) {\r\n      buttonLock = true;\r\n      this._mouseButtonsLocksPressed[button] = MouseEvent.PRESS;\r\n    }\r\n\r\n    var hit = this._mouseButtons[button] && buttonLock;\r\n\r\n    return hit;\r\n\r\n  }\r\n\r\n  release(button) {\r\n\r\n    var buttonLock = false;\r\n\r\n  \tif (this._mouseButtonsLocks[button] ==  MouseEvent.PRESSED ||\r\n        this._mouseButtonsLocks[button] ==  MouseEvent.PRESS ||\r\n        this._mouseButtonsLocks[button] ==  MouseEvent.NONE)\r\n  \t\tbuttonLock = false;\r\n  \telse\r\n  \t\tbuttonLock = true;\r\n\r\n  \tvar hit = !this._mouseButtons[button] && buttonLock;\r\n\r\n  \tthis._mouseButtonsLocks[button] = MouseEvent.NONE;\r\n\r\n  \treturn hit;\r\n\r\n  }\r\n\r\n  press(button) {\r\n\r\n    var buttonLock = false;\r\n\r\n    if (this._mouseButtonsLocks[button] ==  MouseEvent.RELEASE ||\r\n      this._mouseButtonsLocks[button] ==  MouseEvent.NONE)\r\n      buttonLock = false;\r\n    else\r\n      buttonLock = true;\r\n\r\n    var hit = this._mouseButtons[button] && buttonLock;\r\n\r\n    return hit;\r\n\r\n\r\n  }\r\n\r\n  update() {\r\n\r\n    for (var i = 0; i < this._mouseButtons.length; i++) {\r\n\r\n          if (this._mouseButtonsLocksPressed[i] ==  MouseEvent.PRESSED) {\r\n              if (this._mouseDownDuration[i] > 0)\r\n                this._mouseDownDuration[i]--;\r\n              else\r\n                this._mouseButtonsLocksPressed[i] = MouseEvent.PRESS;\r\n          } else\r\n            continue;\r\n\r\n\r\n    }\r\n\r\n  }\r\n\r\n  posRelativeTo(object) {\r\n\r\n    var vec2 = {x:0,y:0};\r\n\r\n    vec2.x = this.x - object.x;\r\n    vec2.y = this.y - object.y;\r\n\r\n\r\n    return vec2;\r\n\r\n  }\r\n\r\n\r\n}\r\n\r\n","\r\nexport const MouseButton = {\r\n    Left : 0,\r\n    Middle : 1,\r\n    Right : 2,\r\n    WheelUp : 3,\r\n    WheelDown : 4\r\n};","\r\nvar URLObject = {\r\n\r\n    create : function(asset, response, type)\r\n    {\r\n\r\n\r\n        if (typeof URL === 'function')\r\n        {\r\n            asset.src = URL.createObjectURL(response);\r\n        }\r\n        else\r\n        {\r\n            var reader = new FileReader();\r\n\r\n            reader.onload = function ()\r\n            {\r\n                asset.removeAttribute('crossOrigin');\r\n                asset.src = 'data:' + (response.type || type) + ';base64,' + reader.result.split(',')[1];\r\n            };\r\n\r\n            reader.onerror = asset.onerror;\r\n\r\n            reader.readAsDataURL(response);\r\n        }   \r\n    },\r\n\r\n    revoke : function(data)\r\n    {\r\n        if (typeof URL === 'function')\r\n        {\r\n            URL.revokeObjectURL(data.src);\r\n        }\r\n    }\r\n};\r\n\r\nmodule.exports = URLObject;","\r\n\r\nexport default (\r\n    class XHR {\r\n\r\n    static createFileRequest(file, settings)\r\n    {\r\n        var xhrSettings = XHR.merge(settings, file.xhrSettings);\r\n\r\n        var xmlHttpRequest = new XMLHttpRequest();\r\n        xmlHttpRequest.open(\"GET\", file.source, xhrSettings.async);\r\n\r\n        if (file.xhrSettings.responseType !== undefined)\r\n            xmlHttpRequest.responseType = file.xhrSettings.responseType;\r\n        xmlHttpRequest.timeout = xhrSettings.timeout;\r\n\r\n        xmlHttpRequest.onload = file.onLoad.bind(file);\r\n        xmlHttpRequest.onerror = file.onError.bind(file);\r\n        xmlHttpRequest.onprogress = file.onProgress.bind(file);\r\n        \r\n        if (file.onReadyStateChange !== undefined)\r\n            xmlHttpRequest.onreadystatechange = file.onReadyStateChange.bind(file);\r\n\r\n        xmlHttpRequest.send();\r\n\r\n        return xmlHttpRequest;\r\n    }\r\n\r\n    static createSettings(type, doAsync, timeout)\r\n    {\r\n        if (type === undefined) \r\n            type = '';\r\n\r\n        if (doAsync === undefined) \r\n            doAsync = true;\r\n\r\n        if (timeout === undefined)\r\n            timeout = 0;\r\n\r\n        var settings = {\r\n            responseType: type,\r\n            timeout: timeout,\r\n            async: doAsync,\r\n        }\r\n\r\n        return settings;\r\n    }\r\n\r\n    static merge(a, b)\r\n    {\r\n        var out = {};\r\n\r\n        if (a === undefined)\r\n            out = XHR.createSettings(); // : Extend(global);\r\n        // else\r\n            // do something cool\r\n\r\n        if (b)\r\n        {\r\n            for (let setting in b)\r\n            {\r\n                if (b[setting] !== undefined)\r\n                    out[setting] = b[setting];\r\n            }\r\n        }\r\n    \r\n        return out;\r\n    }\r\n\r\n\r\n\r\n})\r\n\r\n","\r\nimport { LOADER_STATE, AssetTypeHandler} from '../loaderstate'\r\nimport File from '../file'\r\nimport URLObject from '../URLobject'\r\nimport ObjectUtils from '../../utils/objectutils'\r\nimport PathUtils from '../../utils/pathutils'\r\n\r\nexport default class ImageFile extends File {\r\n    \r\n\r\n    constructor(tag, url, path, xhrSettings, config)\r\n    {\r\n        var assetTag = null;\r\n        \r\n        if (typeof tag === 'string')\r\n        {\r\n            assetTag = tag;\r\n        }\r\n        else\r\n        {\r\n            assetTag = ObjectUtils.getValue(tag, 'tag', '');\r\n        }\r\n\r\n        var fileConfig = {\r\n            type: 'image',\r\n            tag: assetTag,\r\n            ext: ObjectUtils.getValue(tag, 'ext', PathUtils.getExtension(url)),\r\n            url: ObjectUtils.getValue(tag, 'file', url),\r\n            path: path,\r\n            responseType: 'blob',\r\n            xhrSettings: ObjectUtils.getValue(tag, 'xhr', xhrSettings),\r\n            config: ObjectUtils.getValue(tag, 'config', config)\r\n        };\r\n\r\n        super(fileConfig);\r\n    }\r\n\r\n    onProcessing(processingCallback)\r\n    {\r\n        this.state = LOADER_STATE.PROCESSING;\r\n        this.data = new Image();\r\n        this.data.crossOrigin = this.crossOrigin;\r\n\r\n\r\n        var self = this;\r\n\r\n        this.data.onload = function () {\r\n\r\n            URLObject.revoke(self.data);\r\n\r\n            self.onDone();\r\n\r\n            processingCallback(self);\r\n        };\r\n\r\n        this.data.onerror = function () {\r\n\r\n            URLObject.revoke(self.data);\r\n\r\n            self.state = LOADER_STATE.ERROR;\r\n\r\n            processingCallback(self);\r\n\r\n        };\r\n\r\n\r\n        URLObject.create(this.data, this.xhrRequest.response, 'image/' + this.config.ext);\r\n    }\r\n\r\n}\r\n\r\nAssetTypeHandler.register('image', function (tag, url, path, xhrSettings)\r\n{\r\n\r\n\r\n    this.addAsset(new ImageFile(tag, url, this.path, xhrSettings));\r\n\r\n    return this;\r\n\r\n});\r\n\r\nmodule.exports = ImageFile;","\r\nmodule.exports = {\r\n    ImageFile : require('./imagefile'),\r\n    TextFile : require('./textfile')\r\n}","\r\nimport { LOADER_STATE, AssetTypeHandler} from '../loaderstate'\r\nimport File from '../file'\r\nimport ObjectUtils from '../../utils/objectutils'\r\nimport PathUtils from '../../utils/pathutils'\r\n\r\nexport default class TextFile extends File {\r\n\r\n    constructor(tag, url, path, xhrSettings, config)\r\n    {\r\n        let assetTag = null;\r\n        \r\n        if (typeof tag === 'string')\r\n        {\r\n            assetTag = tag;\r\n        }\r\n        else\r\n        {\r\n            assetTag = ObjectUtils.getValue(tag, 'tag', '');\r\n        }\r\n\r\n        let useExternal = false;\r\n\r\n        if (path !== undefined)\r\n        {\r\n            if (typeof(path) === \"boolean\")\r\n                useExternal = path;\r\n\r\n            \r\n        }\r\n\r\n        var fileConfig = {\r\n            type: 'text',\r\n            tag: assetTag,\r\n            ext: ObjectUtils.getValue(tag, 'ext', PathUtils.getExtension(url)),\r\n            url: ObjectUtils.getValue(tag, 'file', url),\r\n            path: path,\r\n            responseType: '',\r\n            xhrSettings: ObjectUtils.getValue(tag, 'xhr', xhrSettings),\r\n            config: ObjectUtils.getValue(tag, 'config', config),\r\n            useExternal : useExternal\r\n        };\r\n\r\n        super(fileConfig);\r\n    }\r\n    \r\n    //onLoad(event) {}\r\n\r\n    /*onReadyStateChange(event)\r\n    {\r\n\r\n        console.log(event.target);\r\n        if (this.xhrRequest.status == 200)\r\n        {\r\n            if (this.xhrRequest.readyState == 4)\r\n            {\r\n                this.state = LOADER_STATE.PROCESSING;\r\n                //this.data = window.URL.createObjectURL(this.xhrRequest.response);\r\n                this.data = this.xhrRequest.responseText;\r\n                \r\n                //console.log(this.data);\r\n                this.onDone();\r\n\r\n                //processingCallback(this);\r\n                super.onLoad(event);\r\n            }  \r\n        } else {\r\n            super.onLoad(event);\r\n        }\r\n    }*/\r\n\r\n    onProcessing(processingCallback)\r\n    {\r\n        this.state = LOADER_STATE.PROCESSING;\r\n            //this.data = window.URL.createObjectURL(this.xhrRequest.response);\r\n            this.data = this.xhrRequest.responseText;\r\n            /*var style = document.createElement('style');\r\n            style.innerHTML = this.data;\r\n            document.head.appendChild(style)*/\r\n           // console.log(\"data:\" + this.data);\r\n            this.onDone();\r\n\r\n            processingCallback(this);\r\n    }\r\n\r\n}\r\n\r\nAssetTypeHandler.register('text', function (tag, url, path, xhrSettings)\r\n{\r\n    let endPointPath = this.path;\r\n\r\n    if (path !== undefined)\r\n    {\r\n        \r\n        if (typeof(path) === \"boolean\") // external link\r\n            endPointPath = path;\r\n        \r\n    }\r\n\r\n    this.addAsset(new TextFile(tag, url, endPointPath, xhrSettings));\r\n\r\n    return this;\r\n\r\n});\r\n\r\nmodule.exports = TextFile;","\r\nimport ObjectUtils from '../utils/objectutils'\r\nimport XHR from './XHR'\r\nimport {LOADER_STATE} from './loaderstate'\r\n\r\nexport default class File {\r\n\r\n    constructor(config) {\r\n\r\n        this.type = ObjectUtils.getValue(config, 'type', null);\r\n        this.tag = ObjectUtils.getValue(config, 'tag', null);\r\n        this.useExternal =  ObjectUtils.getValue(config, 'useExternal', false);\r\n\r\n        if (this.type == null || this.tag == null)\r\n        {\r\n            throw new Error('Loader.File: Invalid tag \\\"' + tag + \"\\\".\");\r\n        }\r\n\r\n        this.url = ObjectUtils.getValue(config, 'url', undefined);\r\n\r\n        if (this.url === undefined)\r\n            this.url = ObjectUtils.getValue(config, 'path', '') + this.tag + '.' + ObjectUtils.getValue(config, 'ext', '');\r\n        else\r\n        {\r\n            if (!this.useExternal)\r\n                this.url = ObjectUtils.getValue(config, 'path', '').concat(this.url);\r\n\r\n        }\r\n\r\n        this.xhrSettings = XHR.createSettings(ObjectUtils.getValue(config, 'responseType', undefined));\r\n        \r\n        if (ObjectUtils.getValue(config, 'xhrSettings', false))\r\n            this.xhrSettings = XHR.merge(this.xhrSettings, ObjectUtils.getValue(config, 'xhrSettings', {}));\r\n\r\n        \r\n        //console.log(this.xhrSettings);\r\n       \r\n        this.loader = null;\r\n        this.state = LOADER_STATE.PENDING;\r\n        this.totalBytes = 0;\r\n        this.loadedBytes = 0;\r\n        this.progress = 0;\r\n        this.data = undefined;\r\n        this.source = null;\r\n        this.xhrRequest = null;\r\n        this.config = ObjectUtils.getValue(config,'config',{});\r\n        this.crossOrigin = undefined;\r\n\r\n        // callbacks\r\n        //loaded: false,\r\n        //error: false,\r\n        //loading:false,\r\n\r\n    }\r\n\r\n    load(gameLoader)\r\n    {\r\n        this.loader = gameLoader;\r\n\r\n\r\n        if (this.state === LOADER_STATE.FINISHED)\r\n        {\r\n            this.onDone();\r\n\r\n            this.loader.nextFile(this);\r\n        }\r\n        else\r\n        {\r\n           \r\n\r\n            this.source = ObjectUtils.getURL(this.url, gameLoader.baseURL);\r\n\r\n            \r\n            if (this.source.indexOf('data:') === 0 || this.source == null)\r\n            {\r\n                console.warn(\"Loader.File.load: unsupported URI.\");\r\n            }\r\n            else\r\n            {\r\n                this.xhrRequest = XHR.createFileRequest(this, gameLoader.xhr);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    onLoad(event)\r\n    {\r\n       \r\n        this.XHRreset();\r\n\r\n        if (event.target && event.target.status !== 200)\r\n            this.loader.next(this, true);\r\n        else\r\n            this.loader.next(this, false);\r\n        \r\n                \r\n    }\r\n\r\n    onError()\r\n    {\r\n        console.error(\"Loader.File: Error to load file.\")\r\n\r\n        this.XHRreset();\r\n\r\n        this.loader.next(this, true);\r\n    }\r\n\r\n    onProgress(event)\r\n    {\r\n        if (event.lengthComputable)\r\n        {\r\n            this.loadedBytes = event.loaded;\r\n            this.totalBytes = event.total;\r\n\r\n            this.progress = Math.min((this.loadedBytes / this.totalBytes), 1);\r\n\r\n        }\r\n    }\r\n\r\n    onDone()\r\n    {\r\n        this.state = LOADER_STATE.DONE;\r\n    }\r\n\r\n    onProcessing(processingCallback)\r\n    {\r\n        this.state = LOADER_STATE.PROCESSING;\r\n\r\n        this.onDone();\r\n\r\n        processingCallback(this);\r\n    }\r\n\r\n\r\n    XHRreset()\r\n    {\r\n        if (this.xhrRequest)\r\n        {\r\n            this.xhrRequest.onload = undefined;\r\n            this.xhrRequest.onerror = undefined;\r\n            this.xhrRequest.onprogress = undefined;\r\n            this.xhrRequest.onreadystatechange = undefined;\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\r\n","module.exports = {\r\n\r\n   \r\n\r\n    File: require('./file'),\r\n    XHR: require('./XHR'),\r\n    URLObject : require('./URLobject'),\r\n    AssetsTypes: require('./assets'),\r\n    LoaderState: require('./loaderstate'),    \r\n    LoaderManager: require('./loadmanager'),\r\n    \r\n\r\n\r\n};","\r\nexport default class ListInjector {\r\n\r\n    constructor()\r\n    {\r\n        this.list = {};\r\n    }\r\n\r\n    inject(toObj)\r\n    {\r\n        for (var key in this.list)\r\n        {\r\n            toObj[key] = this.list[key];\r\n        }\r\n    }\r\n\r\n    register(key, func)\r\n    {\r\n        this.list[key] = func;\r\n    }\r\n\r\n    destroyfunction()\r\n    {\r\n        this.list = {};\r\n    }\r\n\r\n};","\r\nimport ListInjector from './listinjector'\r\n\r\nexport var AssetTypeHandler = new ListInjector();\r\n\r\nexport const LOADER_STATE = {\r\n    NONE : 0,\r\n    IDLE : 1,\r\n    PENDING : 2,\r\n    LOADING : 3,\r\n    PROCESSING : 4,\r\n    ERROR : 5,\r\n    FINISHED : 6,\r\n    DONE : 7, \r\n}\r\n\r\n//export var AssetTypeHandler;\r\n//export var LOADER_STATE;\r\n","\r\nimport { LOADER_STATE, AssetTypeHandler} from './loaderstate'\r\nimport SetData from '../structures/set'\r\nimport XHR from './XHR'\r\nimport ObjectUtils from '../utils/objectutils';\r\nimport GameSystemManager from '../core/gameSystemManager';\r\n\r\n// Class LoaderManager\r\nexport default class LoadManager {\r\n  \r\n  constructor(game) {\r\n\r\n    this.game = game;\r\n    this.cache = null;\r\n\r\n    this._filesQueue = null;\r\n    this._filesLoading = null;\r\n    this._successFiles = null;\r\n    this._failedFiles = null;\r\n    this._processedFiles = null;\r\n\r\n    this._filesQueueCount = null;\r\n    this._loadedFilesCount = null;\r\n\r\n    this.isDownloading = false;\r\n    this._totalFiles = 0;\r\n\r\n    this.progress = null;\r\n    this.path = null;\r\n    this.baseURL = null;\r\n    this.state = null;\r\n\r\n    let gameConfig = game.config.loader;\r\n\r\n    this.xhr = XHR.createSettings(\r\n      ObjectUtils.getValue(config, 'responseType', gameConfig.responseType),\r\n      ObjectUtils.getValue(config, 'async', gameConfig.async),\r\n      //scintilla.ObjectUtils.getPropertyValue(config, 'user', gameConfig.loaderUser),\r\n      //scintilla.ObjectUtils.getPropertyValue(config, 'password', gameConfig.loaderPassword),\r\n      ObjectUtils.getValue(config, 'timeout', gameConfig.timeout)\r\n  );\r\n  \r\n\r\n    AssetTypeHandler.inject(this);\r\n\r\n  }\r\n\r\n  init()\r\n  {\r\n    this.cache = this.game.system.cache;\r\n\r\n    this._filesQueue = new SetData();\r\n    this._filesLoading = new SetData();\r\n    this._successFiles = new SetData();\r\n    this._failedFiles = new SetData();\r\n    this._processedFiles = new SetData();\r\n\r\n    this._filesQueueCount = 0;\r\n    this._loadedFilesCount = 0;\r\n\r\n    this.progress = 0;\r\n    this.path = '';\r\n    this.baseURL = '';\r\n    this.state = LOADER_STATE.IDLE;\r\n  }\r\n\r\n\r\n  setPath(path) {\r\n    if (path !== '' && path.substr(-1) !== '/')\r\n        path = path.concat('/');\r\n\r\n    this.path = path;\r\n\r\n    return this;\r\n  }\r\n\r\n  setBaseURL(baseUrl) {\r\n    if (baseUrl !== '' && baseUrl.substr(-1) !== '/')\r\n    {\r\n      baseUrl = baseUrl.concat('/');\r\n    }\r\n\r\n    this.baseURL = baseUrl || '';\r\n\r\n    return this;\r\n  }\r\n\r\n  addAsset(asset) {\r\n    if (!this.isOK())\r\n        return -1;\r\n\r\n    asset.path = this.path;\r\n    this._filesQueue.set(asset);\r\n    this._filesQueueCount++;\r\n    return asset;\r\n\r\n  }\r\n\r\n  reset() {\r\n\r\n    this.isDownloading = false;\r\n    this._filesQueue.clear();\r\n    this._successFiles.clear();\r\n    this._failedFiles.clear();\r\n    this._processedFiles.clear();\r\n\r\n    this._filesQueueCount = 0;\r\n    this._loadedFilesCount = 0;\r\n\r\n    this.progress = 0\r\n    this.state = LOADER_STATE.IDLE;\r\n\r\n  }\r\n\r\n  start() {\r\n\r\n    if (!this.isOK())\r\n    {\r\n        return -1;\r\n    }\r\n\r\n    this.progress = 0;\r\n    this._loadedFilesCount = 0;\r\n    this.state = LOADER_STATE.LOADING;\r\n    this._filesQueueCount = this._filesQueue.size;\r\n\r\n    if (this._filesQueue.size === 0)\r\n    {\r\n      //console.log(0);\r\n      this.loadFinished();\r\n    }\r\n    else\r\n    {\r\n      this.isDownloading = true;\r\n      this._successFiles.clear();\r\n      this._failedFiles.clear();\r\n      this._filesLoading.clear();\r\n\r\n      this.processFileQueue();\r\n    }\r\n\r\n  }\r\n\r\n  /*end : function() {\r\n\r\n    if (this.state === LOADER_STATE.PROCESSING)\r\n        return;\r\n  \r\n    this.progress = 1;\r\n    this.isDownloading = false;\r\n    this.state = LOADER_STATE.PROCESSING;\r\n\r\n    \r\n    this._filesQueue.clear();\r\n    this._failedFiles.length = 0;\r\n    \r\n    this.processFiles();\r\n\r\n    this._successFiles.clear();\r\n\r\n    this.state = LOADER_STATE.DONE;\r\n    //this.game.scene.preloadComplete();\r\n\r\n  },*/\r\n\r\n  processFileQueue() {\r\n\r\n    var self = this;\r\n\r\n    this._filesQueue.each(function(file) {\r\n\r\n      //var file = this._filesQueue[i];\r\n\r\n      if (file.state === LOADER_STATE.FINISHED ||\r\n         file.state === LOADER_STATE.PENDING) //  && this.inflight.size < this.maxParallelDownloads))\r\n      {\r\n        \r\n\r\n        self._filesLoading.set(file);\r\n\r\n        self._filesQueue.delete(file);\r\n\r\n        self.loadAsset(file);\r\n      }\r\n\r\n    });\r\n\r\n  }\r\n\r\n  loadAsset(file)\r\n  {\r\n    file.load(this);\r\n  }\r\n\r\n  next(concludedFile, hasError) {\r\n\r\n      if (hasError)\r\n          this._failedFiles.set(concludedFile);\r\n      else \r\n          this._successFiles.set(concludedFile);\r\n      \r\n\r\n      this._filesLoading.delete(concludedFile);\r\n      //this._filesQueue.delete(concludedFile);\r\n      this._loadedFilesCount++;\r\n\r\n      this.updateProgress();\r\n\r\n      if (this._filesQueue.size > 0)//(this._loadedFilesCount < this._filesQueueCount)\r\n      {\r\n          this.processFileQueue();\r\n      } else if (this._filesLoading.size === 0) {\r\n        \r\n          this.loadFinished();\r\n      }\r\n\r\n  }\r\n\r\n  loadFinished() {\r\n\r\n    if (this.state === LOADER_STATE.PROCESSING)\r\n        return;\r\n  \r\n    this.progress = 1;\r\n    this.isDownloading = false;\r\n    this.state = LOADER_STATE.PROCESSING;\r\n\r\n    this._processedFiles.clear();\r\n\r\n    if (this._successFiles.size === 0)\r\n    {\r\n     \r\n        this.processingDone();\r\n    } else {\r\n     \r\n      this._successFiles.each(function(file) {\r\n        file.onProcessing(this.processingUpdate.bind(this));\r\n      },this);\r\n    }\r\n   \r\n  }\r\n\r\n\r\n  processingUpdate(file) {\r\n    \r\n    if (file.state === LOADER_STATE.ERROR)\r\n    {\r\n       this._failedFiles.set(file);\r\n\r\n        /*if (file.linkFile)\r\n        {\r\n            this.queue.delete(file.linkFile);\r\n        }*/\r\n        return this.deleteFromSuccessQueue(file);\r\n    }\r\n\r\n\r\n    this._processedFiles.set(file);\r\n\r\n    return this.deleteFromSuccessQueue(file);\r\n\r\n  }\r\n\r\n  deleteFromSuccessQueue(file) {\r\n    \r\n      this._successFiles.delete(file);\r\n\r\n      if (this._successFiles.size === 0 && this.state === LOADER_STATE.PROCESSING)\r\n          this.processingDone();\r\n  }\r\n\r\n  processingDone() {\r\n    this._successFiles.clear();\r\n    this._filesQueue.clear();\r\n\r\n    var cache = this.cache;\r\n\r\n    if (this._processedFiles.size > 0)\r\n    {\r\n      this._processedFiles.each(function(file) {\r\n\r\n        switch (file.type)\r\n        {\r\n          default:\r\n            break;\r\n\r\n          case 'image': {\r\n            cache.addImage(file.tag,file.url,file.data);\r\n            break;\r\n          }\r\n          case 'audio': {\r\n\r\n            file.data = requestXHR.response;\r\n\r\n            cache.addSound(file.tag,file.url,file.data,true);\r\n\r\n            if (file.autoDecode)\r\n            {\r\n                this.game.sound.decode(file.tag);\r\n            }\r\n\r\n            break;\r\n          }\r\n        }\r\n\r\n      })\r\n\r\n      this._processedFiles.clear();\r\n    }\r\n\r\n    this.state = LOADER_STATE.DONE;\r\n\r\n    this.game.scene.preloadComplete();\r\n  }\r\n\r\n  isLoading() {\r\n    return (this.state === LOADER_STATE.LOADING || this.state === LOADER_STATE.PROCESSING);\r\n  }\r\n\r\n  isOK() {\r\n    return (this.state === LOADER_STATE.IDLE || this.state === LOADER_STATE.DONE || this.state === LOADER_STATE.ERROR);\r\n  }\r\n\r\n  downloadIsDone() {\r\n    return (this._filesQueue.length == (this._successCount + this._fileErrorCount));\r\n  }\r\n\r\n  updateProgress() {\r\n\r\n    var progress = 0;\r\n\r\n    if (this._filesQueueCount != 0)\r\n    {\r\n      this.progress = 1 - (this._loadedFilesCount / this._filesQueueCount);\r\n    }\r\n     //progress = parseFloat(this._successCount) / parseFloat(this._filesQueueCount);\r\n\r\n    this.progress = progress;\r\n\r\n  }\r\n\r\n\r\n  get totalQueuedFiles() {\r\n    return this._filesQueueCount - this._loadedFilesCount;\r\n  }\r\n\r\n\r\n};\r\n\r\nGameSystemManager.register('Loader',LoadManager,'load');","\r\nimport Vector from './vector'\r\nimport Rect from './rect'\r\n\r\nexport default class BoundingBox {\r\n  \r\n  constructor(x, y, width, height) {\r\n\r\n    let xx = x || 0;\r\n    let yy = y || 0;\r\n    let w = width || 0;\r\n    let h = height || 0;\r\n    //this.center = new scintilla.Vector(x+width/2,y+height/2);\r\n    //this.size = new scintilla.Vector(width,height);\r\n    this.min = new Vector(xx,yy);\r\n    this.max = new Vector(xx+w,yy+h);\r\n    this.box = new Rect(xx,yy,w,h);\r\n\r\n  }\r\n\r\n  \r\n  get center() {\r\n    return new Vector(\r\n      (this.max.x - this.min.x) / 2,\r\n      (this.max.y - this.min.y) / 2\r\n    );\r\n  }\r\n\r\n  get size() {\r\n    return new Vector(\r\n      (this.max.x - this.min.x),\r\n      (this.max.y - this.min.y)\r\n    );\r\n  }\r\n\r\n  intersects(value)\r\n  {\r\n    if (BoundingBox.prototype.isPrototypeOf(value))\r\n    {\r\n      // TODO\r\n    }\r\n  }\r\n\r\n  contains(value)\r\n  {\r\n    // TODO\r\n  }\r\n\r\n  set(minX, minY, maxX, maxY) {\r\n\r\n    this.min.set(minX,minY);\r\n    this.max.set(maxX,maxY);\r\n    this.box.set(this.min.x,this.min.y,this.max.x-this.min.x,this.max.y-this.min.y);\r\n\r\n  }\r\n\r\n\r\n  // position (vector)\r\n  // scale (vector)\r\n  // rotation (vector x = cos, y = sin)\r\n  setup(pos, scale, rotation, anchor, width, height) {\r\n\r\n    var coords = [];\r\n    var negx = 1;\r\n    var negy = 1;\r\n\r\n    if (scale.x < 0)\r\n          negx = -1;\r\n    if (scale.y < 0)\r\n          negy = -1;\r\n\r\n\r\n\r\n    this.size.x = width*scale.x*negx;\r\n    this.size.y = height*scale.y*negy;\r\n    anchor.x *= scale.x*negx;\r\n    anchor.y *= scale.y*negy;\r\n    pos.x -= anchor.x;\r\n    pos.y -= anchor.y;\r\n    anchor.x += pos.x;\r\n    anchor.y += pos.y;\r\n\r\n    var callback = null;\r\n\r\n    if (rotation instanceof  scintilla.Vector)\r\n        callback = this['calcCoordsCosSin'];\r\n      else\r\n        callback = this['calcCoords'];\r\n\r\n    coords[0] = callback( pos.x, pos.y, anchor, rotation);\r\n    coords[1] = callback( pos.x + this.size.x,  pos.y, anchor,rotation);\r\n\r\n    coords[2] = callback( pos.x , pos.y + this.size.y, anchor,rotation);\r\n    coords[3] = callback( pos.x + this.size.x , pos.y + this.size.y,anchor, rotation);\r\n\r\n\r\n\r\n    this.min.x = Math.min(coords[0].x,coords[1].x,coords[2].x,coords[3].x);\r\n    this.min.y = Math.min(coords[0].y,coords[1].y,coords[2].y,coords[3].y);\r\n\r\n    this.max.x = Math.max(coords[0].x,coords[1].x,coords[2].x,coords[3].x);\r\n    this.max.y = Math.max(coords[0].y,coords[1].y,coords[2].y,coords[3].y);\r\n    this.center.x = pos.x+(this.max.x-this.min.x)/2;\r\n    this.center.y = pos.y+(this.max.y-this.min.y)/2;\r\n    this.box.set(this.min.x,this.min.y,this.max.x-this.min.x,this.max.y-this.min.y);\r\n\r\n  }\r\n\r\n  /*setBySprite : function(sprite, position, scale, rotation) {\r\n\r\n      //this.set(position,scale,rotation,);\r\n\r\n  }*/\r\n\r\n  setByGameObject(gameObject, local) {\r\n\r\n    //if (gameObject.render != null) {\r\n\r\n      if (local) {\r\n        this.setup(gameObject.position,\r\n                gameObject.scale,\r\n                gameObject._cosSin,\r\n                gameObject.render.origin,\r\n                gameObject.render.width,\r\n                gameObject.render.height\r\n              );\r\n      } else {\r\n\r\n        var frame = gameObject.component['render'].frame;\r\n\r\n        var pos = {x:gameObject.worldPosition.x, y:gameObject.worldPosition.y};\r\n        var org = {\r\n          x:gameObject.origin.x * frame.width,\r\n          y:gameObject.origin.y * frame.height};\r\n\r\n        pos.x += gameObject.game.camera.view.x;\r\n        pos.y += gameObject.game.camera.view.y;\r\n\r\n        this.setup(pos,\r\n                gameObject.worldScale,\r\n                gameObject.worldRotation,\r\n                org,\r\n                frame.width,\r\n                frame.height\r\n              );\r\n      }\r\n\r\n\r\n    return this;\r\n\r\n\r\n  }\r\n\r\n  setByPosition(position) {\r\n\r\n    this.min.set(position.x,position.y);\r\n    this.max.set(position.x+1,position.y+1)\r\n    this.box.set(position.x,position.y,1,1);\r\n\r\n  }\r\n\r\n  setByShape(shape,position) {\r\n\r\n\r\n    var minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\r\n    var type = shape.getType();\r\n\r\n    if (type == \"Polygon\") {\r\n\r\n      var points = shape.getPoints();\r\n\r\n      points.forEach(function (point) {\r\n          minX = Math.min(minX, point.x);\r\n          minY = Math.min(minY, point.y);\r\n          maxX = Math.max(maxX, point.x);\r\n          maxY = Math.max(maxY, point.y);\r\n\r\n      });\r\n    }\r\n\r\n    if (position !== undefined) {\r\n      minX += position.x;\r\n      minY += position.y;\r\n      maxX += position.x;\r\n      maxY += position.y;\r\n    }\r\n\r\n\r\n    this.min.set(minX,minY);\r\n    this.max.set(maxX,maxY)\r\n    this.box.set(minX,minY,maxX-minX,maxY-minY);\r\n\r\n  }\r\n\r\n  calcCoordsCosSin(x, y, anchor, cos_and_sin) {\r\n\r\n    var coord = {x:0,y:0};\r\n\r\n    coord.x = anchor.x + ((x-anchor.x) * cos_and_sin.x) - ((y-anchor.y) * cos_and_sin.y);\r\n    coord.y = anchor.y - ((x-anchor.x) * cos_and_sin.y) - ((y-anchor.y) * cos_and_sin.x);\r\n\r\n      return coord;\r\n\r\n  }\r\n\r\n  calcCoords(x,y,anchor,rotation) {\r\n\r\n    var coord = {x:0,y:0};\r\n\r\n    coord.x = anchor.x + ((x-anchor.x) * Math.cos(rotation)) - ((y-anchor.y) * Math.sin(rotation));\r\n    coord.y = anchor.y - ((x-anchor.x) * Math.sin(rotation)) - ((y-anchor.y) * Math.cos(rotation));\r\n\r\n      return coord;\r\n\r\n  }\r\n\r\n}\r\n","\r\n\r\n\r\n\r\nexport const MathUtils = {\r\n\r\nrandomRange : function(min, max) {\r\n\r\n  return Math.random() * (max - min) + min;\r\n\r\n},\r\n\r\nirandomRange : function(min, max) {\r\n\r\n  return Math.floor(Math.random() * (max - min + 1)) + min;\r\n\r\n},\r\n\r\nlerp : function(fromValue,toValue,t) {\r\n\r\n  return (1.0-t) * fromValue + t * toValue;\r\n\r\n},\r\n\r\nlerpAngle : function(fromValue,toValue,t) {\r\n\r\n  /*var shortest_angle = ((((toValue - fromValue) % 360) + 540) % 360) - 180;\r\n  return shortest_angle * t;*/\r\n\r\n  var end = toValue;\r\n  var start = fromValue;\r\n\r\n  var difference = Math.abs(end - start);\r\n  if (difference > 180)\r\n  {\r\n      // We need to add on to one of the values.\r\n      if (end > start)\r\n      {\r\n          // We'll add it on to start...\r\n          start += 360;\r\n      }\r\n      else\r\n      {\r\n          // Add it on to end.\r\n          end += 360;\r\n      }\r\n  }\r\n\r\n        // Interpolate it.\r\n      var value = (start + ((end - start) * t));\r\n\r\n        // Wrap it..\r\n        var rangeZero = 360;\r\n\r\n        if (value >= 0 && value <= 360)\r\n            return value;\r\n\r\n        return (value % rangeZero);\r\n\r\n\r\n},\r\n\r\ndistance : function(x0,y0,x1,y1) {\r\n\r\n   return Math.sqrt((x0 -= x1) * x0 + (y0 -= y1) * y0);\r\n\r\n},\r\n\r\nangleBetween : function(x0,y0,x1,y1) {\r\n\r\n  var angle = this.toDegree(Math.atan2(y1 - y0, x1 - x0));\r\n\r\n  if (angle < 0 && angle >= -180)\r\n    angle = 360 + angle;\r\n\r\n\r\n   return angle;\r\n\r\n},\r\n\r\ndegToRad : Math.PI / 180,\r\nradToDeg : 180 / Math.PI,\r\nTAU : Math.PI * 2,\r\n\r\ntoDegree : function(radians) {\r\n\r\n  return radians * tobiJS.Math.radToDeg;\r\n\r\n},\r\n\r\ntoRadian : function(degrees) {\r\n\r\n  return degrees * tobiJS.Math.degToRad;\r\n\r\n}\r\n\r\n}\r\n\r\nmodule.exports = MathUtils;\r\n\r\n\r\n","\r\n/*\r\n\r\n\r\n* | a | b | x | * | 0 | 2 | 4 |\r\n* | c | d | y | * | 1 | 3 | 5 |\r\n* | 0 | 0 | 1 |\r\n\r\n* | 0 | 3 | 6 | * | a | c | x |\r\n* | 1 | 4 | 7 | * | b | d | y |\r\n* | 2 | 5 | 8 | * | 0 | 0 | 1 |\r\n\r\na = scale_x\r\nb = cos\r\nx = x translate\r\n\r\nc = scale_y\r\nd = sin\r\ny = y translate\r\n\r\nHTML5/CSS3 uses matrices in column-major order based.\r\n\r\n*/\r\n\r\nclass Matrix {\r\n  \r\n  /*\r\n  * Constructor is identity only\r\n  */\r\n  constructor(a, b) {\r\n\r\n    /*a = a || i;\r\n    b = b || 0;\r\n    x = x || 0;\r\n\r\n    c = c || 0;   \r\n    d = d || i;   \r\n    y = y || 0;*/\r\n\r\n    a = a || 0;\r\n    b = b || 0;\r\n\r\n    this.a = [];\r\n\r\n    // first column\r\n    this.a[0] = a;\r\n    this.a[1] = b;\r\n    this.a[2] = b;\r\n    // second column\r\n    this.a[3] = b;\r\n    this.a[4] = a;\r\n    this.a[5] = b;\r\n    // third column\r\n    this.a[6] = b; \r\n    this.a[7] = b;\r\n    this.a[8] = a;\r\n    //this.at = null;\r\n\r\n  }\r\n\r\n  at(i, j) {\r\n    return this.a[i + j * 3];\r\n  }\r\n\r\n  set(i, j, value) {\r\n    this.a[i + j * 3] = value;\r\n    return this;\r\n  }\r\n\r\n  setIdentity() {\r\n    return this.setTransform(\r\n      1,0,0,\r\n      0,1,0,\r\n      0,0,1\r\n    );\r\n  }\r\n\r\n  setTransform(a, b, c, d, e, f, g, h, i) {\r\n\r\n    this.a[0] = a;\r\n    this.a[1] = b;\r\n    this.a[2] = c; // 0\r\n\r\n    this.a[3] = d;\r\n    this.a[4] = e;\r\n    this.a[5] = f; // 0\r\n\r\n    this.a[6] = g; // x\r\n    this.a[7] = h; // y\r\n    this.a[8] = i;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  translate(x, y) {\r\n\r\n\r\n  /* | a | b | x | * | 0 | 2 | 4 |\r\n  *  | c | d | y | * | 1 | 3 | 5 |\r\n\r\n  * | 0 | 3 | 6 | * | a | c | x |\r\n  * | 1 | 4 | 7 | * | b | d | y |\r\n  * | 2 | 5 | 8 |\r\n  */\r\n    // 4 = 0 * x * 2 * y + 4\r\n    // 6 = 0 * x * 3 * y + 6\r\n\r\n    // 5 = 1 * x + 3 * y + 5\r\n    // 7 = 1 * x + 4 * y + 7\r\n    this.a[6] = this.a[0] * x + this.a[3] * y + this.a[6];\r\n    this.a[7] = this.a[1] * x + this.a[4] * y + this.a[7];\r\n    return this;\r\n  }\r\n\r\n  scale(x, y) {\r\n\r\n    this.a[0] *= x; // a\r\n    this.a[1] *= x; // b\r\n\r\n    this.a[3] *= y; // c\r\n    this.a[4] *= y; // d\r\n\r\n    this.a[6] *= x; // x\r\n    this.a[7] *= y; // y\r\n    return this;\r\n\r\n  }\r\n\r\n  rotate(radianAngle) {\r\n    let cos = Math.cos(radianAngle);\r\n    let sin = Math.sin(radianAngle);\r\n\r\n    return this.radianRotate(cos, sin);\r\n }\r\n\r\n radianRotate(cos, sin) {\r\n return this.transform(cos, sin, -sin, cos, 0, 0);\r\n }\r\n\r\n transform(a, b, c, d, x, y) {\r\n  let a00 = this.a[0]; // a\r\n  let a01 = this.a[1]; // b\r\n\r\n  let a10 = this.a[3]; // c\r\n  let a11 = this.a[4]; // d\r\n\r\n  let a20 = this.a[5]; // x\r\n  let a21 = this.a[6]; // y\r\n\r\n  this.a[0] = a * a00 + b * a10; // a * a0 + b * c0;\r\n  this.a[1] = a * a01 + b * a11; // a * b0 + b * d0;\r\n\r\n  this.a[3] = c * a00 + d * a10; // c * a0 + d * c0;\r\n  this.a[4] = c * a01 + d * a11; // c * b0 + d * d0;\r\n\r\n  this.a[6] = x * a00 + y * a10 + a20; // x * a0 + y * c0 + x0;\r\n  this.a[7] = x * a01 + y * a11 + a21; // x * b0 + y * d0 + y0;\r\n\r\n  return this;\r\n }  \r\n\r\n setModelMatrix(position, scale, rotation, origin) {\r\n    this.a[0] = rotation.x * scale.x; // a\r\n    this.a[1] = rotation.y * scale.x; // b\r\n    this.a[3] = -rotation.y * scale.y; // c\r\n    this.a[4] =  rotation.x * scale.y; // d\r\n    this.a[6] = position.x; // x\r\n    this.a[7] = position.y; // y\r\n\r\n    if (origin !== undefined) {\r\n      this.a[6] -= origin.x * this.a[0] + origin.y * this.a[3];\r\n      this.a[7] -= origin.y * this.a[1] + origin.y * this.a[4];\r\n    }\r\n\r\n    return this;\r\n    /*\r\n    a  =  transform._cosSin.x * transform.scale.x;\r\n    b  = transform._cosSin.y * transform.scale.x;\r\n    c  = -transform._cosSin.y * transform.scale.y;\r\n    d  =  transform._cosSin.x * transform.scale.y;\r\n    x =  transform.position.x;\r\n    y =  transform.position.y;\r\n\r\n    x -= transform.origin.x * a + transform.origin.y * c;\r\n    y -= transform.origin.y * b + transform.origin.y * d;\r\n    */\r\n\r\n    \r\n }\r\n\r\n\r\n multiply(other) {\r\n\r\n    // faster way\r\n    let a00 = this.a[0]; // a - 0\r\n    let a01 = this.a[1]; // b - 1\r\n    let a10 = this.a[3]; // c - 3\r\n    let a11 = this.a[4]; // d - 4\r\n    let a20 = this.a[6]; // x - 6\r\n    let a21 = this.a[7]; // y - 7\r\n\r\n    this.a[0] = other.a[0] * a00 + other.a[1] * a10; // a1 * a0 + b1 * c0;\r\n    this.a[1] = other.a[0] * a01 + other.a[1] * a11; // a1 * b0 + b1 * d0;\r\n\r\n    this.a[3] = other.a[3] * a00 + other.a[4] * a10; // c1 * a0 + d1 * c0;\r\n    this.a[4] = other.a[3] * a01 + other.a[4] * a11; // c1 * b0 + d1 * d0;\r\n\r\n    this.a[6] = other.a[6] * a00 + other.a[7] * a10 + a20; // x1 * a0 + y1 * c0 + x0;\r\n    this.a[7] = other.a[6] * a01 + other.a[7] * a11 + a21; // x1 * b0 + y1 * d0 + y0;\r\n\r\n    return this;\r\n }\r\n\r\n transpose() {\r\n  return this.setAll(\r\n    mat.a[0], mat.a[3], mat.a[6],\r\n    mat.a[1], mat.a[4], mat.a[7],\r\n    mat.a[2], mat.a[5], mat.a[8],\r\n  );\r\n }\r\n\r\n toString() {\r\n  let str = \"\";\r\n   for(let y = 0; y < 3; y++) {\r\n      for(let x = 0; x < 3; x++) {\r\n        let val = this.at(x, y); \r\n        //str += val.toString() + \" \";\r\n        //console.log(\"---- \" + (x + y * 3).toString());\r\n        str += val + \" \";\r\n      }\r\n      str += \"\\n\"\r\n   }\r\n\r\n   return str;\r\n    \r\n }\r\n \r\n \r\n static identity() { return new Matrix(1); }\r\n\r\n static zero() { return new Matrix(0); }\r\n\r\n static transpose(mat) {\r\n  let copy = Matrix.zero;\r\n  return copy.setAll(\r\n    mat.a[0], mat.a[3], mat.a[6],\r\n    mat.a[1], mat.a[4], mat.a[7],\r\n    mat.a[2], mat.a[5], mat.a[8],\r\n  );\r\n\r\n }\r\n\r\n static multiply(a, b) {\r\n    var mat = Matrix.zero(); // zeroes\r\n    let val;\r\n\r\n    for (let i = 0; i < 3; ++i)\r\n    {\r\n      for (let j = 0; j < 3; ++j)\r\n      {\r\n        for (let k = 0; k < 3; ++k)\r\n        {\r\n          val = mat.at(i, k);\r\n          val += a.at(i, j) * b.at(j, k);\r\n          mat.set(i, k, val);\r\n        }\r\n      }\r\n    }\r\n\r\n    return mat;\r\n }\r\n\r\n}\r\n\r\nmodule.exports = Matrix;","\r\n/**\r\n* Simple class for rectangle. Usage for collision.\r\n* @class Rect\r\n* @constructor\r\n*/\r\nexport default class Rect {\r\n  \r\n  constructor(x,y,width,height) {\r\n    x = x || 0;\r\n    y = y || 0;\r\n    width = width || 0;\r\n    height = height || 0;\r\n\r\n    this.x = x;\r\n    this.y = y;\r\n    this.width = width;\r\n    this.height = height;\r\n  }\r\n\r\n  intersects(rect) {\r\n      return Rect.intersects(this, rect);\r\n  }\r\n\r\n  contains(x,y) {\r\n    return Rect.contains(this,x,y);\r\n  }\r\n\r\n  set(x,y,width,height) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.width = width;\r\n    this.height = height;\r\n  }\r\n\r\n  static intersects(rect1, rect2) {\r\n\r\n    if (rect1.width <= 0 || rect1.height <= 0 || rect2.width <= 0 || rect2.height <= 0)\r\n      return false;\r\n  \r\n    return    !(rect1.x > rect2.x + rect2.width ||\r\n               rect1.x + rect1.width < rect2.x ||\r\n               rect1.y > rect2.y + rect2.height ||\r\n               rect1.y + rect1.height < rect2.y);\r\n  }\r\n\r\n  static contains(rect, x, y) {\r\n  \r\n    if (rect.width <= 0 && rect.height <= 0 )\r\n      return false;\r\n  \r\n    return (x > rect.x &&\r\n            x < rect.x + rect.width &&\r\n            y >= rect.y &&\r\n            y < rect.y + rect.height);\r\n  \r\n  }\r\n  \r\n  static intersectionArea(rect1,rect2) {\r\n  \r\n      var out = new scintilla.Rect();\r\n  \r\n      if (scintilla.Rect.intersects(rect1,rect2)) {\r\n  \r\n         out.y = Math.max(a.y, b.y);\r\n         out.x = Math.max(a.x, b.x);\r\n         out.width = Math.min(a.x + a.width, b.x + b.width) - out.x;\r\n         out.height = Math.min(a.y + a.height, b.y + b.height) - out.y;\r\n  \r\n      }\r\n  \r\n      return out;\r\n  \r\n  }\r\n  \r\n  get centerPoint() {\r\n    var vec2 = {};\r\n    vec.x = this.x + this.width / 2;\r\n    vec.y = this.y + this.height / 2;\r\n    return vec2;\r\n  }\r\n}\r\n\r\n\r\n\r\n","\r\n\r\nimport MathUtils from './mathutils'\r\n\r\n/**\r\n* Class for points and vectors.\r\n* @class Vector\r\n* @constructor\r\n*/\r\nexport default class Vector {\r\n  \r\n  constructor(x,y) {\r\n\r\n    this._x = x || 0;\r\n    this._y = y || 0;\r\n  }\r\n\r\n  set x(value) {\r\n    this._x = value;\r\n    return this._x;\r\n  }\r\n  get x() {return this._x;}\r\n  set y(value) {\r\n    this._y = value;\r\n    return this._y;\r\n  }\r\n  get y() {return this._y;}\r\n\r\n  set(x,y) {\r\n\r\n    this._x = x;\r\n    this._y = y || x\r\n\r\n  }\r\n\r\n  move(x,y) {\r\n\r\n    this._x += x;\r\n    this._y += y;\r\n\r\n  }\r\n\r\n  scale(x, y) {\r\n\r\n    this._x *= x;\r\n    this._y *= y || x;\r\n    return this;\r\n\r\n  }\r\n\r\n  rotate(radians) {\r\n\r\n    let x = this._x;\r\n    let y = this._y;\r\n    this._x = x * Math.cos(radians) - y * Math.sin(radians);\r\n    this._y = x * Math.sin(radians) + y * Math.cos(radians);\r\n    return this;\r\n\r\n  }\r\n\r\n  rotateAround(radians, other) {\r\n\r\n    /*var x = this._x;\r\n    var y = this._y;*/\r\n    let dx = this._x-other.x;\r\n    let dy = this._y-other.y;\r\n\r\n    let c = Math.cos(radians);\r\n    let s = Math.sin(radians);\r\n\r\n    /*this._x = c * (x-other.x) - s * (y-other.y) + other.x;\r\n    this._y = s * (x-other.x) + c * (y-other.y) + other.y;*/\r\n\r\n\r\n    this._x =  other.x + (c * dx - s * dy);\r\n    this._y =  other.y + (s * dx + c * dy);\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  copy(otherVector) {\r\n\r\n    this._x = otherVector.x;\r\n    this._y = otherVector.y;\r\n    return this;\r\n\r\n  }\r\n\r\n  normalize() {\r\n\r\n    let mag = this.length();\r\n    if (mag > 0) {\r\n      this._x = this._x / mag;\r\n      this._y = this._y / mag;\r\n    }\r\n    return this;\r\n\r\n  }\r\n\r\n  reverse() {\r\n    this._x = -this._x;\r\n    this._y = -this._y;\r\n    return this;\r\n  }\r\n\r\n  add(other) {\r\n    this._x += other.x;\r\n    this._y += other.y;\r\n    return this;\r\n  }\r\n\r\n  sub(other) {\r\n    this._x -= other.x;\r\n    this._y -= other.y;\r\n    return this;\r\n  }\r\n\r\n  perp() {\r\n\r\n    let x = this._x;\r\n    this._x = this._y;\r\n    this._y = -x;\r\n    return this;\r\n  }\r\n\r\n  dot(other) {\r\n    return Vector.dot(this,other);\r\n  }\r\n\r\n  project(other) {\r\n    return Vector.project(this,other);\r\n  }\r\n\r\n  clone() {\r\n    return new Vector(this._x,this._y);\r\n  }\r\n\r\n  length() {\r\n    return Math.sqrt(this.squaredLenght());\r\n  }\r\n\r\n  squaredLenght() {\r\n    return Vector.dot(this,this);\r\n  }\r\n\r\n  static scalar(a, b) {\r\n    return a.x * b.y - a.y * b.x;\r\n  }\r\n\r\n  static distance(a, b) {\r\n    return MathUtils.distance(a.x,a.y,b.x,b.y);\r\n  }\r\n\r\n  static angleBetween(a, b) {\r\n    return MathUtils.angleBetween(a.x,a.y,b.x,b.y);\r\n  }\r\n\r\n  static dot(a, b) {\r\n    return (a.x * b.x) + (a.y * b.y);\r\n  }\r\n\r\n  static project(a,b) {\r\n    let dp = Vector.dot(a,b);\r\n    var proj = new Vector(\r\n      ( dp / (b.x*b.x + b.y*b.y) ) * b.x,\r\n      ( dp / (b.x*b.x + b.y*b.y) ) * b.y\r\n    );\r\n    return proj;\r\n  };\r\n\r\n  // project for unit vector\r\n  static projectNormal(a,b) {\r\n    let dp = Vector.dot(a,b);\r\n    let proj = new Vector(   dp / b.x,   dp / b.y );\r\n    return proj;\r\n  };\r\n\r\n  static reflect(vec,axis) {\r\n\r\n    let r = Vector.project(vec,axis);\r\n    r.scale(2);\r\n    r.sub(vec);\r\n    return r;\r\n\r\n  };\r\n\r\n  static reflectNormal(vec,axis) {\r\n\r\n    let r = Vector.projectNormal(vec,axis);\r\n    r.scale(2);\r\n    r.sub(vec);\r\n    return r;\r\n\r\n  };\r\n\r\n\r\n  static lerp(a, b, t) {\r\n    let vec = new Vector(\r\n      MathUtils.lerp(a.x,b.x,t),\r\n      MathUtils.lerp(a.y,b.y,t)\r\n    );\r\n    return vec;\r\n  }\r\n\r\n  get magnitude() {return Math.sqrt((this._x * this._x) + (this._y * this._y));}\r\n  get normal() {\r\n    let mag = this.magnitude;\r\n    let vec = new tobiJS.Vector(this._x / mag,this._y / mag);\r\n    return vec;\r\n  }\r\n\r\n}\r\n\r\nmodule.exports = Vector;","\r\nimport Vector from '../../math/vector'\r\nimport Matrix from '../../math/matrix'\r\nimport BoundingBox from '../../math/boundingbox'\r\n//Vector = Math.Vector;\r\n//Matrix = Math.Matrix;\r\n//BoundingBox = Math.BoundingBox;\r\n\r\nexport default class Transform {\r\n\r\n// private:\r\n//var _cosSin = new scintilla.Vector(0,0);\r\n//var _oldRotation = -2;\r\n\r\n  // public:\r\n  constructor() {\r\n\r\n    //this.parent = null;\r\n\r\n    this.rotation = 0;\r\n\r\n    this.position = new Vector(0,0);\r\n    this.scale = new Vector(1,1);\r\n    this.angle = 0;\r\n\r\n    this.matrix = new Matrix(1);\r\n    this.worldPosition = new Vector(0,0);\r\n    this.worldScale =  new Vector(1,1);\r\n    this.worldRotation = 0;\r\n\r\n\r\n    this.origin = new Vector(0,0);\r\n    this.bounds = new BoundingBox(0,0,1,1); // the full bounds of the node - defined by render\r\n    this.globalBounds = new BoundingBox(0,0,1,1); // defined by render\r\n\r\n    this._isDirty = true;\r\n    this._cosSin = {x:0,y:0};\r\n\r\n  }\r\n\r\n    destroy() {\r\n\r\n      delete this.position;\r\n      delete this.scale;\r\n      delete this.matrix;\r\n      delete this.worldPosition;\r\n      delete this.worldScale;\r\n      delete this.origin;\r\n      delete this.bounds;\r\n      delete this.globalBounds;\r\n      delete this._cosSin;\r\n\r\n    }\r\n  }\r\n\r\n","import Renderable from \"../renderables/renderable\";\r\n\r\n\r\nfunction UpdateModules(modulesManager, game)\r\n{\r\n    let size = modulesManager._pendingModules.size;\r\n\r\n    if (size > 0)\r\n    {\r\n        // add pending modules\r\n        modulesManager._pendingModules.each(mod => {\r\n\r\n            mod.init(modulesManager.entity, game);\r\n\r\n            modulesManager.attached.set(mod.type, mod);\r\n\r\n            // RENDERABLES\r\n            if (mod instanceof Renderable)\r\n            {\r\n                game.system.render.layer.renderLayers.at(0).add(mod);\r\n            }\r\n        });\r\n\r\n        modulesManager._pendingModules.clear();\r\n    }\r\n}\r\n\r\nexport default UpdateModules;","\r\nimport MathUtils from '../../math/mathutils'\r\nimport Matrix from '../../math/matrix'\r\n\r\n/*\r\n\r\n* | a | b | x |\r\n* | c | d | y |\r\n* | 0 | 0 | 1 |\r\n\r\n* | 0 | 3 | 6 | * | a | d | x |\r\n* | 1 | 4 | 7 | * | b | e | y |\r\n* | 2 | 5 | 8 | * | c | f | 1 |\r\n\r\n*/\r\n\r\nfunction UpdateTransform(transform, parentMatrix) {\r\n\r\n    if (parentMatrix === undefined) parentMatrix = null;\r\n\r\n    if (!transform._isDirty)\r\n        return;\r\n\r\n\r\n    let a, b, c, d, x, y;\r\n    let wt = transform.matrix;\r\n    let pt = parentMatrix || Matrix.identity();\r\n\r\n    transform.rotation = transform.angle * MathUtils.degToRad;\r\n\r\n      //if (transform.rotation % MathUtils.TAU)\r\n      {\r\n\r\n        if (transform.rotation !== transform._oldRotation)\r\n        {\r\n            transform._oldRotation = transform.rotation;\r\n            transform._cosSin.y = Math.sin(transform.rotation);\r\n            transform._cosSin.x = Math.cos(transform.rotation);\r\n        }\r\n\r\n\r\n        console.clear();\r\n        wt.setModelMatrix(\r\n          transform.position, \r\n          transform.scale, \r\n          transform._cosSin, \r\n          transform.origin)\r\n        .multiply(pt);\r\n\r\n        console.log(wt.toString());\r\n        // concat the parent matrix with the objects transform.\r\n        /*wt.a[0]  = a  * pt.a[0] + b  * pt.a[1]; // a = a * a + b * c\r\n        wt.a[3]  = a  * pt.a[3] + b  * pt.a[4]; // b = a * b + b * d\r\n        wt.a[1]  = c  * pt.a[0] + d  * pt.a[1]; // c = c * a + d * c\r\n        wt.a[4]  = c  * pt.b + d  * pt.d; // d\r\n        wt.a[6] = x * pt.a + y * pt.c + pt.x; // x\r\n        wt.a[7] = x * pt.b + y * pt.d + pt.y; // y*/\r\n\r\n\r\n      //} else {\r\n\r\n        /*a  = transform.scale.x;\r\n        d  = transform.scale.y;\r\n        x =  transform.position.x;\r\n        y =  transform.position.y;\r\n        x -= transform.origin.x * a;\r\n        y -= transform.origin.y * d;\r\n\r\n        wt.a  = a  * pt.a;\r\n        wt.b  = a  * pt.b;\r\n        wt.c  = d  * pt.c;\r\n        wt.d  = d  * pt.d;\r\n        wt.x = x * pt.a + y * pt.c + pt.x;\r\n        wt.y = x * pt.b + y * pt.d + pt.y;*/\r\n\r\n\r\n      }\r\n\r\n      //transform.worldPosition.set(wt.x ,wt.y);\r\n      //transform.worldScale.set(Math.sqrt(wt.a * wt.a + wt.b * wt.b), Math.sqrt(wt.c * wt.c + wt.d * wt.d));\r\n      //transform.worldRotation = Math.atan2(-wt.c, wt.d);\r\n    \r\n}\r\n\r\nexport default UpdateTransform;","\r\nmodule.exports = {\r\n    Module : require('./module'),\r\n    ModuleProvider : require('./moduleProvider'),\r\n    ModuleAttacher : require('./moduleAttacher'),\r\n\r\n    Transform : require('./core/transform'),\r\n    Renderables : require('./renderables')\r\n}","\r\nexport default class Module\r\n{\r\n    constructor(name, moduleManager)\r\n    {\r\n        this._type = name || \"none\";\r\n        this._enabled = true;\r\n        this.entity = null;\r\n        this.moduleManager = moduleManager || undefined;\r\n\r\n        if (moduleManager !== undefined)\r\n        {\r\n            this.entity = moduleManager.entity;\r\n        }\r\n        //this.game = moduleManager.game || null;\r\n    }\r\n\r\n    init(instace, game) {\r\n\r\n        this.entity = instace;\r\n        //this.game = game;\r\n        this.moduleManager = instace.modules;\r\n\r\n    }\r\n\r\n    get type() {return this._type;}\r\n    get enabled() {return this._enabled;}\r\n    set enabled(value) {\r\n        value = !!value;\r\n\r\n        if (value !== this._enabled)\r\n        {\r\n            this._enabled = value;\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = Module;","import ModuleProvider from \"./moduleProvider\";\r\n\r\n\r\nexport default class ModuleAttacher\r\n{\r\n    constructor(moduleManager) {\r\n        this.moduleManager = moduleManager;\r\n    }\r\n\r\n    sprite(tag) {\r\n        return ModuleProvider.attach(this.moduleManager, 'sprite', tag);\r\n    }\r\n}","\r\nimport Map from '../structures/map'\r\nimport List from '../structures/list'\r\nimport ModuleAttacher from './moduleAttacher'\r\n\r\n\r\nexport default class ModuleManager\r\n{\r\n    constructor(entity)\r\n    {\r\n        this.entity = entity || null;\r\n        this.attached = new Map();\r\n        this._pendingModules = new List();\r\n        this.attach = new ModuleAttacher(this);\r\n    }\r\n\r\n    detach(moduleName, index)\r\n    {\r\n        \r\n    }\r\n\r\n\r\n\r\n} ","\r\n\r\nimport Map from '../structures/map'\r\n\r\n\r\nclass ModuleProviderManager\r\n{\r\n    constructor()\r\n    {\r\n        this.proxyModules = new Map();\r\n    }\r\n\r\n    attach(manager, moduleName, args)\r\n    {\r\n        let modules = manager.attached;\r\n\r\n        if (modules.has(moduleName))\r\n            throw new Error('ModuleManager.attach: Could not attach module ' + moduleName + '. Already exists');\r\n\r\n        if (!this.proxyModules.has(moduleName))\r\n            throw new Error('ModuleManager.attach: Module type ' + moduleName + ' don\\'t exists.');\r\n\r\n        var mod = this.proxyModules.get(moduleName)(manager, args);\r\n        manager._pendingModules.push(mod);\r\n        return mod;\r\n    }\r\n\r\n    register(moduleName, func)\r\n    {\r\n        if (!ModuleProvider.proxyModules.has(moduleName))\r\n        ModuleProvider.proxyModules.set(moduleName, func); // { type: moduleType, func: func }\r\n        \r\n    }    \r\n}\r\n\r\nvar ModuleProvider = new ModuleProviderManager();\r\n\r\nexport default ModuleProvider;","\r\n\r\nfunction DrawImage(context, source, transform, frame)\r\n{\r\n    \r\n\r\n    if (context === undefined) return false;\r\n\r\n    if (source === undefined || source == null) return false;\r\n\r\n   \r\n\r\n    let resolution = 1;\r\n    let matrix = transform.matrix;\r\n    let origin = transform.origin;\r\n    \r\n    // destination\r\n    let dx = origin.x * -frame.width / resolution;\r\n    let dy = origin.y * -frame.height / resolution;\r\n\r\n  \r\n\r\n    context.setTransform(\r\n        matrix.a[0], matrix.a[1], // 2\r\n        matrix.a[3], matrix.a[4], // 5\r\n        matrix.a[6] * resolution,\r\n        matrix.a[7] * resolution);\r\n    \r\n    //context.globalAlpha = this.alpha;\r\n    \r\n    context.drawImage(\r\n            source, // image\r\n            frame.x, // sx - pos crop x\r\n            frame.y, // sy - pos crop y\r\n            frame.width, // sWidth - crop width\r\n            frame.height, // sHeight - crop height\r\n            dx, // destination x\r\n            dy, // destination y\r\n            frame.width / resolution,\r\n            frame.height / resolution\r\n            );\r\n      \r\n        return true;\r\n        \r\n}\r\n\r\n\r\nexport default DrawImage;","\r\nmodule.exports = {\r\n    Renderable : require('./renderable'),\r\n    Sprite : require('./sprite'),\r\n    \r\n}","\r\nimport BoundingBox from '../../math/boundingbox';\r\n//import { EntityType } from '../entitytype';\r\nimport Module from '../module';\r\n\r\nexport default class Renderable extends Module\r\n{\r\n    constructor(moduleManager)\r\n    {\r\n        super('render', moduleManager);\r\n\r\n        //this.moduleName = \"Renderable\";\r\n        this._layerID = 0;\r\n        this._depth = 0;\r\n        this._visible = true;\r\n        this._alpha = 1;\r\n        this._depthDirty = true; \r\n        this.bounds = new BoundingBox();\r\n        this.source = null;\r\n\r\n        \r\n        //this.type = EntityType.Renderable;\r\n    }\r\n\r\n    get depth() { return this._depthSorting; }\r\n    get visible() { return this._visible; }\r\n    get layerName() { }\r\n    get layer() { return this._layerID; }\r\n    get alpha() { return this._alpha; }\r\n    set depth(value) {\r\n        if (value != this._depthSorting)\r\n        {\r\n            this._depthSorting = value;\r\n            this._depthDirty = true;\r\n        }\r\n        return this;\r\n    }\r\n    set visible(value) {\r\n        this._visible = value;\r\n        return this;\r\n    }   \r\n    set layer(value) {\r\n        if (this.game != null)\r\n        {\r\n            if (value === 'number')\r\n            {\r\n                //this.game.render.get\r\n            }\r\n        }\r\n    }   \r\n\r\n    set alpha(value) {\r\n        this._alpha = alpha;\r\n        return this;\r\n    }\r\n\r\n    setSource(source)\r\n    {\r\n        if (source === undefined) return;\r\n\r\n        if (this.source != source)\r\n            this.source = source;\r\n    }\r\n\r\n    render(context, matrix)\r\n    {\r\n        if (!this._visible)\r\n            return;\r\n    }\r\n\r\n}","import Renderable from \"./renderable\";\r\nimport Rect from \"../../math/rect\";\r\nimport DrawImage from \"./drawImage\";\r\nimport ModuleProvider from \"../moduleProvider\";\r\n\r\n\r\n\r\nexport default class Sprite extends Renderable {\r\n\r\n    constructor(moduleManager)\r\n    {\r\n        super(moduleManager);\r\n\r\n        this._type = \"sprite\";\r\n        this.frame = new Rect();\r\n    }\r\n\r\n    setFrame(x, y, width, height)\r\n    {\r\n        this.frame.set(x,y,width,height);\r\n    }\r\n\r\n    setFrameRect(rect)\r\n    {\r\n        this.frame.set(x,y,width,height);\r\n    }\r\n\r\n    setSprite(tag) {\r\n\r\n        if (this.entity != null || this.entity !== undefined) {\r\n            var sprite = this.entity.game.system.cache.getAsset('images',tag);\r\n           \r\n            if (sprite != null) {\r\n                this.setSource(sprite.data, true);\r\n            }\r\n        } else {\r\n            throw new Error(\"Sprite.setSprite: Can not set Sprite. The entity is not in the game\");\r\n        }\r\n        \r\n    }\r\n\r\n    setSource(image, changeFrame) {\r\n\r\n        if (changeFrame === undefined) changeFrame = false;\r\n      \r\n        if (this.source != image)\r\n          this.source = image;\r\n      \r\n        if (changeFrame)\r\n            this.setFrame(0,0,this.source.width,this.source.height);\r\n      \r\n      \r\n    }\r\n\r\n    render(context)\r\n    {\r\n        if (!this._visible)\r\n            return false;\r\n\r\n\r\n\r\n        return DrawImage(context, this.source, this.entity.transform, this.frame);\r\n    }\r\n}\r\n\r\nModuleProvider.register('sprite', function(moduleManager, tag) {\r\n\r\n    var spr = new Sprite(moduleManager);\r\n\r\n    if (tag !== undefined)\r\n    {   \r\n        spr.setSprite(tag)\r\n    } \r\n\r\n\r\n    return spr;\r\n\r\n});","\r\nexport default class Debug {\r\n  \r\n  constructor(game) {\r\n\r\n    this.game = game;\r\n    this.draw = game.system.draw;\r\n    this.context = game.system.render.context;\r\n    this.x = 8;\r\n    this.y = 12;\r\n    this.lineHeight = 14;\r\n    this.column = 100;\r\n    this.font =\"10px Verdana\";\r\n    this.textColor = 'white';\r\n    this.bgcolor = 'black';\r\n    this.textShadow = 'black';\r\n\r\n  }\r\n\r\n  test() {\r\n\r\n    this.context.setTransform(1, 0, 0, 1, 0, 0);\r\n    this.context.strokeStyle = this.bgcolor;\r\n    this.context.font = this.font;\r\n    this.draw.alpha(0.5);\r\n    this.draw.rectangle(0,0,this.game.width,(14 * 4)+ 16,this.bgcolor);\r\n    this.draw.alpha(1);\r\n    this.drawLine(\"FPS: \" + Math.round(this.game.time.fps) + \" / 60\");\r\n    //this.drawLine(\"Instances in view: \" + this.game.camera.instancesInView);\r\n    this.drawLine(\"Instances \" + this.game.system.entityList.length);\r\n    this.drawLine(\"Draw Calls \" + this.game.system.render.drawCalls);/*this.game.physics.length);*/\r\n    this.x += this.game.width / 2;\r\n    this.y = 12+8;\r\n    //this.drawLine(\"Sounds count \" + this.game.sound.length);\r\n    this.x = 8;\r\n    this.y = 12+8;\r\n\r\n  }\r\n\r\n  drawLine(textLine) {\r\n\r\n    var xx = this.x;\r\n\r\n            this.context.fillStyle = this.textShadow;\r\n            this.context.fillText(textLine, xx + 1, this.y + 1);\r\n            this.context.fillStyle = this.textColor;\r\n\r\n        this.context.fillText(textLine, xx, this.y);\r\n\r\n\r\n    this.y += this.lineHeight;\r\n\r\n  }\r\n\r\n\r\n\r\n}\r\n","\r\nimport SAT from './sat'\r\nimport SATResponse from './satresponse'\r\n\r\nexport default class Physics {\r\n\r\n  \r\n\r\n  constructor(game) {\r\n\r\n    this.game = null;\r\n    this.sat = null;\r\n    this.response = null;\r\n\r\n   \r\n    this.game = game;\r\n    this.colliadables = [];\r\n\r\n  }\r\n\r\n  init() {\r\n\r\n    this.sat = new SAT();\r\n    this.response = new SATResponse();\r\n\r\n  }\r\n\r\n  getColliadables() {\r\n    return this.colliadables;\r\n  }\r\n\r\n  addColliderObj(obj) {\r\n    this.colliadables.push(obj);\r\n  }\r\n\r\n  removeColliderObj(obj) {\r\n\r\n    var i = this.colliadables.indexOf(obj);\r\n\r\n    if(i != -1) {\r\n      this.colliadables.splice(i, 1);\r\n    }\r\n\r\n  }\r\n\r\n  clear() {\r\n\r\n    this.colliadables = [];\r\n    this.colliadables.length = 0;\r\n\r\n  }\r\n\r\n  update(time) {\r\n\r\n    let size = this.colliadables.length;\r\n\r\n    // CHECK COLLISION\r\n    if (size < 2) // at least we must have 2 objects\r\n      return;\r\n\r\n    //var collision = 0;\r\n\r\n    for (var i = 0; i < size; i++) {\r\n\r\n        var objA = this.colliadables[i];\r\n        var shapeA = objA.shape;\r\n\r\n        if (objA._gameObject._selfDestroy || !objA._gameObject.active)\r\n          continue;\r\n\r\n        var jit = i + 1;\r\n\r\n        if (jit >= size)\r\n          break;\r\n\r\n        for (var j = jit; j < size; j++) {\r\n\r\n          var objB = this.colliadables[j];\r\n          var shapeB = objB.shape;\r\n\r\n          if (objB._gameObject._selfDestroy || !objB._gameObject.active)\r\n            continue;\r\n\r\n          // AABB check of the shapes\r\n        if (objB.bounds.box.intersects(objA.bounds.box)) {\r\n\r\n          // check SAT\r\n          if (this.sat[\"test\" + shapeA.getType() + shapeB.getType()].call(this,\r\n            objA,objB,this.response.clear()) === true) {\r\n\r\n\r\n              if (objA._gameObject['onCollision'])\r\n              if (objA._gameObject.onCollision(objB._gameObject,this.response) !== false) {\r\n\r\n\r\n              }\r\n\r\n              if (objB._gameObject['onCollision'])\r\n              if (objB._gameObject.onCollision(objA._gameObject,this.response) !== false) {\r\n\r\n\r\n              }\r\n\r\n          } else\r\n            continue;\r\n          } else\r\n            continue;\r\n        }\r\n      }\r\n  }\r\n\r\n  get length() {return this.colliadables.length;}\r\n\r\n}\r\n\r\n","\r\nimport Vector from '../math/vector' \r\n\r\nexport default class SAT {\r\n\r\n  constructor()\r\n  {\r\n\r\n    this.VECTORS = [];\r\n    for (var v = 0; v < 10; v++) { \r\n      VECTORS.push(new Vector()); \r\n    }\r\n\r\n    this.ARRAYS = [];\r\n    for (var a = 0; a < 5; a++) { \r\n      ARRAYS.push([]); \r\n    }\r\n  }\r\n\r\n  flattenPointsOn(points, normal, result) {\r\n          var min = Number.MAX_VALUE;\r\n          var max = -Number.MAX_VALUE;\r\n          var len = points.length;\r\n          for (var i = 0; i < len; i++) {\r\n              // The magnitude of the projection of the point onto the normal\r\n              var dot = points[i].dot(normal);\r\n              if (dot < min) { min = dot; }\r\n              if (dot > max) { max = dot; }\r\n          }\r\n          result[0] = min;\r\n          result[1] = max;\r\n  };\r\n\r\n  isSeparatingAxis(posA, posB, pointsA, pointsB, axis, response) {\r\n\r\n    var rangeA = ARRAYS.pop();\r\n    var rangeB = ARRAYS.pop();\r\n\r\n    // magnitude between the two polygons\r\n    var offsetV = VECTORS.pop().copy(posB).sub(posA);\r\n    var projectedOffset = offsetV.dot(axis);\r\n\r\n    // Project the polygons onto the axis.\r\n    flattenPointsOn(pointsA, axis, rangeA);\r\n    flattenPointsOn(pointsB, axis, rangeB);\r\n\r\n    // Move B's range to its position relative to A.\r\n    rangeB[0] += projectedOffset;\r\n    rangeB[1] += projectedOffset;\r\n\r\n    // Check if there is a gap. If there is, this is a separating axis and we can stop\r\n    if (rangeA[0] > rangeB[1] || rangeB[0] > rangeA[1]) {\r\n        VECTORS.push(offsetV);\r\n        ARRAYS.push(rangeA);\r\n        ARRAYS.push(rangeB);\r\n        return true;\r\n    }\r\n\r\n    if (response) {\r\n        var overlap = 0;\r\n        // A starts further left than B\r\n        if (rangeA[0] < rangeB[0]) {\r\n\r\n          response.aInB = false;\r\n\r\n          // A ends before B does. We have to pull A out of B\r\n          if (rangeA[1] < rangeB[1]) {\r\n\r\n            overlap = rangeA[1] - rangeB[0];\r\n            response.bInA = false;\r\n\r\n          // B is fully inside A.  Pick the shortest way out.\r\n          } else {\r\n\r\n            var option1 = rangeA[1] - rangeB[0];\r\n            var option2 = rangeB[1] - rangeA[0];\r\n            overlap = option1 < option2 ? option1 : -option2;\r\n\r\n          }\r\n        // B starts further left than A\r\n        } else {\r\n\r\n          response.bInA = false;\r\n\r\n          // B ends before A ends. We have to push A out of B\r\n          if (rangeA[1] > rangeB[1]) {\r\n\r\n            overlap = rangeA[0] - rangeB[1];\r\n            response.aInB = false;\r\n\r\n          // A is fully inside B.  Pick the shortest way out.\r\n          } else {\r\n\r\n            var option1 = rangeA[1] - rangeB[0];\r\n            var option2 = rangeB[1] - rangeA[0];\r\n            overlap = option1 < option2 ? option1 : -option2;\r\n\r\n          }\r\n        }\r\n        // If this is the smallest amount of overlap we've seen so far, set it as the minimum overlap.\r\n        var absOverlap = Math.abs(overlap);\r\n\r\n        if (absOverlap < response.overlap) {\r\n\r\n          response.overlap = absOverlap;\r\n          response.overlapN.copy(axis);\r\n\r\n          if (overlap < 0)\r\n            response.overlapN.reverse();\r\n        }\r\n      }\r\n\r\n      VECTORS.push(offsetV);\r\n      ARRAYS.push(rangeA);\r\n      ARRAYS.push(rangeB);\r\n\r\n\r\n\r\n      return false;\r\n\r\n  };\r\n\r\n  testPolygonPolygon(a,b,response) {\r\n\r\n    // collider a\r\n\r\n    var pointsA = a.shape.getPoints();\r\n    var normalsA =  a.shape.getNormals();\r\n    var normalsALen = normalsA.length;\r\n\r\n    // collider b\r\n\r\n    var pointsB = b.shape.getPoints();\r\n    var normalsB =  b.shape.getNormals();\r\n    var normalsBLen = normalsB.length;\r\n\r\n\r\n    // If any of the edge normals of A is a separating axis, no intersection.\r\n    while (normalsALen--) {\r\n        if (isSeparatingAxis(a.position, b.position, pointsA, pointsB, normalsA[normalsALen],response)) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n\r\n\r\n    // If any of the edge normals of B is a separating axis, no intersection.\r\n    while (normalsBLen--) {\r\n        if (isSeparatingAxis(a.position, b.position, pointsA, pointsB, normalsB[normalsBLen], response)) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n\r\n\r\n    // Since none of the edge normals of A or B are a separating axis, there is an intersection\r\n    // and we've already calculated the smallest overlap (in isSeparatingAxis).  Calculate the\r\n    // final overlap vector.\r\n      if (response) {\r\n          response.a = a;\r\n          response.b = b;\r\n          response.overlapV.copy(response.overlapN).scale(response.overlap);\r\n      }\r\n    return true;\r\n\r\n  };\r\n\r\n}\r\n\r\n\r\n","\r\nexport default class SATResponse {\r\n\r\n    constructor()\r\n    {\r\n        this.a = null;\r\n        this.b = null;\r\n        this.overlapN = new scintilla.Vector();\r\n        this.overlapV = new scintilla.Vector();\r\n        this.aInB = true;\r\n        this.bInA = true;\r\n        this.overlap = Number.MAX_VALUE;\r\n        this.indexShapeA = -1;\r\n        this.indexShapeB = -1;\r\n        this.clear();\r\n    }\r\n\r\n    clear()\r\n    {\r\n        this.aInB = true;\r\n        this.bInA = true;\r\n        this.overlap = Number.MAX_VALUE;\r\n        this.indexShapeA = -1;\r\n        this.indexShapeB = -1;\r\n        return this;\r\n    }\r\n}\r\n","\r\n/**\r\n * Create a Canvas object.\r\n * @class Canvas\r\n */\r\nexport default (\r\n    class Canvas {\r\n\r\n  static create (parent,width, height) {\r\n\r\n  // default definition\r\n  let defaultDef = {\r\n    width: width,\r\n    height: height,\r\n    id: Math.random().toString(36).substr(2, 9),\r\n    class: \"\",\r\n    container: \"body\",\r\n    style: \"padding: 0;margin: auto;display: block;top: 0; bottom: 0;left: 0;right: 0;border:1px solid #d3d3d3;background-color: #f1f1f1;\"\r\n  };\r\n\r\n  //var CO = Object.assign(defaultDef, options);\r\n  let CO = defaultDef;\r\n  let canvas;\r\n\r\n\r\n  canvas = document.createElement('canvas');\r\n  //canvas.parent = parent;\r\n  canvas.setAttribute(\"id\", CO.id);\r\n  canvas.setAttribute(\"width\", CO.width);\r\n  canvas.setAttribute(\"height\", CO.height);\r\n  canvas.setAttribute(\"style\", CO.style);\r\n  //canvas.style.position = 'absolute';\r\n\r\n\r\n  Canvas.appendDOM(canvas,parent);\r\n  //document.body.appendChild(canvas);\r\n  //var context = canvas.getContext(\"2d\");\r\n\r\n\r\n  //tobiJS.Canvas.list.parent = document.body;\r\n\r\n  //console.log(\"Canvas Created!\");\r\n\r\n  return canvas;\r\n}\r\n\r\nstatic appendDOM(canvas,parent) {\r\n\r\n  let appendTo;\r\n  let overflowHidden = true;\r\n  let target = null;\r\n\r\n  //if (overflowHidden === undefined) { overflowHidden = true; }\r\n\r\n    if (parent)\r\n    {\r\n        if (typeof parent === 'string')\r\n        {\r\n            // hopefully an element ID\r\n            target = document.getElementById(parent);\r\n        }\r\n        else if (typeof parent === 'object' && parent.nodeType === 1)\r\n        {\r\n            // quick test for a HTMLelement\r\n            target = parent;\r\n        }\r\n    }\r\n\r\n    // Fallback, covers an invalid ID and a non HTMLelement object\r\n    if (!target)\r\n    {\r\n        target = document.body;\r\n    }\r\n\r\n    /*if (overflowHidden && target.style)\r\n    {\r\n        target.style.overflow = 'hidden';\r\n    }*/\r\n\r\n    target.appendChild(canvas);\r\n\r\n}\r\n\r\n})\r\n","\r\nexport const RENDERING_TYPE = {\r\n    NEAREST : 0,\r\n    LINEAR : 1\r\n}","import GameSystemManager from \"../core/gameSystemManager\";\r\n\r\nexport default class Draw {\r\n  \r\n  constructor(game) {\r\n    this.game = game;\r\n    this.cache = null;\r\n    this.context = null;\r\n  }\r\n\r\n  init()\r\n  {\r\n\r\n    this.cache = this.game.system.cache;\r\n    this.context = this.game.system.render.context;\r\n    return this;\r\n  }\r\n\r\n  font(fontname,size) {\r\n\r\n    this.context.font = size + \"px \" + fontname;\r\n\r\n  }\r\n\r\n  text(text,x,y,color) {\r\n\r\n    if (color === undefined) color = 'black';\r\n\r\n    this.context.fillStyle = color;\r\n    this.context.fillText(text, x, y);\r\n\r\n  }\r\n\r\n  sprite(tag, x, y, anchor) {\r\n\r\n      var img = this.cache.getAsset('images',tag);\r\n\r\n      if (img != null) {\r\n\r\n        if (anchor === undefined) {\r\n          anchor[0] = 0;\r\n          anchor[1] = 0;\r\n        }\r\n\r\n        var ctx = this.context;\r\n\r\n      ctx.save();\r\n\r\n      ctx.translate(x-img.width*anchor[0], y-img.height*anchor[1]);\r\n\r\n    ctx.drawImage(img,\r\n            0,\r\n            0,\r\n            img.width,\r\n            img.height);\r\n\r\n\r\n      ctx.restore();\r\n\r\n    }\r\n\r\n  }\r\n\r\n  spriteTransformed(tag, x, y, xscale, yscale, angle) {\r\n\r\n\r\n  }\r\n\r\n  rectangle(x, y, width, height, color) {\r\n\r\n    this.context.fillStyle=color;\r\n    this.context.fillRect(x,y,width,height);\r\n\r\n  }\r\n\r\n  outlineRectangle(x,y,width,height,color,outlineWidth) {\r\n\r\n    this.context.beginPath();\r\n    this.context.lineWidth=outlineWidth;\r\n    this.context.setLineDash([6]);\r\n    this.context.strokeStyle=color;\r\n    this.context.rect(x,y,width,height);\r\n    this.context.stroke();\r\n\r\n  }\r\n\r\n  alpha(a) {\r\n\r\n    this.context.globalAlpha = a;\r\n\r\n  }\r\n\r\n  color(color) {\r\n\r\n    this.context.fillStyle = color;\r\n\r\n  }\r\n\r\n  boundingbox(bb,color) {\r\n\r\n  if (color === undefined)\r\n    color = 'black';\r\n    this.context.setTransform(1,0,0,1,0,0);\r\n  this.outlineRectangle(bb.min.x,bb.min.y,bb.max.x-bb.min.x,bb.max.y-bb.min.y,color,2);\r\n\r\n  }\r\n\r\n}\r\n\r\nGameSystemManager.register('Draw',Draw,'draw');","\r\nmodule.exports = {\r\n    RenderLayer : require('./renderlayer'),\r\n    RenderLayerManagement : require('./renderlayersmanagement'),\r\n    Render : require('./render'),\r\n    Draw : require('./draw')\r\n}","\r\nimport Map from '../structures/map'\r\nimport RenderLayer from './renderlayer'\r\nimport RenderLayerManagment from './renderlayersmanagement'\r\nimport Canvas from './canvas/canvas'\r\nimport {RENDERING_TYPE} from './define'\r\nimport GameSystemManager from '../core/gameSystemManager';\r\n\r\n\r\nexport default class Render {\r\n    \r\n\r\n    constructor(game) {\r\n        \r\n        this.game = game;\r\n        this.layer = new RenderLayerManagment(this.game);\r\n        this.canvas = Canvas.create(this.game.parent,this.game.width,this.game.height);\r\n        this.context = this.canvas.getContext(\"2d\", { alpha: false });  \r\n        this.imageRendering = (game.config.pixelelated) ? RENDERING_TYPE.NEAREST : RENDERING_TYPE.LINEAR;\r\n\r\n        this._backgroundColor = '#000'       \r\n        this._alpha = 1;\r\n        this._enable = true;\r\n        this.clear = true;\r\n        this.drawCalls = 0;\r\n    }\r\n\r\n    renderBegin()\r\n    {\r\n        \r\n        if (this.clear)\r\n        {\r\n            this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n        }\r\n\r\n        this.context.fillStyle = this._backgroundColor;  \r\n        this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n\r\n        this.drawCalls = 0;\r\n    }\r\n\r\n    renderEnd()\r\n    {\r\n        this.context.globalAlpha = 1;\r\n        this.context.globalCompositeOperation = 'source-over';\r\n    }\r\n\r\n    render(scene)\r\n    {\r\n        if (!this._enable)\r\n            return;\r\n\r\n        this.context.setTransform(1, 0, 0, 1, 0, 0);\r\n\r\n        // alpha\r\n        if (this._alpha !== 1)\r\n        {\r\n            ctx.globalAlpha = 1;\r\n            this._alpha = 1;\r\n        }\r\n\r\n        // blend\r\n        this.context.globalCompositeOperation = 'source-over';\r\n       \r\n        \r\n\r\n        for (let i = 0; i < this.layer.renderLayers.length; i++)\r\n        {\r\n            let layer = this.layer.renderLayers.at(i);\r\n\r\n            if (!layer.enable)\r\n                continue;\r\n\r\n                layer.render(this.context);\r\n            \r\n            this.drawCalls += layer.drawCalls;\r\n        }\r\n\r\n        this.game.scene.render();\r\n\r\n\r\n        if (this.game.debug != null) {\r\n\r\n            this.context.setTransform(1, 0, 0, 1, 0, 0);\r\n            this.game.debug.test();\r\n            //console.log(\"asdasd\");\r\n      \r\n      }\r\n\r\n    }\r\n\r\n    get backgroundColor() {return this._backgroundColor;}\r\n    set backgroundColor(value) {\r\n        this._backgroundColor = value;\r\n    }\r\n    get alpha() {return this._alpha;}\r\n    set alpha(value) {\r\n\r\n        if (this._alpha !== value)\r\n        {\r\n            this.currentContext.globalAlpha = value;\r\n            this._alpha = value;\r\n        }\r\n\r\n        return this._alpha;\r\n    }\r\n}\r\n\r\nGameSystemManager.register('Render', Render, 'render');","import List from \"../structures/list\";\r\n\r\n\r\nexport default class RenderLayer { \r\n    \r\n    constructor(game,layerName) {\r\n\r\n        this._name = layerName;\r\n        this.game = game;       \r\n        this.renderList = new List(true);\r\n        this.__drawCalls = 0;\r\n        this.__enable = true;\r\n        this.__isDirty = false;\r\n    }\r\n\r\n    get drawCalls() {return this.__drawCalls;}\r\n\r\n    // Add renderable components\r\n    add(renderer) {\r\n    \r\n        if (renderer === undefined)\r\n            return;\r\n\r\n        this.renderList.push(renderer);\r\n       // this.renderer.__renderLayer = this;\r\n        this.__isDirty = true;\r\n\r\n    }\r\n\r\n    remove(renderer)\r\n    {\r\n        return this.renderList.remove(renderer);\r\n    }\r\n\r\n    removeAt(index)\r\n    {\r\n        \r\n    }\r\n\r\n    at(index)\r\n    {\r\n        if (index < 0 || index >= this.__renderers.size)\r\n        {\r\n            throw new Error('RenderLayer.at: Renderer at '+ index +' does not exist in the render layer list: \\\"' + name + \"\\\".\");\r\n        }\r\n        return this.renderList.at(index);\r\n\r\n    }\r\n\r\n    render(context)\r\n    {\r\n        this.__drawCalls = 0;\r\n\r\n        if (!this.__enable)\r\n            return;\r\n\r\n        \r\n\r\n        if (this.__isDirty)\r\n        {\r\n            this.renderList.sort(this.sortDepth);\r\n\r\n            this.__isDirty = false;\r\n        }\r\n\r\n        var self = this;\r\n\r\n        this.renderList.each((element) => {\r\n            if (element.render(context))\r\n                self.__drawCalls++;\r\n        });\r\n\r\n    }\r\n\r\n    sortDepth(a, b) { // sort ascending\r\n\r\n        return a._depthSorting - b._depthSorting;\r\n\r\n        /*this.__renderers.sort(\r\n\r\n          function(a, b) {\r\n      \r\n            if (a.depth > b.depth) {\r\n      \r\n              return 1;\r\n      \r\n            } else if (a.depth < b.depth) {\r\n      \r\n              return -1;\r\n      \r\n            } else {\r\n      \r\n              if (a.z > b.z) {\r\n                return 1;\r\n              } else {\r\n                return -1;\r\n              }\r\n      \r\n      \r\n            }\r\n          });*/\r\n\r\n    }\r\n\r\n    get length() {return this.__renderers.length;}\r\n    get name() {return this._name;}\r\n    get enable() {return this.__enable;}\r\n    set enable(value) {\r\n        value = !!value;\r\n    \r\n        if (value !== this._enabled)\r\n        {\r\n            //if (!value)\r\n            //    this.reset();\r\n\r\n            this._enabled = value;\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n","\r\nimport Map from '../structures/map'\r\nimport RenderLayer from './renderlayer'\r\nimport List from '../structures/list';\r\n\r\nexport default class RenderLayersManagement {\r\n\r\n    constructor(game) {\r\n        this.game = game;\r\n        this.renderLayers = new List();\r\n        //this.__renderLayersMap = new Map();\r\n        this.add('default');\r\n    }\r\n\r\n\r\n\r\n    add(name) {\r\n\r\n        if (this.contains(name))\r\n        {\r\n            throw new Error(\"Render.add: There is already a RenderLayer called: \\\"\" +  name + \"\\\".\");\r\n        }\r\n       \r\n        //this.__renderLayersMap.set(name, this.__renderLayers.length);\r\n        this.renderLayers.push(new RenderLayer(this.game, name));\r\n    }\r\n\r\n    remove(name)\r\n    {\r\n        if (typeof name !== 'string')\r\n            throw new Error(\"Render.remove: The value name is not a string.\");\r\n\r\n        if (name === \"default\")\r\n            throw new Error(\"Render.remove: You can not remove the \\\"default\\\" layer.\");\r\n\r\n        if (!this.__renderLayersMap.has(name))\r\n            throw new Error(\"Render.remove: Could not remove layer. There is no layer named \\\"\" + name + \"\\\".\");\r\n\r\n        var index = this.__renderLayersMap.get(name);\r\n\r\n        this.renderLayers.erase(name);\r\n    }\r\n\r\n    contains(layerName)\r\n    {\r\n        if (typeof layerName !== 'string')\r\n            throw new Error(\"Render.contains: The value name is not a string.\");\r\n\r\n        let val = this.renderLayers.each(function(layer) {\r\n           \r\n            if (layer.name == layerName)\r\n            {\r\n                return true;\r\n            }\r\n        });\r\n\r\n        return val || false;\r\n    }\r\n\r\n}","import EntityHierarchy from \"../entities/entityhierarchy\";\r\nimport Camera from \"../entities/camera\";\r\n\r\n\r\nexport default class Scene {\r\n  \r\n  constructor(name) {\r\n\r\n    this.name = name || 'New Scene';\r\n    //this.childs = new EntityHierarchy(\"SceneHierarchy\", this.game);\r\n    /*this.camera = null;\r\n    this.x = 0;\r\n    this.y = 0;\r\n    this.width = 0;\r\n    this.height = 0;\r\n    this.view = 0;*/\r\n\r\n\r\n    /*if (myGame != null) {\r\n      this.width = myGame.width;\r\n      this.height = myGame.height;\r\n    }*/\r\n  }\r\n\r\n\r\n\r\n\r\n  instanceDestroy(gameObject) {\r\n\r\n    if (gameObject['destroy'])\r\n      gameObject.destroy();\r\n\r\n      //console.log(\"deleted \" + gameObject._id)\r\n\r\n    let index = this.instances.indexOf( gameObject);\r\n\r\n    this.instances.splice( index, 1 );\r\n\r\n  }\r\n\r\n  addGameObject(gameObject, clone) {\r\n\r\n    let obj;\r\n    let cl = false;\r\n\r\n    if (arguments.length == 0)\r\n      obj = new scintilla.GameObject();\r\n    else {\r\n\r\n      if (clone === undefined)\r\n        cl = false;\r\n      else\r\n        cl = clone;\r\n\r\n\r\n        if (cl)\r\n          obj = gameObject.clone();\r\n        else\r\n          obj = gameObject;\r\n\r\n    }\r\n\r\n    obj._id = this.instances.length;\r\n    obj._game = this.game;\r\n    this.instances.push(obj);\r\n\r\n    obj.start();\r\n    return obj;\r\n\r\n  }\r\n\r\n  setBounds(x,y,width,height) {\r\n\r\n    this.x = x;\r\n    this.y = y;\r\n    this.width = width;\r\n    this.height = height;\r\n    \r\n  }\r\n\r\n}\r\n\r\n\r\n\r\n","\r\nimport Map from '../structures/map'\r\nimport Scene from './scene'\r\n\r\nexport default class SceneManager {\r\n  \r\n  constructor(game) {\r\n\r\n    this.game = game;\r\n    this.entityUpdateList = null;\r\n    this._scenes = new Map();\r\n\r\n    this.current_scene_name = '';\r\n    this.change_scene = null;\r\n\r\n    this._setup = false;\r\n    this._clearCache = false;\r\n\r\n    // callbacks\r\n    this.current_scene = null;\r\n    this.onStartCallback = null;\r\n    this.onLoadingCallback = null;\r\n    this.onLoadingRenderCallback = null;\r\n    this.onPreloadCallback = null;\r\n    this.onUpdateCallback = null;\r\n    this.onRenderCallback = null;\r\n    this.onDestroyCallback = null;\r\n\r\n  }\r\n\r\n  init()\r\n  {\r\n    this.entityUpdateList = this.game.system.entityList;\r\n  }\r\n\r\n\r\nadd(sceneName,scene) {\r\n\r\n  var newScene;\r\n\r\n  if (scintilla.Scene.prototype.isPrototypeOf(scene)) {\r\n    newScene = scene;\r\n    newScene.game = this.game;\r\n  } else\r\n    newScene = null;\r\n\r\n\r\n  if (newScene != null)\r\n    this._scenes.set(sceneName,newScene);\r\n\r\n}\r\n\r\nnew(sceneName)\r\n{\r\n\r\n  if (this._scenes.has(sceneName))\r\n  {\r\n    throw \"Could not create new Scene. The scene name \\\"\" + name + \"\\\" already exists.\"; \r\n    return null;\r\n  }\r\n  \r\n  var newScene = new Scene(this.game, sceneName);\r\n  this._scenes.set(sceneName,newScene);\r\n\r\n  return newScene;\r\n\r\n}\r\n\r\nset(sceneName, clearCache) {\r\n\r\n  if (clearCache === undefined) { clearCache = false; }\r\n\r\n  this.change_scene = sceneName;\r\n  this._clearCache = clearCache;\r\n\r\n\r\n\r\n}\r\n\r\nrestart(clearCache) {\r\n\r\n  if (clearCache === undefined) { clearCache = false; }\r\n\r\n  this.change_scene = this.current_scene_name;\r\n  this._clearCache = clearCache;\r\n\r\n}\r\n\r\nremove(sceneName) {\r\n\r\n  if (this.current_scene_name === sceneName) {\r\n\r\n    this.current_scene = null;\r\n\r\n    this.onStartCallback = null;\r\n    this.onLoadingCallback = null;\r\n    this.onLoadingRenderCallback = null;\r\n    this.onPreloadCallback = null;\r\n    this.onUpdateCallback = null;\r\n    this.onRenderCallback = null;\r\n    this.onDestroyCallback = null;\r\n\r\n\r\n  }\r\n\r\n  delete this.scenes[sceneName];\r\n\r\n}\r\n\r\nsetupScene(sceneName) {\r\n\r\n\r\n  this.current_scene = this._scenes.get(sceneName);\r\n  this.onStartCallback = this.current_scene['start'] || null;\r\n  this.onLoadingCallback = this.current_scene['loading'] || null;\r\n  this.onLoadingRenderCallback = this.current_scene['loadingRender'] || null;\r\n  this.onPreloadCallback = this.current_scene['preload'] || null;\r\n  this.onUpdateCallback = this.current_scene['update'] || null;\r\n  this.onRenderCallback = this.current_scene['render'] || null;\r\n  this.onDestroyCallback = this.current_scene['destroy'] || null;\r\n\r\n  this.game.system.inject(this.current_scene);\r\n\r\n  this.current_scene_name = sceneName;\r\n\r\n  this.game.time.refresh();\r\n\r\n\r\n  //this.current_scene.camera = this.game.world.camera;\r\n\r\n  //this.game.instance.scene = this.current_scene;\r\n\r\n  this._setup = false;\r\n\r\n}\r\n\r\nclearCurrentScene() {\r\n\r\n  if (this.current_scene_name)\r\n  {\r\n\r\n    this.game.system.unject(this.current_scene);\r\n\r\n    if (this.onDestroyCallback)\r\n    {\r\n        this.onDestroyCallback.call(this.current_scene, this.game);\r\n    }\r\n\r\n    if (this._clearCache)\r\n    {\r\n          this.game.cache.clear();\r\n    }\r\n\r\n    //this.game.world.destroyAllChilds();\r\n\r\n  }\r\n\r\n}\r\n\r\npreUpdate() {\r\n\r\n  if (this.game.systemInited && this.change_scene != null)\r\n  {\r\n\r\n    this.clearCurrentScene();\r\n\r\n    this.setupScene(this.change_scene);\r\n\r\n    if (this.current_scene_name !== this.change_scene)\r\n    {\r\n        return;\r\n    }\r\n    else\r\n    {\r\n        this.change_scene = null;\r\n    }\r\n\r\n    if (this.onPreloadCallback) {\r\n\r\n      this.game.system.load.reset();\r\n      this.onPreloadCallback.call(this.current_scene, this.game);\r\n\r\n      if (this.game.system.load.totalQueuedFiles === 0)\r\n      {\r\n        this.preloadComplete();\r\n\r\n      } else {\r\n\r\n        this.game.system.load.start();\r\n      }\r\n\r\n    } else {\r\n\r\n      this.preloadComplete();\r\n    }\r\n\r\n  }\r\n\r\n  }\r\n\r\n  preloadComplete() {\r\n\r\n    //this.current_scene.quadtree = new tobiJS.Quadtree({x: 0, y: 0, width: 640,height: 480});\r\n\r\n      if (this._setup === false && this.onLoadingCallback)\r\n      {\r\n          this.onLoadingCallback.call(this.current_scene, this.game);\r\n      }\r\n\r\n      if (this._setup === false && this.onStartCallback)\r\n      {\r\n          this._setup  = true;\r\n          this.onStartCallback.call(this.current_scene, this.game);\r\n      }\r\n      else\r\n      {\r\n          this._setup = true;\r\n\r\n      }\r\n  }\r\n\r\n    update() {\r\n\r\n      if (this._setup) {\r\n\r\n        if (this.current_scene != null)\r\n        {\r\n            this.entityUpdateList.update();\r\n\r\n            this.entityUpdateList.lateUpdate();\r\n        }\r\n        /*if (this.onUpdateCallback)\r\n        {\r\n            this.onUpdateCallback.call(this.current_scene, this.game);\r\n        }*/\r\n\r\n\r\n\r\n        //this.current_scene._update();\r\n\r\n      } else {\r\n\r\n        if (this.onLoadingCallback)\r\n        {\r\n            this.onLoadingCallback.call(this.current_scene, this.game);\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n      if (this._setup) {\r\n\r\n\r\n          if (this.onRenderCallback)\r\n          {\r\n              this.onRenderCallback.call(this.current_scene, this.game);\r\n          }\r\n\r\n      } else {\r\n\r\n        if (this.onLoadingRenderCallback)\r\n        {\r\n            this.onLoadingRenderCallback.call(this.current_scene, this.game);\r\n        }\r\n\r\n\r\n      }\r\n\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n","\r\nmodule.exports = {\r\n    Utils : require('./useful'),\r\n    SetData : require('./set'),\r\n    Map : require('./map'),\r\n    List : require('./list'),\r\n}\r\n    ","\r\nimport MergeSort from './useful/mergesort'\r\n\r\nexport default class List\r\n{\r\n    constructor(elements, unique)\r\n    {\r\n        this.unique = unique || true;\r\n        this.childs = [];\r\n\r\n        if (Array.isArray(elements))\r\n        {\r\n            for (var i = 0; i < elements.length; i++)\r\n                this.push(elements[i]);\r\n        }\r\n\r\n    }\r\n\r\n    get size() {return this.childs.length;}\r\n    get length() {return this.childs.length;}\r\n\r\n    get first() {\r\n        if (this.list.length > 0) \r\n            return this.childs[0];\r\n        else\r\n            return null;\r\n        \r\n    }\r\n\r\n    get last() {\r\n          if (this.childs.length > 0) {\r\n            let idx = this.childs.length - 1;\r\n            return this.childs[idx];\r\n          } else\r\n            return null;\r\n    }\r\n\r\n    push(child) {\r\n\r\n        if (this.unique) {\r\n            if (this.indexOf(child) === -1)\r\n                this.childs.push(child);\r\n        } else {\r\n            this.childs.push(child);\r\n        }\r\n\r\n        return child;\r\n    }\r\n\r\n    pushFront(child) {\r\n        if (this.unique) {\r\n            if (this.indexOf(child) === -1)\r\n                this.childs.unshift(child);\r\n        } else {\r\n            this.childs.unshift(child);\r\n        }\r\n        return child;\r\n    }\r\n\r\n    insert(child, index) {\r\n\r\n        if (index === undefined) \r\n            index = 0;\r\n\r\n        if (this.childs.length === 0) \r\n            return this.push(child);\r\n\r\n        if (index >= 0 && index <= this.childs.length) {\r\n        \r\n            if (this.unique) {\r\n                if (this.indexOf(child) === -1) \r\n                    this.childs.splice(index, 0, child);\r\n            } else {\r\n                this.childs.splice(index, 0, child);\r\n            }\r\n            \r\n        }\r\n\r\n        return child;\r\n    \r\n    }\r\n\r\n    indexOf(child) {\r\n        return this.childs.indexOf(child);\r\n    }\r\n\r\n    at(index) {\r\n        return this.childs[index];\r\n    }\r\n\r\n    erase(child) {\r\n\r\n        let idx = this.childs.indexOf(child);\r\n        var childToErase = null;\r\n\r\n        if (idx !== -1)\r\n            childToErase = this.childs.splice(idx, 1);\r\n        \r\n        return childToErase;\r\n    }\r\n\r\n    eraseAt(index) {\r\n        var child = this.childs[index];\r\n\r\n        if (child)\r\n            this.childs.splice(index, 1);\r\n\r\n        return child;\r\n    }\r\n\r\n    eraseList(listToRemove, size)\r\n    {\r\n        \r\n        if (size === undefined) size = listToRemove.size;\r\n\r\n        for (let i = 0; i < size; i++)\r\n        {\r\n            let child = listToRemove.childs[i];\r\n            this.erase(child);\r\n            /*let child = this.listToRemove[i];\r\n            let index = this._instances.indexOf(gameObject);\r\n\r\n            if (index > -1)\r\n               this._instances.splice(index, 1);*/\r\n            \r\n        }\r\n    }\r\n\r\n    has(child) {\r\n        return (this.childs.indexOf(child) > -1);\r\n    }\r\n\r\n    empty() {\r\n        return (this.childs.length == 0)\r\n    }\r\n\r\n    clear() {\r\n        let i = this.childs.length;\r\n\r\n        while(i--) {\r\n            this.erase(this.childs[i]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    destroy() {\r\n        this.clear();\r\n        this.childs = [];\r\n        this.parent = null;\r\n    }\r\n\r\n    concat(otherList, clearOther)\r\n    {\r\n        if (clearOther === undefined) clearOther = false;\r\n\r\n        if (clearOther) {\r\n            this.childs = this.childs.concat(otherList.childs.splice(0));\r\n        } else {\r\n            this.childs = this.childs.concat(otherList.childs);\r\n        }\r\n\r\n        \r\n        return this;\r\n    }\r\n\r\n    each(callback) {\r\n        let params = [ null ];\r\n\r\n        var content = this.childs;\r\n\r\n        for (let i = 0; i < arguments.length; i++)\r\n            params.push(arguments[i+1]);\r\n\r\n        for (let i = 0; i < content.length; i++) {\r\n            params[0] = i;\r\n            let r = callback(content[i], params);\r\n            if (r !== undefined)\r\n                return r;\r\n           //break;\r\n        }\r\n    }\r\n\r\n    sort(predicate) {\r\n        if (predicate === undefined) return;\r\n        return MergeSort(this.childs, predicate);\r\n        \r\n        //childs.sort(predicate);\r\n    }\r\n\r\n    swap(childA, childB) {\r\n\r\n        if (childA === childB)\r\n            return;\r\n\r\n        let idx0 = this.indexOf(childA);\r\n        let idx1 = this.indexOf(childB);\r\n\r\n        if (idx0 < 0 || idx1 < 0) {\r\n            throw new Error('List.swap: Could not swap childrens. The objects are not in the list.');\r\n        }\r\n\r\n        this.list[idx0] = childA;\r\n        this.list[idx1] = childB;\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    swapByIndex(indexA, indexB) {\r\n        if (indexA === indexB)\r\n            return;\r\n\r\n        var cA = this.at(indexA);\r\n        var cB = this.at(indexB);\r\n\r\n        if (cA === undefined || cB === undefined) {\r\n            throw new Error('List.swapByIndex: Could not swap childrens by index. The objects are not in the list.');\r\n        }\r\n\r\n        this.list[indexA] = cA;\r\n        this.list[indexB] = cB;\r\n\r\n        return this;\r\n    }\r\n\r\n    reverse() {\r\n        this.childs.reverse();\r\n        return this;\r\n    }\r\n\r\n\r\n    \r\n}","\r\n\r\n\r\n// Map simple class\r\nexport default class Map {\r\n  \r\n  constructor() {\r\n    this._content = {};\r\n    this._size = 0;\r\n  }\r\n\r\n  /* \r\n  Add or set value to the map\r\n  key = keyName\r\n  value = value\r\n  */\r\n  set(key, value) {\r\n\r\n    if (!this.has(key))\r\n    {\r\n        this._size++;\r\n    }\r\n\r\n    this._content[key] = value;\r\n    \r\n    return this;\r\n\r\n  }\r\n\r\n  get(key) {\r\n      if (this.has(key))\r\n      {\r\n        return this._content[key];\r\n      }\r\n      else\r\n      {\r\n        return null;\r\n      }\r\n  }\r\n\r\n  has(key) {\r\n    return this._content.hasOwnProperty(key);\r\n  }\r\n\r\n  contains(value) {\r\n    for (var key in this._content)\r\n    {\r\n      if (entries[key] === value)\r\n      {\r\n        return true;\r\n      } else\r\n        continue;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  keys() {\r\n    return Object.keys(this._content);\r\n  }\r\n\r\n  values() {\r\n    var values = [];\r\n    var content = this._content;\r\n\r\n    for (var key in content)\r\n      values.push(entries[key]);\r\n        \r\n    return values;\r\n  }\r\n\r\n  remove(key) {\r\n\r\n    if (!this.has(key))\r\n      return null;\r\n\r\n    var prop =  this._content[key];\r\n    delete this._content[key];\r\n    this._size--;\r\n    return prop;\r\n\r\n  }\r\n\r\n  delete(key) {\r\n\r\n    if (!this.has(key))\r\n      return false;\r\n\r\n      delete this._content[key];\r\n      this._size--;\r\n\r\n      return true;\r\n  }\r\n\r\n  deleteAt(key) {\r\n\r\n    //if (!this.hasTagInKey(key))\r\n    //  return false;\r\n      this._size--;\r\n     delete this._content[key];\r\n\r\n  }\r\n\r\n  deleteByIndexedArray(array) {\r\n    for (var i = 0; i < array.length; i++) {\r\n      delete this._content[array[i]];\r\n      this._size--;\r\n    }\r\n\r\n  }\r\n\r\n  clear() {\r\n\r\n    for (var property in this._content) \r\n      delete this._content[property];\r\n    \r\n\r\n    this._size = 0;\r\n\r\n  }\r\n\r\n  slowSize() {\r\n    return Object.keys(_contents).length;\r\n  }\r\n\r\n  each(callback) {\r\n    var content = this._content;\r\n\r\n    for (var property in content) {\r\n\r\n      if (callback(property, content[property]) === false)\r\n          break;\r\n      \r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  get size() {return this._size;}\r\n\r\n}\r\n\r\n","\r\n\r\nexport default class SetData {\r\n\r\n    constructor(elements) {\r\n        this._content = [];\r\n        this._size = 0;\r\n\r\n        if (Array.isArray(elements))\r\n        {\r\n            for (var i = 0; i < elements.length; i++)\r\n                this.set(elements[i]);\r\n        }\r\n\r\n    }\r\n\r\n    set(value) {\r\n        if (this._content.indexOf(value) === -1)\r\n            this._content.push(value);\r\n\r\n        return this;\r\n    }\r\n\r\n    at(value) {\r\n        var index = this._content.indexOf(value);\r\n        if (index > -1)\r\n        {\r\n            return this._content[index];\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    has(value) {\r\n        return (this._content.indexOf(value) > -1);\r\n    }\r\n\r\n    delete(value) {\r\n        var idx = this._content.indexOf(value);\r\n\r\n        if (idx > -1)\r\n            this._content.splice(idx, 1);\r\n\r\n        return this;\r\n    }\r\n\r\n    clear() {\r\n        this._content.length = 0;\r\n        return this;\r\n    }\r\n\r\n    each(callback, scope) {\r\n        var content = this._content.slice();\r\n        var size = content.length;\r\n        var i;\r\n\r\n        if (scope)\r\n        {\r\n            for (i = 0; i < size; i++)\r\n            {\r\n                if (callback.call(scope, content[i], i) === false)\r\n                    break;                \r\n            }\r\n        } else {\r\n            for (i = 0; i < size; i++)\r\n            {\r\n                if (callback(content[i], i) === false)\r\n                    break;                \r\n            }\r\n        }\r\n\r\n      return this;\r\n    }\r\n\r\n    get size () { return this._content.length; }\r\n    get length () { return this._content.length; }\r\n\r\n}\r\n","\r\nmodule.exports = {\r\n    MergeSort : require('./mergesort')\r\n}","\r\n// http://www.stoimen.com/blog/2010/07/02/friday-algorithms-javascript-merge-sort/\r\n// https://codereview.stackexchange.com/questions/87000/fast-merge-sort-in-javascript\r\nvar MergeSort = function(array, predicate)\r\n{\r\n    var size = array.length;\r\n\r\n    if (size < 2)\r\n        return array;\r\n\r\n    if (predicate === undefined)\r\n    {\r\n        predicate = function (a, b) {\r\n            return a < b ? -1 : a === b ? 0 : 1;\r\n        };\r\n    }\r\n\r\n\r\n    /*function merge(left, right)\r\n    {\r\n        var result = [];\r\n \r\n        while (left.length && right.length) {\r\n            if (left[0] <= right[0]) {\r\n                result.push(left.shift());\r\n            } else {\r\n                result.push(right.shift());\r\n            }\r\n        }\r\n     \r\n        while (left.length)\r\n            result.push(left.shift());\r\n     \r\n        while (right.length)\r\n            result.push(right.shift());\r\n     \r\n        return result;\r\n    }*/\r\n\r\n    function merge (begin, begin_right, end) {\r\n        // Create a copy of the left and right halves.\r\n        let left_size = begin_right - begin;\r\n        let right_size = end - begin_right;\r\n        let left = array.slice(begin, begin_right);\r\n        let right = array.slice(begin_right, end);\r\n        // Merge left and right halves back into original array.\r\n        let i = begin, j = 0, k = 0;\r\n        while (j < left_size && k < right_size)\r\n            if (predicate(left[j], right[k]) <= 0)\r\n                array[i++] = left[j++];\r\n            else\r\n                array[i++] = right[k++];\r\n        // At this point, at least one of the two halves is finished.\r\n        // Copy any remaining elements from left array back to original array.\r\n        while (j < left_size) \r\n            array[i++] = left[j++];\r\n        // Copy any remaining elements from right array back to original array.\r\n        while (k < right_size) \r\n            array[i++] = right[k++];\r\n\r\n        return array;\r\n    }\r\n\r\n    function msort(start, end)\r\n    {\r\n        let len = end - start;\r\n\r\n        if (len < 2)\r\n            return;\r\n\r\n        let mid = start + (len >>> 1);\r\n        //let left = list.slice(start, mid);\r\n        //let right = list.slice(mid, end);\r\n        msort(start, mid);\r\n        msort(mid, end);\r\n        return merge(start, mid, end);\r\n        \r\n    }\r\n\r\n    //let mid = 0 + (size >>> 1);\r\n\r\n    return msort(0,size);//mid,size);\r\n\r\n    \r\n}\r\n\r\n\r\n\r\nmodule.exports = MergeSort;","\r\n\r\nexport default class Time {\r\n\r\n  constructor(game) {\r\n\r\n    this.game = game;\r\n\r\n    // START TIME\r\n    this.startTime = 0;\r\n\r\n    // date now\r\n    this.time = 0;\r\n\r\n    this.currentTime = 0;\r\n    this.previousTime = 0;\r\n\r\n    this.elapsed = 0;\r\n    this.elapsed_mili = 0;\r\n\r\n    // FOR TIME OUT MODE\r\n    this.timeOut_toCall = 0;\r\n    this.timeOut_expected = 0;\r\n\r\n    // FPS\r\n    this.fps = 60;\r\n    this.fpsDesired = 60;\r\n    this.timeStep_mili = 1 / this.fpsDesired;\r\n    this.timeStep = 1000 / this.fpsDesired;\r\n\r\n    // lag\r\n    this.accumalator = 0;\r\n    this.accumulatorMax = this.timeStep * 10;\r\n    this.accumulatorDelta = this.timeStep;\r\n\r\n    this.updateStart = 0;\r\n    this.updateLast = 0;\r\n    this.updateAverage = 0;\r\n    this.updateDelta = 0;\r\n\r\n    this.deltaTime = 0;\r\n\r\n    this._lastFpsUpdate = 0;\r\n    this._framesThisSecond = 0;\r\n\r\n  }\r\n\r\n\r\nstart() {\r\n\r\n  this.startTime = Date.now();\r\n  this.time = Date.now();\r\n\r\n}\r\n\r\nrefresh() {\r\n\r\n  var previousDateNow = this.time;\r\n\r\n  this.time = Date.now();\r\n\r\n this.elapsed_mili = this.time - previousDateNow;\r\n\r\n //this.currentTime =  this.previousTime = window.performance.now();\r\n //this.deltaTime = 0;\r\n //this.elapsed = 0;\r\n //this._framesThisSecond = 0;\r\n\r\n}\r\n\r\nupdate(timestamp) {\r\n\r\n  // DATE NOW ----------------------------------\r\n  var previousDateNow = this.time;\r\n\r\n  this.time = Date.now(); // current time\r\n\r\n  this.elapsed_mili = this.time - previousDateNow;\r\n\r\n  // timestamp --------------------\r\n\r\n  // Throttle the frame rate.\r\n  if (timestamp < this.previousTime + (this.timeStep)) {\r\n         //requestAnimationFrame(mainLoop);\r\n         return false;\r\n  }\r\n\r\n\r\n\r\n  // set prev\r\n  this.previousTime = this.currentTime;\r\n\r\n  // set current\r\n  this.currentTime = timestamp;\r\n\r\n  // delta time (MILISECONDS)\r\n  this.elapsed = this.currentTime - this.previousTime;\r\n\r\n  // delta time in  seconds\r\n  this.deltaTime = 0; //this.elapsed / 1000.0;\r\n\r\n\r\n\r\n  if (this.game.updateGameMethod._isTimeOutMode)\r\n  {\r\n\r\n\r\n      this.timeOut_toCall = Math.floor(Math.max(0, (1000.0 / this.fpsDesired) - (this.timeOut_expected - time)));\r\n\r\n      // time when the next call is expected if using timers\r\n      this.timeOut_expected = time + this.timeOut_toCall;\r\n\r\n  }\r\n\r\n  // Track acumulate time\r\n\r\n\r\n  //this.accumalator += this.elapsed; //Math.max(Math.min(this.timeStep * 3, this.elapsed), 0); //timestamp - this._lastTimeStamp;\r\n  this.accumalator += Math.max(Math.min(this.timeStep * 3, this.elapsed),0);\r\n\r\n  this.accumulatorDelta = this.timeStep; //, this.updateAverage);\r\n\r\n  //console.log(this.accumalator + \" \" + this.updateAverage);\r\n  //this._lag = Math.min(this._lag, this.accumulatorMax);\r\n\r\n  //  this.updateDelta = this.timeStep // interpolation = this.elapsed (deltatime); // or step\r\n  //this.accumulatorUpdateDelta = this.updateDelta; // interpolation = Math.max(this.updateDelta, this.updateAverage);\r\n\r\n  // FPS Update\r\n  if (this.game.debugMode)\r\n    this.fpsUpdate(timestamp);\r\n\r\n  return true;\r\n\r\n  //this.last_time = now;\r\n\r\n  /*var elapsed = (this.current_time - this.last_time)/1000.0;\r\n  this.last_time = this.current_time;\r\n  this.delta_time = Math.min(elapsed, 1/60.0);*/\r\n\r\n  //console.log(this.delta_time);\r\n\r\n  //  Adjust accordingly.\r\n  /*this.time_elapsed_mili = this.current_time - previousDateNow;\r\n\r\n  // 'now' is currently still holding the time of the last call, move it into prevTime\r\n  this.prev_time  = this.now_time;\r\n\r\n  // update 'now' to hold the current time\r\n  // this.now may hold the RAF high resolution time value if RAF is available (otherwise it also holds Date.now)\r\n  this.now_time = time;\r\n\r\n // elapsed time between previous call and now - this could be a high resolution value\r\n  this.time_elapsed = this.now_time - this.prev_time;*/\r\n\r\n\r\n\r\n  //if (this.game.updateGameMethod._usingTimeout)\r\n  //{\r\n      // console.log('Time isSet', this._desiredFps, 'te', this.timeExpected, 'time', time);\r\n\r\n      // time to call this function again in ms in case we're using timers instead of RequestAnimationFrame to update the game\r\n      //this.timeToCall = Math.floor(Math.max(0, (1000.0 / this._desiredFps) - (this.timeExpected - time)));\r\n\r\n      // time when the next call is expected if using timers\r\n    //  this.timeExpected = time + this.timeToCall;\r\n\r\n      // console.log('Time expect', this.timeExpected);\r\n//  }\r\n\r\n        //  Paused but still running?\r\n      /*  if (!this.game.paused)\r\n        {\r\n            //  Our internal Phaser.Timer\r\n            this.events.update(this.time);\r\n\r\n            if (this._timers.length)\r\n            {\r\n                this.updateTimers();\r\n            }\r\n        }*/\r\n\r\n}\r\n\r\nfpsUpdate(timestamp) {\r\n\r\n  // METHOD 2\r\n\r\n        // count the number of time.update calls\r\n  /*this._frameCount++;\r\n  this._elapsedAccumulator += this.elapsed;\r\n\r\n  // occasionally recalculate the suggestedFps based on the accumulated elapsed time\r\n  if (this._frameCount >= this._desiredFps * 2)\r\n  {\r\n      // this formula calculates suggestedFps in multiples of 5 fps\r\n      this.suggestedFps = Math.floor(200 / (this._elapsedAccumulator / this._frameCount)) * 5;\r\n      this._frameCount = 0;\r\n      this._elapsedAccumulator = 0;\r\n  }\r\n\r\n  this.msMin = Math.min(this.msMin, this.elapsed);\r\n  this.msMax = Math.max(this.msMax, this.elapsed);\r\n\r\n  this.frames++;\r\n\r\n  if (this.now > this._timeLastSecond + 1000)\r\n  {\r\n      this.fps = Math.round((this.frames * 1000) / (this.now - this._timeLastSecond));\r\n      this.fpsMin = Math.min(this.fpsMin, this.fps);\r\n      this.fpsMax = Math.max(this.fpsMax, this.fps);\r\n      this._timeLastSecond = this.now;\r\n      this.frames = 0;\r\n  }*/\r\n\r\n  // METHOD 1\r\n   if (timestamp > this._lastFpsUpdate + 1000) {\r\n       this.fps = 0.25 * this._framesThisSecond + 0.75 * this.fps;\r\n\r\n       this._lastFpsUpdate = timestamp;\r\n       this._framesThisSecond = 0;\r\n   }\r\n\r\n     this._framesThisSecond++;\r\n\r\n\r\n}\r\n\r\n}\r\n","\r\n\r\nexport default class UpdateTime {\r\n    \r\n    constructor(game, timeout) {\r\n\r\n        if (timeout === undefined) { timeout = false; }\r\n\r\n        this.game = game;\r\n        this.isRunning = false;\r\n        this.setTimeOutMode = timeout;\r\n        this._isTimeOutMode = false;\r\n\r\n        var vendors = [\r\n            'ms',\r\n            'moz',\r\n            'webkit',\r\n            'o'\r\n        ];\r\n\r\n        for (var x = 0; x < vendors.length && !window.requestAnimationFrame; x++)\r\n        {\r\n            window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\r\n            window.cancelAnimationFrame  = window[vendors[x] + 'CancelAnimationFrame'];\r\n        }\r\n\r\n        //callbacks\r\n        this._onLoopingCallback = null;\r\n        this._timeOutCallback = null;\r\n    }\r\n\r\n    start() {\r\n\r\n        this.isRunning = true;\r\n\r\n        var self = this;\r\n\r\n        if (!window.requestAnimationFrame || this.setTimeOutMode)\r\n        {\r\n            this._isTimeOutMode = true;\r\n\r\n            this._onLoopingCallback = function () {\r\n                return self.updateTimeout();\r\n            };\r\n\r\n            this._timeOutCallback = window.setTimeout(this._onLoopingCallback, 0);\r\n\r\n\r\n        }\r\n        else\r\n        {\r\n\r\n            this._isTimeOutMode = false;\r\n\r\n            this._onLoopingCallback = function (time) {\r\n                return self.updateRequestAnimationFrame(time);\r\n            };\r\n\r\n            this._timeOutCallback = window.requestAnimationFrame(this._onLoopingCallback, this.game.canvas);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    updateRequestAnimationFrame(time) {\r\n\r\n        this.game.update(time);\r\n        this._timeOutCallback = window.requestAnimationFrame(this._onLoopingCallback, this.game.canvas);\r\n\r\n    }\r\n\r\n    updateTimeout() {\r\n\r\n        this.game.update(Date.now());\r\n        this._timeOutCallback = window.setTimeout(this._onLoopingCallback, this.game.time.timeOut_toCall);\r\n\r\n    }\r\n\r\n    stop() {\r\n\r\n        if (this._isTimeOutMode)\r\n        {\r\n            clearTimeout(this._timeOutCallback);\r\n        }\r\n        else\r\n        {\r\n            window.cancelAnimationFrame(this._timeOutCallback);\r\n        }\r\n\r\n        this.isRunning = false;\r\n\r\n    }\r\n\r\n}\r\n","\r\nexport const Color = {\r\n\r\nwebRGB : function(r,g,b,a) {\r\n\r\n  return 'rgba(' + r.toString() + ',' + g.toString() + ',' + b.toString() + ',' + (a / 255).toString() + ')';\r\n\r\n},\r\n\r\n/*\r\nSource code: https://github.com/mjackson/mjijackson.github.com/blob/master/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript.txt\r\n*/\r\nHSLtoRGB : function(h,s,l,a) {\r\n\r\n  var alp = 255;\r\n\r\n  if (a !== undefined || a !== null)\r\n    alp = a;\r\n\r\n  h = h / 255.0;\r\n  s = s / 255.0;\r\n  l = l / 255.0;\r\n\r\n  var result = {r:l,b:l,g:l};\r\n\r\n  if (s !== 0)\r\n  {\r\n      var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n      var p = 2 * l - q;\r\n      result.r = this.hueToColor(p, q, h + 1 / 3);\r\n      result.g = this.hueToColor(p, q, h);\r\n      result.b = this.hueToColor(p, q, h - 1 / 3);\r\n  }\r\n\r\n  result.r = Math.floor((result.r * 255));\r\n  result.g = Math.floor((result.g * 255));\r\n  result.b = Math.floor((result.b * 255));\r\n\r\n\r\n  return this.webRGB(result.r,result.g,result.b,alp);\r\n\r\n},\r\n\r\n/*\r\nSource code: https://github.com/mjackson/mjijackson.github.com/blob/master/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript.txt\r\n*/\r\nhueToColor : function(p, q, t) {\r\n\r\n  if (t < 0)\r\n    t += 1;\r\n\r\n  if (t > 1)\r\n    t -= 1;\r\n\r\n  if (t < 1 / 6)\r\n      return p + (q - p) * 6 * t;\r\n\r\n  if (t < 1 / 2)\r\n      return q;\r\n\r\n  if (t < 2 / 3)\r\n      return p + (q - p) * (2 / 3 - t) * 6;\r\n\r\n  return p;\r\n\r\n},\r\n\r\n/*\r\nSource code: http://jsfiddle.net/mushigh/myoskaos/\r\n*/\r\nRGBtoHex : function(r,g,b) {\r\n\r\n  return \"#\" + this.componentToHex(r) + this.componentToHex(g) + this.componentToHex(b);\r\n\r\n},\r\n\r\n/*\r\nSource code: http://jsfiddle.net/mushigh/myoskaos/\r\n*/\r\ncomponentToHex : function(c) {\r\n    var hex = c.toString(16);\r\n    return hex.length == 1 ? \"0\" + hex : hex;\r\n}\r\n\r\n}\r\n\r\nmodule.exports = Color;\r\n","\r\nclass ObjectUtils {\r\n\r\n    isFunction(obj) {\r\n    return !!(obj && obj.constructor && obj.call && obj.apply);\r\n  }\r\n\r\n  getValue(obj, key, defaultValue)\r\n  {\r\n    var type = typeof(obj);\r\n\r\n    if (!obj || type === 'number' || type === 'string')\r\n        return defaultValue;\r\n    else if (obj.hasOwnProperty(key) && obj[key] !== undefined)\r\n        return obj[key];\r\n    else\r\n        return defaultValue;\r\n\r\n  }\r\n\r\n  // Get value in complex object\r\n  getPropertyValue(source, key, defaultValue)\r\n    {\r\n        if (!source || typeof source === 'number')\r\n            return defaultValue;\r\n        else if (source.hasOwnProperty(key))\r\n            return source[key];\r\n        else if (key.indexOf('.'))\r\n        {\r\n            var keys = key.split('.');\r\n            var parent = source;\r\n            var value = defaultValue;\r\n\r\n            for (var i = 0; i < keys.length; i++)\r\n            {\r\n                if (parent.hasOwnProperty(keys[i]))\r\n                {\r\n                    value = parent[keys[i]];\r\n                    parent = parent[keys[i]];\r\n                }\r\n                else\r\n                {\r\n                    value = defaultValue;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            return value;\r\n        }\r\n        else\r\n        {\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n  getURL(url, baseURL)\r\n  {\r\n    if (!url)\r\n        return null;\r\n    \r\n        \r\n    if (url.match(/^(?:blob:|data:|http:\\/\\/|https:\\/\\/|\\/\\/)/))\r\n        return url;\r\n    else\r\n        return baseURL + url;\r\n  }\r\n\r\n};\r\n\r\nexport default new ObjectUtils();","\r\nclass PathUtils {\r\n\r\n  getExtension(filename)\r\n  {\r\n    return filename.substring(filename.lastIndexOf('.')+1, filename.length) || \"\";\r\n  }\r\n\r\n}\r\n\r\nexport default new PathUtils();"],"sourceRoot":""}