{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///../node_modules/webpack/buildin/global.js","webpack:///./Scintilla.js","webpack:///./cache/Cache.js","webpack:///./cache/CacheManager.js","webpack:///./camera/Camera.js","webpack:///./camera/ResizeCamera.js","webpack:///./camera/UpdateCamera.js","webpack:///./core/Config.js","webpack:///./core/Game.js","webpack:///./core/GameLoop.js","webpack:///./core/GameSystemManager.js","webpack:///./core/SceneSystem.js","webpack:///./core/index.js","webpack:///./dom/RequestAnimationFrame.js","webpack:///./entities/Entity.js","webpack:///./entities/EntityFactory.js","webpack:///./entities/EntityHierarchy.js","webpack:///./entities/EntityUpdateList.js","webpack:///./entities/SceneEntity.js","webpack:///./entities/index.js","webpack:///./input/Input.js","webpack:///./input/Mouse.js","webpack:///./input/MouseButton.js","webpack:///./input/index.js","webpack:///./input/keyboard/Key.js","webpack:///./input/keyboard/KeyCode.js","webpack:///./input/keyboard/KeyEvent.js","webpack:///./input/keyboard/Keyboard.js","webpack:///./input/keyboard/components/ProcessKeyPress.js","webpack:///./input/keyboard/components/ProcessKeyRelease.js","webpack:///./loader/AssetsType.js","webpack:///./loader/File.js","webpack:///./loader/ListInjector.js","webpack:///./loader/LoaderManager.js","webpack:///./loader/LoaderState.js","webpack:///./loader/URLObject.js","webpack:///./loader/XHR.js","webpack:///./loader/assets/ImageFile.js","webpack:///./loader/assets/JSONFile.js","webpack:///./loader/assets/TextFile.js","webpack:///./loader/assets/TilemapJSON.js","webpack:///./loader/assets/index.js","webpack:///./loader/index.js","webpack:///./math/BoundingBox.js","webpack:///./math/MathUtils.js","webpack:///./math/Matrix.js","webpack:///./math/Rect.js","webpack:///./math/Vector.js","webpack:///./modules/Module.js","webpack:///./modules/ModuleAttacher.js","webpack:///./modules/ModuleManager.js","webpack:///./modules/ModuleProvider.js","webpack:///./modules/components/AttachModuleInGame.js","webpack:///./modules/components/InitializeModuleBase.js","webpack:///./modules/components/ModulesUpdater.js","webpack:///./modules/index.js","webpack:///./modules/renderables/Renderable.js","webpack:///./modules/renderables/Sprite.js","webpack:///./modules/renderables/Tilemap.js","webpack:///./modules/renderables/TilemapLayer.js","webpack:///./modules/renderables/components/CullTiles.js","webpack:///./modules/renderables/components/CullingMethod.js","webpack:///./modules/renderables/components/DrawImage.js","webpack:///./modules/renderables/components/DrawTilemapLayer.js","webpack:///./modules/renderables/components/UpdateRenderable.js","webpack:///./modules/renderables/index.js","webpack:///./others/Debug.js","webpack:///./physics/physics.js","webpack:///./physics/sat.js","webpack:///./physics/satresponse.js","webpack:///./render/Define.js","webpack:///./render/Draw.js","webpack:///./render/Render.js","webpack:///./render/RenderLayer.js","webpack:///./render/RenderLayersManagement.js","webpack:///./render/canvas/Canvas.js","webpack:///./render/canvas/Smoothing.js","webpack:///./render/components/BeginDrawRender.js","webpack:///./render/components/DrawRender.js","webpack:///./render/components/DrawRenderLayer.js","webpack:///./render/components/EndDrawRender.js","webpack:///./render/index.js","webpack:///./resources/ImageResource.js","webpack:///./resources/Resource.js","webpack:///./resources/ResourceType.js","webpack:///./resources/TilemapResource.js","webpack:///./resources/index.js","webpack:///./resources/tilemap/ParseGID.js","webpack:///./resources/tilemap/ParseLayers.js","webpack:///./resources/tilemap/ParseTileset.js","webpack:///./resources/tilemap/Tile.js","webpack:///./resources/tilemap/TileData.js","webpack:///./resources/tilemap/TilemapLayerData.js","webpack:///./resources/tilemap/TilemapMetadata.js","webpack:///./resources/tilemap/Tileset.js","webpack:///./scene/Scene.js","webpack:///./scene/SceneManager.js","webpack:///./structures/List.js","webpack:///./structures/Map.js","webpack:///./structures/Set.js","webpack:///./structures/index.js","webpack:///./structures/useful/MergeSort.js","webpack:///./structures/useful/index.js","webpack:///./time/GameTime.js","webpack:///./time/UpdateStep.js","webpack:///./transform/ComputeBounds.js","webpack:///./transform/ComputeDelimiterPoint.js","webpack:///./transform/Transform.js","webpack:///./transform/UpdateBounds.js","webpack:///./transform/UpdateTransform.js","webpack:///./transform/UpdateTransformBounds.js","webpack:///./utils/Base64Utils.js","webpack:///./utils/Color.js","webpack:///./utils/ObjectUtils.js","webpack:///./utils/Path.js"],"names":["scintilla","VERSION","Core","require","Struct","Render","KeyCode","MouseButton","Input","MathUtils","Matrix","Camera","Module","Entity","Resources","Cache","Loader","Game","Color","ShapeType","Rect","Circle","Polygon","module","exports","global","wrapperFunction","resources","adderWrapper","undefined","tag","asset","resource","set","has","get","delete","clear","CacheTypes","CacheManager","game","self","image","data","tilemap","json","text","cacheType","hasCache","i","length","props","destroy","register","canvas","width","config","camera","height","bounds","viewBounds","transform","_pixelUnit","x","y","_aspectRatio","_backgroundColor","rgbToHex","_roundPixels","roundPixels","system","render","_isDirty","entity","position","r","g","b","a","rgba","reset","value","scale","angle","rotation","degToRad","origin","color","flag","ResizeCamera","UpdateCamera","t","_oldRotation","_cosSin","Math","sin","cos","pos","round","setMin","setMax","matrix","setIdentity","translate","radianRotate","Config","callback","getValue","callback_2","getPropertyValue","parent","debug","floorTiles","loader","baseURL","path","responseType","async","fps","time","timeoutMode","pixelated","systemInited","isRunning","debugMode","timeMode","scene","sound","input","pool","systems","context","parseConfiguration","init","physics","loop","console","log","cache","load","draw","universe","world","component","instance","animationCache","updateGameMethod","GameLoop","updateStep","entityUpdateList","currentScene","entityList","deltaTime","update","shouldUpdate","preUpdate","_setup","loading","lateUpdate","gameSystems","GameSystemManager","property","sys","name","_game","keyboard","mouse","key","systemName","SceneSystem","RequestAnimationFrame","_isTimeOutMode","thick","lastTime","loopCallback","timeOutIdentifier","updateRequestAnimationFrame","timeStamp","window","requestAnimationFrame","updateTimeout","dateTime","Date","now","delay","max","setTimeout","clearTimeout","cancelAnimationFrame","stop","loopingCallback","_name","_active","EntityFactory","entityName","size","modules","attach","sprite","current_scene","add","EntityHierarchy","children","child","addChildAt","index","removeChild","splice","_changeDepth","Error","indexOf","removeChildAt","getChildAt","EntityUpdateList","_instances","_destroyInstances","_pendingInstances","_camera","push","dt","element","at","active","call","removeSize","insertSize","eraseList","concat","childs","SceneEntity","type","markDirty","MouseEvent","NONE","PRESS","PRESSED","RELEASE","Mouse","button","wheelDelta","_mouseButtons","_mouseButtonsLocks","_mouseButtonsLocksPressed","_mouseDownDuration","_onMouseDown","_onMouseMove","event","onMouseDown","_onMouseUp","onMouseUp","onMouseMove","addEventListener","_onMouseOver","_onMouseOut","rect","getBoundingClientRect","floor","clientX","left","right","clientY","top","bottom","preventDefault","buttonLock","hit","object","vec2","Left","Middle","Right","WheelUp","WheelDown","Key","Keyboard","keycode","keyCode","_enabled","status","press","release","_event","pressTime","pressDuration","releaseTime","releaseDuration","Backspace","Tab","Enter","Shift","Ctrl","Alt","Pause","CapsLock","Escape","Space","PageUp","PageDown","End","Home","Up","Down","Insert","Delete","Num0","Num1","Num2","Num3","Num4","Num5","Num6","Num7","Num8","Num9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","LSystem","RSystem","SelectK","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","Multiply","Add","Subtract","DecimalPoint","Divide","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","NumLock","ScrollLock","SemiColon","Equal","Comma","Dash","Period","Slash","LBraket","BackSlash","RBracket","Quote","KeyEvent","IDLE","RELEASED","eventTarget","eventHandler","_eventQueue","_keyMapping","lastKey","prop","hasOwnProperty","document","handler","defaultPrevented","removeEventListener","_onKeyDown","_onKeyUp","_onKeyPress","eventSize","queue","isPressed","isReleased","ProcessKeyPress","ProcessKeyRelease","AssetsType","File","useExternal","url","xhrSettings","createSettings","merge","state","PENDING","totalBytes","loadedBytes","progress","source","xhrRequest","crossOrigin","gameLoader","FINISHED","onDone","nextFile","getURL","warn","createFileRequest","xhr","XHRreset","target","next","onPostLoad","error","lengthComputable","loaded","total","min","DONE","processingCallback","PROCESSING","onload","onerror","onprogress","ListInjector","list","toObj","func","LoadManager","_filesQueue","_filesLoading","_successFiles","_failedFiles","_processedFiles","_filesQueueCount","_loadedFilesCount","isDownloading","_totalFiles","gameConfig","timeout","inject","substr","baseUrl","check","isOK","LOADING","loadFinished","processFileQueue","each","file","loadAsset","concludedFile","hasError","updateProgress","processingDone","onProcessing","processingUpdate","bind","ERROR","deleteFromSuccessQueue","sort","audio","requestXHR","response","addSound","autoDecode","decode","tilemapJSON","preloadComplete","_successCount","_fileErrorCount","AssetTypeHandler","LOADER_STATE","URLObject","create","URL","src","createObjectURL","reader","FileReader","removeAttribute","result","split","readAsDataURL","revoke","revokeObjectURL","XHR","settings","xmlHttpRequest","XMLHttpRequest","open","onLoad","onError","onProgress","onReadyStateChange","onreadystatechange","send","doAsync","out","setting","ImageFile","assetTag","fileConfig","ext","getExtension","Image","force","addAsset","JSONFile","JSON","parse","xhrLoader","responseText","TextFile","endPointPath","CheckImagesSources","fullPath","tileset","getFilenameWithoutExtension","getPathWithoutRoot","getFilename","TilemapFileJSON","tilesets","TilemapJSON","Assets","LoaderState","LoaderManager","BoundingBox","Infinity","minX","minY","maxX","maxY","xRadius","yRadius","mergeWithPoint","xmin","ymin","xmax","ymax","o","toString","PI","radToDeg","TAU","EPSILON","pow","HALFPI","clamp","randomRange","random","irandomRange","lerp","fromValue","toValue","lerpAngle","end","start","difference","abs","rangeZero","distance","x0","y0","x1","y1","sqrt","angleBetween","toDegree","atan2","radians","tobiJS","toRadian","degrees","j","setTransform","c","d","e","f","h","radianAngle","a00","a01","a10","a11","a20","a21","other","point","setAll","mat","str","val","copy","zero","k","intersects","contains","vec","rect1","rect2","Vector","managed","dx","dy","s","otherVector","mag","dot","project","squaredLenght","magnitude","vector","dp","proj","axis","sub","projectNormal","moduleType","moduleName","moduleManager","_moduleType","_moduleName","ModuleAttacher","ModuleManager","attached","_pendingModulesInitialization","ModuleProviderManager","proxyModules","modulesManager","args","newModule","ModuleProvider","AttachModuleInGame","entityModule","layer","renderLayers","layers","InitializeModuleBase","instace","ModulesUpdater","mod","Renderables","Renderable","_layerID","_depth","_alpha","_depthDirty","_bounds","_originInPixels","_originIsDirty","_depthSorting","alpha","Sprite","frame","setSource","changeFrame","setFrame","spr","setSprite","Tilemap","tileWidth","metaData","tileHeight","orientation","pixelsWidth","pixelsHeight","culling","method","res","TilemapLayer","layerData","CullTiles","LimitCulling","rot","tx","ty","LINEAR","ceil","CullingMethod","LINEAR90DEG","DrawImage","destination","drawImage","DrawTilemapLayer","draws","idx","tile","tiles","UpdateRenderable","renderable","Debug","lineHeight","column","font","textColor","bgcolor","textShadow","strokeStyle","rectangle","drawLine","desiredFps","drawCalls","textLine","xx","fillStyle","fillText","Physics","sat","colliadables","obj","objA","shapeA","shape","_gameObject","_selfDestroy","jit","objB","shapeB","box","getType","onCollision","SAT","VECTORS","v","ARRAYS","points","normal","Number","MAX_VALUE","len","posA","posB","pointsA","pointsB","rangeA","pop","rangeB","offsetV","projectedOffset","flattenPointsOn","overlap","aInB","bInA","option1","option2","absOverlap","overlapN","reverse","getPoints","normalsA","getNormals","normalsALen","normalsB","normalsBLen","isSeparatingAxis","overlapV","SATResponse","indexShapeA","indexShapeB","RENDERING_TYPE","NEAREST","Draw","fontname","anchor","img","getAsset","ctx","save","restore","xscale","yscale","fillRect","outlineWidth","lineWidth","strokeRect","globalAlpha","bb","outlineRectangle","getContext","imageRendering","smooth","_enable","currentContext","RenderLayer","layerName","renderList","__drawCalls","__enable","__isDirty","renderer","remove","__renderers","RenderLayersManagement","__renderLayersMap","erase","defaultDef","tabindex","id","class","container","style","CO","createElement","setAttribute","Canvas","appendDOM","appendTo","overflowHidden","getElementById","nodeType","body","appendChild","CanvasSmoothing","prefix","getPrefix","vendors","renderType","setEnable","BeginDrawRender","clearRect","DrawRender","delta","clip","globalCompositeOperation","enable","test","DrawRenderLayer","sortDepth","EndDrawRender","RenderLayerManagement","ImageResource","imageUrl","complete","naturalWidth","naturalHeight","Resource","None","ResourceType","TilemapResource","tilewidth","tileheight","orietation","gid","hasGID","ParseGID","FLIPPED_HORIZONTALLY_FLAG","FLIPPED_VERTICALLY_FLAG","FLIPPED_DIAGONALLY_FLAG","ParseGIDFlags","flipped_horizontally","flipped_vertically","flipped_diagonally","flip","flipped","global_tile_id","Boolean","flags","flipHorizontal","flipVertical","flipDiagonal","ParseLayers","map","tileLayers","jsonLayer","enconding","decodeToUint32","newLayer","opacity","visible","gidProp","getTilesetByGID","getTile","ParseTilesets","tileSets","jsonTileset","newTileSet","firstgid","margin","spacing","updateData","imagewidth","imageheight","Tile","tileData","tileX","tileY","st","TileData","u","umax","vmax","keyFrames","TilemapLayerData","TilemapMetadata","Tileset","rows","collumns","gidCount","imageWidth","imageHeight","columns","Scene","gameObject","instances","clone","cl","arguments","GameObject","_id","SceneManager","_scenes","_currentSceneName","_changeScene","_clearCache","onStartCallback","onLoadingCallback","onLoadingRenderCallback","onPreloadCallback","onRenderCallback","onDestroyCallback","sceneName","newScene","prototype","isPrototypeOf","clearCache","onUpdateCallback","scenes","unject","clearCurrentScene","setupScene","totalQueuedFiles","DataList","elements","unique","Array","isArray","unshift","childToErase","listToRemove","count","otherList","clearOther","params","content","predicate","childA","childB","idx0","idx1","indexA","indexB","cA","cB","DataMap","_content","_size","entries","Object","keys","values","array","_contents","DataSet","scope","slice","Utils","Set","Map","List","MergeSort","begin","begin_right","left_size","right_size","msort","mid","GameTime","gameLoop","_updateStep","fpsDesired","elapsed","hiDeltaTime","UpdateStep","startTime","previousTime","requireFpsUpdate","currentFps","_nextFpsUpdate","_framesThisSecond","interpolation","timeStep","minTimeStep","accumalator","accumulatorMax","updateLast","updateAverageDelta","frameCounter","performance","fpsUpdate","accumalatorMethod","frameRate","accumulator","accumalatorMax","deltaUpdate","accumulatorUpdateDelta","updateStart","stepSize","previousTimeTime","accumalatorReset","ComputeBounds","transformPoint","ComputeDelimiterPoint","coord","xa","ya","Transform","worldPosition","worldScale","globalBounds","UpdateBounds","cosSin","coords","UpdateTransform","parentTransform","setModelMatrix","UpdateTransformBounds","Base64Utils","atob","bin","bytes","charCodeAt","encode","btoa","HSLtoRGB","l","alp","q","p","hueToColor","componentToHex","hex","ObjectUtils","constructor","apply","defaultValue","match","Path","filename","substring","lastIndexOf","removeExtension","getPath","getRootPath","getDirectoryName","dir"],"mappings":"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","file":"scintilla.dev.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Scintilla\"] = factory();\n\telse\n\t\troot[\"Scintilla\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./Scintilla.js\");\n","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\r\n} catch (e) {\r\n\t// This works if the window reference is available\r\n\tif (typeof window === \"object\") g = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n","/**\r\n* @author       Tobias Beise Ulrich\r\n* @license      MIT\r\n*\r\n* @overview\r\n*\r\n* --- Scintilla ---\r\n*\r\n* v0.0.1\r\n*\r\n* tobiasbu.github.io\r\n*\r\n* Scintilla is simple 2D game engine for HTML5 games.\r\n* The first version is only for browsers based in canvas.\r\n*\r\n*/\r\n\r\n/**\r\n* @namespace scintilla\r\n*/\r\nvar scintilla = scintilla || {\r\n  VERSION: '0.0.1',\r\n\r\n  Core : require('./core'),\r\n\r\n  // DATA STRUCTURES\r\n  Struct : require('./structures'),\r\n  // RENDER\r\n  Render : require('./render'),\r\n  // INPUT\r\n  KeyCode : require('./input/keyboard/KeyCode'),\r\n  MouseButton : require('./input/MouseButton'),\r\n  Input : require('./input'),\r\n  // MATH\r\n  MathUtils : require('./math/MathUtils'),\r\n  Matrix : require('./math/Matrix'),\r\n  // ENTITIES\r\n  Camera : require('./camera/Camera'),\r\n  Module : require('./modules'),\r\n  Entity : require('./entities'),\r\n  // CORE\r\n  Resources : require('./resources'),\r\n  Cache : require('./cache/CacheManager'),\r\n  Loader : require('./loader'),\r\n  Game : require('./core/Game'),\r\n  // UTILITIES\r\n  Color : require('./utils/Color')\r\n};\r\n\r\nscintilla.ShapeType = {\r\nRect : 1,\r\nCircle : 2,\r\nPolygon : 3\r\n}\r\n\r\n\r\nmodule.exports = scintilla;\r\n\r\nglobal.scintilla = scintilla;","import DataMap from \"../structures/Map\";\r\n\r\nexport default class Cache {\r\n\r\n    constructor(wrapperFunction) {\r\n        this.resources = new DataMap();\r\n        this.adderWrapper = wrapperFunction || undefined;\r\n    }\r\n\r\n    add(tag, asset) {\r\n\r\n        let resource = asset;\r\n\r\n        if (this.adderWrapper !== undefined)\r\n            resource = this.adderWrapper(tag, asset);\r\n\r\n        this.resources.set(tag, resource);\r\n    }\r\n\r\n    has(tag) {\r\n        return this.resources.has(tag);\r\n    }\r\n\r\n    get(tag) {\r\n        return this.resources.get(tag);\r\n    }\r\n\r\n    erase(tag) {\r\n        this.resources.delete(tag);\r\n        return this;\r\n    }\r\n\r\n    clear() {\r\n        this.resources.clear();\r\n    }\r\n\r\n    destroy() {\r\n        this.resources.clear();\r\n        this.resources = null;\r\n    }\r\n\r\n}","import GameSystemManager from \"../core/GameSystemManager\";\r\nimport ImageResource from \"../resources/ImageResource\";\r\nimport TilemapResource from \"../resources/TilemapResource\";\r\nimport Cache from \"./Cache\";\r\n\r\nconst CacheTypes = [\r\n  'image',\r\n  'json',\r\n  'audio',\r\n  'text',\r\n  'tilemap',\r\n];\r\n\r\n/**\r\n* Cache manager - holds file data\r\n* @class Cache\r\n* @constructor\r\n*/\r\nexport default class CacheManager {\r\n\r\nconstructor(game) {\r\n  this.game = game;\r\n\r\n\r\n  let self = this;\r\n\r\n  this.image = new Cache((tag, data) => {\r\n    return new ImageResource(tag, data)\r\n  });\r\n  \r\n  this.tilemap = new Cache((tag, data) => {\r\n    return new TilemapResource(tag, data, self);\r\n  });\r\n\r\n  this.json = new Cache();\r\n  this.text = new Cache();\r\n\r\n\r\n}\r\n\r\n  /*addTilemap(tag, dataFormat) {\r\n    this._cache.tilemap[tag] = new TilemapResource(dataFormat, tag, this);\r\n  }\r\n\r\n  addJSON(tag, dataFormat) {\r\n    this._cache.json[tag] = dataFormat;\r\n  }\r\n\r\n  addImage(tag, url, data) {\r\n\r\n    if (this.tagExists('images',tag))\r\n      this.removeTagAt('images',tag);\r\n\r\n    \r\n    var img = new ImageResource(data,tag)\r\n\r\n    this._cache.images[tag] = img;\r\n\r\n  }\r\n\r\n  addSound(tag, url,data,webAudio) {\r\n\r\n    var decoded = false;\r\n\r\n    if (!webAudio)\r\n    {\r\n        decoded = true;\r\n    }\r\n\r\n    var audio = {\r\n            tag: tag,\r\n            url: url,\r\n            data: data,\r\n            usingWebAudio: webAudio,\r\n            decoded: decoded,\r\n            isDecoding: false\r\n    };\r\n\r\n    this._cache.sounds[tag] = audio;\r\n\r\n  }\r\n\r\n  soundDecoded(tag, data) {\r\n\r\n    var sound = this.getAssetInfo(\"sounds\",tag);\r\n\r\n    sound.data = data;\r\n    sound.decoded = true;\r\n    sound.isDecoding = false;\r\n\r\n  }*/\r\n\r\n  hasCache(cacheType) {\r\n    return (typeof CacheTypes[cacheType] !== undefined);\r\n  }\r\n\r\n  getAsset(cacheType, tag) { // return the cache container\r\n\r\n    if (!this.hasCache(cacheType))\r\n      return null;\r\n\r\n    return this[cacheType].get(tag);\r\n\r\n  }\r\n\r\n  clear() {\r\n\r\n    for (let i = 0; i < CacheTypes.length; i++) {\r\n      this[props[i]].clear();\r\n    }\r\n\r\n  }\r\n\r\n  destroy() {\r\n\r\n    for (let i = 0; i < CacheTypes.length; i++) {\r\n      this[props[i]].destroy();\r\n      this[props[i]] = null;\r\n    }\r\n\r\n    this.game = null;\r\n  }\r\n\r\n  // SOUND STUFF\r\n\r\n}\r\n\r\nGameSystemManager.register('Cache', CacheManager, 'cache');","\r\nimport BoundingBox from '../math/BoundingBox';\r\nimport Transform  from '../transform/Transform';\r\nimport Color from '../utils/Color'\r\nimport GameSystemManager from '../core/GameSystemManager';\r\nimport MathUtils from '../math/MathUtils'\r\nimport Vector from '../math/Vector'\r\nimport ResizeCamera from './ResizeCamera';\r\n\r\nexport default class Camera {\r\n  \r\n  constructor(game) {\r\n\r\n    this.game = game;\r\n    this.canvas = null;\r\n\r\n   \r\n    this.width = game.config.camera.width;\r\n    this.height = game.config.camera.height;\r\n\r\n\r\n    this.bounds = new BoundingBox(); // render bounds\r\n    this.viewBounds = new BoundingBox(0,0, this.width, this.height); // global bounds\r\n    this.transform = new Transform();\r\n   \r\n    \r\n    //this.transform.origin.set(0.5,0.5)\r\n    //this.centerView();\r\n    // this._resolution = 1;\r\n    this._pixelUnit = {x:1,y:1};    \r\n    this._aspectRatio = 1;\r\n\r\n    this._backgroundColor = Color.rgbToHex(0,0,0);\r\n    this._roundPixels = game.config.roundPixels;\r\n\r\n  }\r\n\r\n  init() {\r\n    this.canvas = this.game.system.render.canvas;\r\n    ResizeCamera(this, this.canvas, this.width, this.height);\r\n  }\r\n\r\n  get position() { \r\n    return { \r\n      x : this.transform.position.x, \r\n      y : this.transform.position.y\r\n    }; \r\n  }\r\n  set position(value) { \r\n    this.transform.position.x = value.x;\r\n    this.transform.position.y = value.y; \r\n    this.transform._isDirty = true;\r\n    return this;\r\n  }\r\n  get x() {return this.transform.position.x;}\r\n  set x(value) { \r\n    this.transform.position.x = value; \r\n    this.transform._isDirty = true;\r\n    return this;\r\n  }\r\n  \r\n  get y() {return this.transform.position.y;}\r\n  set y(value) { \r\n    this.transform.position.y = value; \r\n    this.transform._isDirty = true;\r\n    return this;\r\n  }\r\n\r\n  get scale() { return this.transform.scale.x; }\r\n  set scale(value) { \r\n    this.transform.scale.x = value; \r\n    this.transform._isDirty = true; \r\n    return this;\r\n  }\r\n\r\n  get angle() { return this.transform.angle; }\r\n  set angle(value) { \r\n    this.transform.angle = value; \r\n    this.transform.rotation = value * MathUtils.degToRad;\r\n    this.transform._isDirty = true;\r\n    return this;\r\n  }\r\n\r\n  get origin() { return this.transform.origin; }\r\n  set origin(value) {\r\n    this.transform.x = value.x;\r\n    this.transform.y = value.y;\r\n    this.transform._isDirty = true;\r\n    return this;\r\n  }\r\n\r\n  get rotation() { return this.transform.rotation; }\r\n\r\n  set backgroundColor(color) {\r\n    if (color === undefined) { color = 'rgba(0,0,0,0)'; }\r\n    this._backgroundColor = color;\r\n    return this;\r\n  }\r\n  get backgroundColor() {\r\n    return this._backgroundColor = color;\r\n  }\r\n\r\n  set roundPixels(flag) {\r\n    this._roundPixels = flag;\r\n    this.transform._isDirty = true;\r\n    return this;\r\n  }\r\n  get size() {\r\n    return {x:this.width, y:this.height};\r\n  }\r\n\r\n  centerView() {\r\n    this.x = this.width * 0.5;\r\n    this.y = this.height * 0.5;\r\n    this.transform._isDirty = true;\r\n    return this;\r\n  }\r\n\r\n  centerToEntity(entity) {\r\n    this.x = entity.position.x;\r\n    this.y = entity.position.y;\r\n    this.transform._isDirty = true;\r\n    return this;\r\n  }\r\n\r\n  setBackgroundColor(r, g, b, a) {\r\n    if (r === undefined) { g = 0; }\r\n    if (g === undefined) { g = 0; }\r\n    if (b === undefined) { b = 0; }\r\n    if (a === undefined) { a = 1; }\r\n    this._backgroundColor = Color.rgba(r,g,b,a);\r\n    return this;\r\n  }\r\n\r\n  setSize(width, height) {\r\n    ResizeCamera(this, this.canvas, width, height);\r\n    this.transform._isDirty = true;\r\n    return this;\r\n  }\r\n\r\n  setView(x, y, width, height) {\r\n    this.transform.position.x = x;\r\n    this.transform.position.y = y;\r\n    ResizeCamera(width, height);\r\n    this.transform._isDirty = true;\r\n    return this;\r\n  }\r\n\r\n  reset() {\r\n    this.transform.reset();\r\n  }\r\n\r\n}\r\n\r\nGameSystemManager.register('Camera', Camera, 'camera');","\r\nexport default function ResizeCamera(camera, canvas, width, height) {\r\n\r\n    camera.width = width;\r\n    camera.height = height;\r\n    camera._aspectRatio = width / height;\r\n    camera._pixelUnit.x = canvas.width / camera.width;\r\n    camera._pixelUnit.y = canvas.height / camera.height;\r\n}","import UpdateBounds from \"../transform/UpdateBounds\";\r\nimport ComputeDelimiterPoint from \"../transform/ComputeDelimiterPoint\";\r\nimport ComputeBounds from \"../transform/ComputeBounds\";\r\nimport MathUtils from \"../math/MathUtils\";\r\n\r\n\r\nexport default function UpdateCamera(camera, canvas) {\r\n    \r\n  if (!camera.transform._isDirty)\r\n    return;\r\n\r\n  let t = camera.transform;\r\n\r\n\r\n  if (t.rotation != t._oldRotation) {\r\n    t._oldRotation = t.rotation;\r\n    t._cosSin.y = Math.sin(t.rotation);\r\n    t._cosSin.x = Math.cos(t.rotation);\r\n  }\r\n\r\n  let origin = {\r\n    x: camera.width * t.origin.x,\r\n    y: camera.height * t.origin.y\r\n  };\r\n\r\n  let pos = {x: (t.position.x + origin.x),\r\n             y: (t.position.y + origin.y)};\r\n\r\n  if (camera._roundPixels) {\r\n    pos.x = MathUtils.round(pos.x);\r\n    pos.y = MathUtils.round(pos.y);\r\n  }\r\n\r\n  // update camera view\r\n  camera.viewBounds\r\n  .setMin(pos.x, pos.y)\r\n  .setMax(pos.x + camera.width, pos.y + camera.height)\r\n\r\n  pos.x = -pos.x;\r\n  pos.y = -pos.y;\r\n\r\n  // compute the basic rotation\r\n  t.matrix.setIdentity()\r\n  .scale(camera._pixelUnit.x, camera._pixelUnit.y) // resolution\r\n  .translate(pos.x , pos.y)\r\n  .scale(t.scale.x, t.scale.x)\r\n  \r\n  // bounds should not be rotated\r\n  ComputeBounds(\r\n    camera.bounds, camera.transform, \r\n    camera.width, camera.height, \r\n    pos);\r\n\r\n    t.matrix\r\n    .radianRotate(t._cosSin.x, t._cosSin.y)\r\n    .translate(-origin.x, -origin.y);\r\n\r\n  \r\n\r\n}","\r\nimport ObjectUtils from '../utils/ObjectUtils';\r\n\r\nexport default class Config {\r\n\r\n    constructor(config)\r\n    {\r\n        if (config === undefined) \r\n            config = {};\r\n\r\n        var callback = ObjectUtils.getValue;\r\n        var callback_2 = ObjectUtils.getPropertyValue;\r\n\r\n        // view and canvas\r\n        this.width = callback(config, 'width', 640);\r\n        this.height = callback(config, 'height', 480);\r\n        this.parent = callback(config, 'parent', null);\r\n        this.debug =  callback(config, 'debug', false);\r\n\r\n        this.roundPixels = callback(config, 'roundPixels', false);\r\n        this.floorTiles = callback(config, 'floorTiles', false),\r\n\r\n        // loader\r\n        this.loader = {\r\n            baseURL : callback_2(config, 'loader.baseURL', ''),\r\n            path : callback_2(config, 'loader.path', ''),\r\n            responseType : callback_2(config, 'loader.responseType', ''),\r\n            async : callback_2(config, 'loader.async', true),\r\n        }\r\n\r\n\r\n\r\n        this.fps = callback(config, 'fps', 60);\r\n\r\n        this.time = {\r\n            timeoutMode : callback_2(config, 'time.timeOutMode', false),\r\n           \r\n        }\r\n\r\n        this.camera = {\r\n            width : callback_2(config, 'camera.width', this.width),\r\n            height : callback_2(config, 'camera.height', this.height)\r\n        }\r\n\r\n        this.pixelated = callback(config, 'pixelated', false);\r\n        /* this.loaderEnableParallel = GetValue(config, 'loader.enableParallel', true);\r\n            this.loaderMaxParallelDownloads = GetValue(config, 'loader.maxParallelDownloads', 4);\r\n            this.loaderCrossOrigin = GetValue(config, 'loader.crossOrigin', undefined);\r\n            \r\n            this.loaderUser = GetValue(config, 'loader.user', '');\r\n            this.loaderPassword = GetValue(config, 'loader.password', '');\r\n    this.loaderTimeout = GetValue(config, 'loader.timeout', 0);*/\r\n\r\n\r\n    }\r\n\r\n}","\r\nimport Config from './Config';\r\nimport Input from '../input/Input'\r\nimport SceneManager from '../scene/SceneManager'\r\nimport Physics from '../physics/physics'\r\nimport Debug from '../others/Debug'\r\nimport GameSystemManager from './GameSystemManager';\r\nimport GameTime from '../time/GameTime';\r\n\r\n/**\r\n* Main class of engine. Holds all main data.\r\n* @class Game\r\n* @constructor\r\n*/\r\nexport default class Game {\r\n\r\n  /**\r\n  * @property {string|HTMLElement} parent - The Games DOM parent.\r\n  * @default\r\n  */\r\n constructor()\r\n {\r\n  this.parent = 'body';\r\n  this.width = 800;\r\n  this.height = 600;\r\n\r\n  // object\r\n  this.config = new Config(config);\r\n\r\n  // boolean\r\n  this.systemInited = false;\r\n  this.isRunning = false;\r\n  this.debugMode = false;\r\n\r\n  // float\r\n  this.timeMode = false;\r\n\r\n\r\n  //objects\r\n  this.debug = null;\r\n  this.scene = null;\r\n  this.sound = null;\r\n  this.input = null;\r\n  this.pool = null;\r\n  this.systems =  null;\r\n  this.context = null;\r\n  this.time = null;\r\n\r\n  this.parseConfiguration(this.config);\r\n\r\n  this.init();\r\n }\r\n\r\n  parseConfiguration(config) {\r\n\r\n    //this.config = config;\r\n\r\n    if (config['debug'])\r\n    {\r\n        this.debugMode = config['debug'];\r\n\r\n    }\r\n\r\n    if (config['width'])\r\n    {\r\n        this.width = config['width'];\r\n    }\r\n\r\n    if (config['height'])\r\n    {\r\n        this.height = config['height'];\r\n    }\r\n\r\n    if (config['parent'])\r\n    {\r\n        this.parent = config['parent'];\r\n    }\r\n\r\n  }\r\n  /**\r\n    * Initialize engine\r\n    *\r\n    * @method tobiJS.Game#init()\r\n    * @protected\r\n    */\r\n  init() {\r\n\r\n    if (this.systemInited)\r\n        return;\r\n\r\n    this.physics = new Physics(this);\r\n    this.input = new Input(this);\r\n    this.scene = new SceneManager(this);\r\n    this.system = new GameSystemManager(this);\r\n    this.time = new GameTime(this);\r\n\r\n    this.system.init();\r\n    this.input.init();\r\n    this.time.init(this.system.loop);\r\n\r\n    if (this.debugMode)\r\n      this.debug = new Debug(this);\r\n\r\n    this.systemInited = true;\r\n    this.isRunning = true;\r\n\r\n\r\n    console.log(\"scintilla started!\");\r\n\r\n  }\r\n\r\n  destroy() {\r\n\r\n    this.physics.destroy();\r\n    this.sound.destroy();\r\n    this.input.destroy();\r\n\r\n    this.debug = null;\r\n    this.cache = null;\r\n    this.load = null;\r\n    this.canvas = null;\r\n    this.scene = null;\r\n    this.sound = null;\r\n    this.draw = null;\r\n    this.universe = null;\r\n    this.world = null;\r\n    this.input = null;\r\n    this.time = null;\r\n    this.render = null;\r\n    this.component = null;\r\n    this.instance = null;\r\n    this.animationCache = null;\r\n    this.updateGameMethod = null;\r\n\r\n\r\n  }\r\n\r\n}\r\n\r\n//scintilla.Game.prototype.constructor = scintilla.Game;\r\n\r\n\r\nmodule.exports = Game;","import RequestAnimationFrame from \"../dom/RequestAnimationFrame\";\r\nimport GameSystemManager from \"./GameSystemManager\";\r\nimport UpdateStep from \"../time/UpdateStep\";\r\nimport UpdateCamera from \"../camera/UpdateCamera\";\r\nimport BeginDrawRender from \"../render/components/BeginDrawRender\";\r\nimport DrawRender from \"../render/components/DrawRender\";\r\nimport EndDrawRender from \"../render/components/EndDrawRender\";\r\n\r\n\r\n/*\r\n*\r\n* core game loop system\r\n*\r\n* @class GameLoop\r\n* @protected\r\n*/\r\nexport default class GameLoop {\r\n\r\n    constructor(game, system) {\r\n        this.game = game;\r\n        this.system = system;\r\n        this.updateStep = new UpdateStep(this.game, this.game.config);\r\n        this.entityUpdateList = null;\r\n        this.currentScene = null;\r\n        this.camera = null;\r\n        this.canvas = null;\r\n    }\r\n\r\n    init() {\r\n       this.updateStep.init(this);\r\n       this.entityUpdateList = this.game.system.entityList;\r\n       this.camera = this.system.camera;\r\n       this.canvas = this.system.render.canvas;\r\n    }\r\n\r\n    loop(deltaTime) {\r\n\r\n         // Core Managers\r\n\r\n         this.game.input.update();\r\n         \r\n\r\n         // Entities and Scene Update\r\n\r\n         this.currentScene = this.game.scene.currentScene;\r\n\r\n        let shouldUpdate = (this.currentScene != null && this.currentScene !== undefined);\r\n        //let changeScene = (this.game.scene._changeScene != null || this.game.scene._changeScene !== undefined)\r\n\r\n        //if (changeScene)\r\n            this.game.scene.preUpdate();\r\n        \r\n\r\n        if (shouldUpdate)\r\n        {\r\n            \r\n            if (this.game.scene._setup)\r\n            {\r\n                // global scene update\r\n                if (this.currentScene.update !== undefined)\r\n                    this.currentScene.update(deltaTime);\r\n            } else {\r\n                if (this.currentScene.loading !== undefined)\r\n                    this.currentScene.loading(deltaTime);\r\n            }\r\n\r\n            UpdateCamera(this.camera, this.canvas);\r\n            \r\n            this.entityUpdateList.update(deltaTime);\r\n\r\n            this.entityUpdateList.lateUpdate(deltaTime);\r\n\r\n            if (this.camera.transform._isDirty)\r\n                this.camera.transform._isDirty = false;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    render(deltaTime) {\r\n\r\n        if (this.currentScene == null || this.currentScene === undefined)\r\n            return;\r\n\r\n        BeginDrawRender(this.system.render);\r\n\r\n        DrawRender(this.system.render, this.camera, deltaTime);\r\n\r\n        EndDrawRender(this.system.render);\r\n\r\n    }\r\n\r\n}\r\n\r\nGameSystemManager.register('GameLoop', GameLoop, 'loop');","import SceneSystem from \"./SceneSystem\";\r\n\r\n\r\nvar gameSystems = {};\r\n\r\nexport default class GameSystemManager\r\n{\r\n\r\n    constructor(game)\r\n    {\r\n        this.game = game;\r\n        //this.systems = {};\r\n    }\r\n\r\n    init() {\r\n        // register all game systems\r\n        for (let property in gameSystems) {\r\n\r\n            var sys = gameSystems[property];\r\n            this[sys.name] = new sys.system(this.game, this);\r\n        }\r\n\r\n        // initialize systems\r\n        for (let property in gameSystems) {\r\n\r\n            \r\n            var sys = this[gameSystems[property].name];\r\n            if (sys.init === undefined) continue;\r\n\r\n            sys.init();\r\n        }\r\n    }\r\n\r\n    get(system) {\r\n        return this[system];\r\n    }\r\n\r\n    inject(scene) {\r\n        \r\n        scene.game = this._game;\r\n\r\n        for (let property in SceneSystem)\r\n        {\r\n            \r\n            let sys = gameSystems[SceneSystem[property]];\r\n            scene[sys.name] = this[sys.name];\r\n        }\r\n\r\n        // Special injections, input and sound:\r\n\r\n        scene['key'] = this.game.input.keyboard;\r\n        scene['mouse'] = this.game.input.mouse;\r\n\r\n        /*for (let property in gameSystems) {\r\n\r\n            let sys = gameSystems[property];\r\n            scene[sys.name] = property[sys.system];\r\n        }*/\r\n    }\r\n\r\n    unject(scene) {\r\n\r\n        for (let property in gameSystems) {\r\n            scene[sys.name] = undefined;\r\n        }\r\n    }\r\n\r\n    update(time, deltaTime) {\r\n\r\n    }\r\n\r\n    static register(key, system, systemName)\r\n    {\r\n        gameSystems[key] = {name: systemName, system: system};\r\n    }\r\n    \r\n\r\n    \r\n}\r\n","\r\n\r\nconst SceneSystem = [\r\n    'Cache',\r\n    'Draw',\r\n    'Loader',\r\n    'EntityFactory',\r\n    'Camera'\r\n]\r\n\r\nexport default SceneSystem;\r\n","\r\nmodule.exports = {\r\n    Config : require('./Config'),\r\n    GameSystemManager : require('./GameSystemManager'),\r\n    SceneSystem : require('./SceneSystem'),\r\n    GameLoop : require('./GameLoop')\r\n}","\r\n\r\nexport default class RequestAnimationFrame {\r\n    \r\n    constructor(timeoutMode) {\r\n\r\n        if (timeoutMode === undefined) { timeoutMode = false; }\r\n\r\n        this.isRunning = false;\r\n        this._isTimeOutMode = timeoutMode;\r\n\r\n        this.thick = 0;\r\n        this.lastTime = 0;\r\n\r\n        //callbacks\r\n\r\n        // game loop\r\n        this.loopCallback = null;\r\n\r\n        // timeout/animation callback \r\n        this.timeOutIdentifier = null;\r\n\r\n        /*let vendors = [\r\n            'ms',\r\n            'moz',\r\n            'webkit',\r\n            'o'\r\n        ];\r\n\r\n        for (let x = 0; x < vendors.length && !window.requestAnimationFrame; x++)\r\n        {\r\n            window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\r\n            window.cancelAnimationFrame  = window[vendors[x] + 'CancelAnimationFrame'];\r\n        }*/\r\n\r\n        var self = this;\r\n\r\n        this.updateRequestAnimationFrame = function(timeStamp) {\r\n\r\n            self.lastTime = self.thick;\r\n            self.thick = timeStamp;\r\n            //this.game.update(time);\r\n            self.loopCallback(timeStamp);\r\n    \r\n            self.timeOutIdentifier = window.requestAnimationFrame(self.updateRequestAnimationFrame);\r\n    \r\n        }\r\n    \r\n        this.updateTimeout = function() {\r\n    \r\n            let dateTime = Date.now();\r\n            let delay = Math.max(16 + self.lastTime - dateTime, 0);\r\n            self.lastTime = self.thick;\r\n            self.thick = delay;\r\n            self.loopCallback(delay);\r\n            //this.game.update(Date.now());\r\n            self.timeOutIdentifier = window.setTimeout(self.updateTimeout, delay);\r\n    \r\n        }\r\n    }\r\n\r\n\r\n\r\n    start(loopCallback) {\r\n\r\n        if (this.isRunning)\r\n            return;\r\n\r\n        this.isRunning = true;\r\n\r\n        this.loopCallback = loopCallback;\r\n\r\n        if (!window.requestAnimationFrame || this._isTimeOutMode) {\r\n            this._isTimeOutMode = true;\r\n            this.timeOutIdentifier = window.setTimeout(this.updateTimeout, 0);\r\n        } else {\r\n            this._isTimeOutMode = false;\r\n            this.timeOutIdentifier = window.requestAnimationFrame(this.updateRequestAnimationFrame);\r\n        }\r\n\r\n    }\r\n\r\n\r\n    stop() {\r\n\r\n        if (this._isTimeOutMode)\r\n        {\r\n            clearTimeout(this.timeOutIdentifier);\r\n        }\r\n        else\r\n        {\r\n            window.cancelAnimationFrame(this.timeOutIdentifier);\r\n        }\r\n\r\n        this.isRunning = false;\r\n\r\n    }\r\n\r\n    destroy() {\r\n        this.stop();\r\n        this.loopingCallback = null;\r\n    }\r\n\r\n}\r\n","\r\n\r\n/*\r\n*\r\n* Base class for Entities\r\n*\r\n*/\r\nexport default class Entity {\r\n\r\n    constructor(name, game)\r\n    {\r\n        this._name = name || 'New Entity';\r\n        this._active = true;\r\n        this.game = game || undefined; \r\n    }\r\n\r\n    get active() {return this._active;}\r\n    set active(value)\r\n    {\r\n        value = !!value;\r\n\r\n        if (value !== this._active)\r\n            this._active = value;\r\n\r\n        return this._active;\r\n    }\r\n\r\n    get name() {return this._name;}\r\n    set name(value)\r\n    {\r\n        value = !!value;\r\n\r\n        if (value !== this._name)\r\n            this._name = value;\r\n\r\n        return this._name;\r\n    }\r\n\r\n    destroy()\r\n    {\r\n        \r\n    }\r\n\r\n};","import GameSystemManager from \"../core/GameSystemManager\";\r\nimport SceneEntity from \"./SceneEntity\";\r\n\r\nexport default class EntityFactory {\r\n    \r\n    constructor(game) {\r\n        this.game = game;\r\n        this.scene = null;\r\n        this.entityList = null;\r\n    }\r\n\r\n    init()\r\n    {\r\n        this.entityList = this.game.system.entityList;\r\n        this.scene = this.game.scene;\r\n    }\r\n\r\n    entity(entityName) {\r\n        entityName = entityName || 'SceneEntity ' + this.entityList.size;\r\n        return new SceneEntity(entityName, this.game);\r\n    }\r\n\r\n    sprite(tag, entityName) {\r\n\r\n        let entity = this.entity(entityName);\r\n        entity.modules.attach.sprite(tag);\r\n\r\n        if (this.scene.current_scene !== null) {\r\n            this.entityList.add(entity);\r\n        }\r\n\r\n        return entity;\r\n    }\r\n\r\n    tilemap(tag, entityName) {\r\n        let entity = this.entity(entityName);\r\n        entity.modules.attach.tilemap(tag);\r\n\r\n        if (this.scene.current_scene !== null) {\r\n            this.entityList.add(entity);\r\n        }\r\n\r\n        return entity;\r\n    }\r\n\r\n}\r\n\r\nGameSystemManager.register('EntityFactory', EntityFactory, 'create');","\r\nimport Entity from './Entity'\r\n\r\n// Hierarchy Tree of instances\r\n// Instance is a children of the Hierarchy tree\r\nexport default class EntityHierarchy extends Entity {\r\n\r\n  constructor(name, game) {\r\n    super(name, game);    \r\n    this.children = [];\r\n    this.parent = null;\r\n  }\r\n\r\n  get childCount() {return this.children.length;}\r\n\r\n  addChild(child) {\r\n    return this.addChildAt(child,this.children.length);\r\n  }\r\n\r\n  addChildAt(child,index) {\r\n        if(index >= 0 && index <= this.children.length)\r\n        {\r\n            if(child.parent)\r\n            {\r\n                child.parent.removeChild(child);\r\n            }\r\n\r\n            child.parent = this;\r\n\r\n            this.children.splice(index, 0, child);\r\n\r\n            this._changeDepth = true;\r\n\r\n            //if(this.stage)child.setStageReference(this.stage);\r\n\r\n            return child;\r\n        }\r\n        else\r\n        {\r\n            throw new Error(child + 'addChildAt: The index '+ index +' supplied is out of bounds ' + this.children.length);\r\n        }\r\n  }\r\n\r\n  removeChild(child)\r\n  {\r\n      var index = this.children.indexOf( child );\r\n\r\n      if(index === -1) return;\r\n\r\n      return this.removeChildAt( index );\r\n  }\r\n\r\n  removeChildAt(index)\r\n  {\r\n    var child = this.getChildAt( index );\r\n\r\n    child.parent = undefined;\r\n    this.children.splice( index, 1 );\r\n    return child;\r\n\r\n  }\r\n\r\n\r\n  getChildAt(index)\r\n  {\r\n      if (index < 0 || index >= this.children.length)\r\n      {\r\n          throw new Error('Hierarchy.getChildAt: Index '+ index +' does not exist in the child list');\r\n      }\r\n      return this.children[index];\r\n\r\n  }\r\n\r\n\r\n  /*preUpdate(time) {\r\n\r\n    for (var i = 0; i < this.children.length; i++)\r\n    {\r\n          this.children[i].preUpdate(time);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  update() {\r\n\r\n    for (var i = 0; i < this.children.length; i++)\r\n    {\r\n          this.children[i].update();\r\n    }\r\n\r\n\r\n  }\r\n\r\n  _updateTransform() {\r\n    for (var i = 0; i < this.children.length; i++)\r\n    {\r\n        this.children[i]._updateTransform();\r\n    }\r\n  }*/\r\n}","import DataList from \"../structures/List\";\r\nimport GameSystemManager from \"../core/GameSystemManager\";\r\nimport UpdateTransform from '../transform/UpdateTransform'\r\nimport Matrix from '../math/Matrix'\r\nimport ModulesUpdater from \"../modules/components/ModulesUpdater\";\r\n\r\nexport default class EntityUpdateList {\r\n\r\n    constructor(game)\r\n    {\r\n        this.game = game;\r\n        this._instances = null;\r\n        this._destroyInstances = null;\r\n        this._pendingInstances = null;\r\n        this._camera = null;\r\n    }\r\n\r\n    get length() {return this._instances.size;}\r\n\r\n    init()\r\n    {\r\n        this._instances = new DataList();\r\n        this._destroyInstances = new DataList();\r\n        this._pendingInstances = new DataList();\r\n        this._camera = this.game.system.camera;\r\n    }\r\n\r\n    add(instance) {\r\n        if (this._instances.indexOf(instance) === -1 && this._pendingInstances.indexOf(instance) === -1)\r\n        {\r\n            this._pendingInstances.push(instance);\r\n        }\r\n\r\n        return instance;\r\n    }\r\n\r\n    remove(instance) {\r\n\r\n    }\r\n\r\n    update(dt) {\r\n\r\n        \r\n        for (let i = 0; i < this._instances.size; i++) {\r\n\r\n            let element = this._instances.at(i);\r\n\r\n            if (element.active)\r\n            {\r\n                \r\n                if (element.update !== undefined)\r\n                    element.update.call(element, dt); //update(dt);\r\n\r\n                UpdateTransform(element.transform, this._camera.transform);\r\n\r\n                ModulesUpdater(element.modules, this.game);\r\n\r\n                if (element.transform._isDirty)\r\n                    element.transform._isDirty = false;\r\n\r\n                \r\n\r\n            }\r\n\r\n\r\n        }\r\n\r\n    }\r\n\r\n    lateUpdate()\r\n    {\r\n        let removeSize = this._destroyInstances.size;\r\n        let insertSize = this._pendingInstances.size;\r\n        \r\n        if (insertSize === 0 && removeSize === 0)\r\n            return;\r\n\r\n\r\n        if (removeSize > 0)\r\n            this._instances.eraseList(this._destroyInstances, removeSize);\r\n\r\n        \r\n        /*this._pendingInstances.each(instance => {\r\n\r\n            this.initializeModules(instance);\r\n\r\n            this._instances.push(instance);\r\n        })\r\n\r\n        this._pendingInstances.clear();*/\r\n\r\n        this._instances.concat(this._pendingInstances, true);\r\n\r\n        this._pendingInstances.childs.length = 0;\r\n        this._destroyInstances.childs.length = 0;\r\n\r\n    }\r\n\r\n}\r\n\r\nGameSystemManager.register('EntityUpdateList', EntityUpdateList, 'entityList');\r\n\r\n","\r\nimport EntityHierarchy from './EntityHierarchy'\r\nimport BoundingBox from '../math/BoundingBox'\r\nimport Transform from '../transform/Transform'\r\nimport ModuleManager from '../modules/ModuleManager';\r\n\r\nexport default class SceneEntity extends EntityHierarchy\r\n{\r\n    constructor(name, game)\r\n    {\r\n        name = name || 'New SceneEntity';\r\n        super(name, game || null)\r\n        this.transform = new Transform();\r\n        this.type = null;\r\n        this.pool = null;\r\n        this.modules = new ModuleManager(this);\r\n        //this.bounds = new BoundingBox();\r\n        //this._transformDirty = false;\r\n        //this._currentScene = null;\r\n        \r\n        \r\n    }\r\n\r\n    set x(value) {\r\n        this.transform.position.x = value;\r\n        this.transform.markDirty();\r\n    }\r\n\r\n    get x() { return this.transform.position.y; }\r\n\r\n    set y(value) {\r\n        this.transform.position.y = value;\r\n        this.transform.markDirty();\r\n    }\r\n\r\n    get y() { return this.transform.position.y; }\r\n\r\n    get position() { return this.transform.position; }\r\n    set position(value) { this.transform.position = value; this.transform._isDirty = true; }\r\n\r\n    get origin() { return this.transform.origin; }\r\n    set origin(value) { this.transform.origin = value; this.transform._isDirty = true; }\r\n    set ['origin.x'](value) { this.transform.origin.x = value; this.transform._isDirty = true;}\r\n    set ['origin.y'](value) { this.transform.origin.y = value; this.transform._isDirty = true;}\r\n\r\n    get scale() { return this.transform.scale; }\r\n    set scale(value) { this.transform.scale = value; this.transform._isDirty = true; }\r\n    set ['scale.x'](value) { this.transform.scale.x = value; this.transform._isDirty = true;}\r\n    set ['scale.y'](value) { this.transform.scale.y = value; this.transform._isDirty = true;}\r\n\r\n    get angle() { return this.transform.angle; }\r\n    set angle(value) { this.transform.angle = value; this.transform._isDirty = true; }\r\n   \r\n    \r\n}","\r\nmodule.exports = {\r\n    Entity : require('./Entity'),\r\n    SceneEntity : require('./SceneEntity'),\r\n    EntityUpdateList : require('./EntityUpdateList'),\r\n    EntityFactory : require('./EntityFactory'),\r\n}","\r\nimport Keyboard from \"./keyboard/Keyboard\";\r\nimport Mouse from \"./Mouse\";\r\n\r\nexport default class Input {\r\n\r\n  constructor(game) {\r\n\r\n  this.game = game;\r\n  this.mouse = null;\r\n  this.keyboard = null;\r\n\r\n  }\r\n\r\n  init() {\r\n\r\n    //this.mouse = new tobiJS.Mouse(this.game);\r\n    this.keyboard = new Keyboard(this.game);\r\n    this.mouse = new Mouse(this.game);\r\n    this.keyboard.init();\r\n    this.mouse.init();\r\n\r\n  }\r\n\r\n  update() {\r\n\r\n    this.keyboard.update();\r\n    this.mouse.update();\r\n\r\n  }\r\n\r\n  reset()\r\n  {\r\n    this.keyboard.reset();\r\n    this.mouse.reset();\r\n  }\r\n\r\n}\r\n","\r\n\r\nimport MouseButton from './MouseButton'\r\n  \r\n  export const MouseEvent = {\r\n  NONE : 0,\r\n  PRESS : 1,\r\n  PRESSED : 2,\r\n  RELEASE : 3\r\n  };\r\n\r\n\r\n  \r\n\r\nexport default class Mouse {\r\n  \r\n  constructor(game) {\r\n\r\n    this.x = 0;\r\n    this.y = 0;\r\n    this.game = game;\r\n    this.canvas = game.system.get('render').canvas;\r\n    this.button = 0;\r\n    this.wheelDelta = 0;\r\n    this.active = true;\r\n\r\n    this._mouseButtons = [];\r\n    this._mouseButtonsLocks = [];\r\n    this._mouseButtonsLocksPressed = [];\r\n    this._mouseDownDuration = [];\r\n\r\n    //callbacks\r\n    this._onMouseDown = null;\r\n    this._onMouseMove = null;\r\n\r\n    this.reset();\r\n  }\r\n\r\n  reset() {\r\n\r\n    for (var i = 0; i < 3; i++){\r\n\r\n\r\n            this._mouseButtons[i] = false;\r\n            this._mouseButtonsLocks[i] = MouseEvent.NONE;\r\n            this._mouseButtonsLocksPressed[i] = MouseEvent.NONE;\r\n            this._mouseDownDuration[i] = 0;\r\n\r\n    }\r\n\r\n  }\r\n\r\n  init() {\r\n\r\n\r\n    var self = this;\r\n\r\n    this._onMouseDown = function (event) {\r\n            return self.onMouseDown(event);\r\n    };\r\n\r\n    this._onMouseUp = function (event) {\r\n            return self.onMouseUp(event);\r\n    };\r\n\r\n    this._onMouseMove = function (event) {\r\n            return self.onMouseMove(event);\r\n    };\r\n\r\n    this.canvas.addEventListener('mousedown', this._onMouseDown, true);\r\n    this.canvas.addEventListener('mousemove', this._onMouseMove, true);\r\n    this.canvas.addEventListener('mouseup', this._onMouseUp, true);\r\n    this.canvas.addEventListener('mouseover', this._onMouseOver, true);\r\n    this.canvas.addEventListener('mouseout', this._onMouseOut, true);\r\n\r\n  }\r\n\r\n  onMouseMove(event) {\r\n\r\n    if (!this.active)\r\n      return;\r\n\r\n\r\n    var rect = this.canvas.getBoundingClientRect();\r\n\r\n\r\n    this.x = Math.floor((event.clientX-rect.left)/(rect.right-rect.left)*this.canvas.width);\r\n    this.y = Math.floor((event.clientY-rect.top)/(rect.bottom-rect.top)*this.canvas.height);\r\n    //this.x = event.clientX - rect.left;\r\n    //this.y = event.clientY - rect.top;\r\n\r\n  }\r\n\r\n  onMouseDown(event) {\r\n\r\n    if (!this.active)\r\n      return;\r\n\r\n\r\n\r\n    var value = event.button;\r\n\r\n    if (this._mouseButtonsLocksPressed[value] != MouseEvent.PRESSED && this._mouseButtonsLocksPressed[value] != MouseEvent.PRESS) {\r\n      this._mouseButtonsLocksPressed[value] = MouseEvent.PRESSED;\r\n      this._mouseDownDuration[value] = 1;\r\n    }\r\n\r\n    this._mouseButtons[value] = true;\r\n    this._mouseButtonsLocks[value] = MouseEvent.PRESS;\r\n\r\n    event.preventDefault();\r\n\r\n  }\r\n\r\n  onMouseUp(event) {\r\n\r\n    if (!this.active)\r\n      return;\r\n\r\n    var value = event.button;\r\n\r\n    this._mouseButtons[value] = false;\r\n    this._mouseButtonsLocks[value] = MouseEvent.RELEASE;\r\n    this._mouseButtonsLocksPressed[value] = MouseEvent.NONE;\r\n\r\n    event.preventDefault();\r\n\r\n\r\n  }\r\n\r\n  pressed(button) {\r\n\r\n    var buttonLock = false;\r\n\r\n    if (this._mouseButtonsLocksPressed[button] == MouseEvent.PRESSED) {\r\n      buttonLock = true;\r\n      this._mouseButtonsLocksPressed[button] = MouseEvent.PRESS;\r\n    }\r\n\r\n    var hit = this._mouseButtons[button] && buttonLock;\r\n\r\n    return hit;\r\n\r\n  }\r\n\r\n  release(button) {\r\n\r\n    var buttonLock = false;\r\n\r\n  \tif (this._mouseButtonsLocks[button] ==  MouseEvent.PRESSED ||\r\n        this._mouseButtonsLocks[button] ==  MouseEvent.PRESS ||\r\n        this._mouseButtonsLocks[button] ==  MouseEvent.NONE)\r\n  \t\tbuttonLock = false;\r\n  \telse\r\n  \t\tbuttonLock = true;\r\n\r\n  \tvar hit = !this._mouseButtons[button] && buttonLock;\r\n\r\n  \tthis._mouseButtonsLocks[button] = MouseEvent.NONE;\r\n\r\n  \treturn hit;\r\n\r\n  }\r\n\r\n  press(button) {\r\n\r\n    var buttonLock = false;\r\n\r\n    if (this._mouseButtonsLocks[button] ==  MouseEvent.RELEASE ||\r\n      this._mouseButtonsLocks[button] ==  MouseEvent.NONE)\r\n      buttonLock = false;\r\n    else\r\n      buttonLock = true;\r\n\r\n    var hit = this._mouseButtons[button] && buttonLock;\r\n\r\n    return hit;\r\n\r\n\r\n  }\r\n\r\n  update() {\r\n\r\n    for (var i = 0; i < this._mouseButtons.length; i++) {\r\n\r\n          if (this._mouseButtonsLocksPressed[i] ==  MouseEvent.PRESSED) {\r\n              if (this._mouseDownDuration[i] > 0)\r\n                this._mouseDownDuration[i]--;\r\n              else\r\n                this._mouseButtonsLocksPressed[i] = MouseEvent.PRESS;\r\n          } else\r\n            continue;\r\n\r\n\r\n    }\r\n\r\n  }\r\n\r\n  posRelativeTo(object) {\r\n\r\n    var vec2 = {x:0,y:0};\r\n\r\n    vec2.x = this.x - object.x;\r\n    vec2.y = this.y - object.y;\r\n\r\n\r\n    return vec2;\r\n\r\n  }\r\n\r\n\r\n}\r\n\r\n","\r\nexport const MouseButton = {\r\n    Left : 0,\r\n    Middle : 1,\r\n    Right : 2,\r\n    WheelUp : 3,\r\n    WheelDown : 4\r\n};","\r\nmodule.exports = {\r\n\r\n    Key : require('./keyboard/Key'),\r\n    Keyboard : require('./keyboard/Keyboard'),\r\n    Mouse : require('./Mouse'),\r\n    Input : require('./Input')\r\n    \r\n}","\r\n\r\nimport KeyEvent from './KeyEvent'\r\n\r\nexport default class Key {\r\n    \r\n    constructor(keycode, game) {\r\n\r\n        this.game = game;\r\n        this.keyCode = keycode; \r\n\r\n        this._enabled = true;       \r\n        this.status = false;\r\n        this.press = false;\r\n        this.release = false;\r\n\r\n        this.preventDefault = true;\r\n\r\n        this._event = KeyEvent.NONE;\r\n\r\n        this.pressTime = 0;\r\n        this.pressDuration = -2500;\r\n        this.releaseTime = 0;\r\n        this.releaseDuration = -2500;\r\n\r\n    }\r\n\r\n    get event() {\r\n        return this._event;\r\n    }\r\n\r\n    get enabled() {return this._enabled;}\r\n    set enabled(value) {\r\n        value = !!value;\r\n\r\n        if (value !== this._enabled)\r\n        {\r\n            if (!value)\r\n                this.reset();\r\n\r\n            this._enabled = value;\r\n        }\r\n    }\r\n\r\n\r\n    /*update() {\r\n        if (!this._enabled)\r\n            return;\r\n\r\n        if (this.press) {\r\n            this.pressDuration = this.game.time.time - this.pressTime;\r\n            \r\n        } else {\r\n            this.releaseDuration = this.game.time.time - this.releaseTime;\r\n        }\r\n\r\n\r\n        if (this.press) {\r\n            if (this.pressDuration == 0) {\r\n                this._event = KeyEvent.PRESSED;\r\n            }\r\n\r\n        } else {\r\n\r\n            if (this.releaseDuration == 0) {\r\n                this._event = KeyEvent.RELEASED;\r\n            } else {\r\n                this._event = KeyEvent.IDLE;\r\n            }\r\n\r\n        }\r\n\r\n    }*/\r\n\r\n    isPressing() {\r\n        return this.status;\r\n    }\r\n\r\n    isPressed() {\r\n        return (this.press && this.pressDuration === 0);\r\n    }\r\n\r\n    isReleased() {\r\n        return (!this.press && this.releaseDuration === 0)\r\n    }\r\n\r\n\r\n\r\n    reset()\r\n    {   \r\n        this.status = false;\r\n        this._event = KeyEvent.NONE;\r\n        this.press = false;\r\n        this.release = false;\r\n    \r\n        this.pressTime = 0;\r\n        this.pressDuration = -2500;\r\n        this.releaseTime = 0;\r\n        this.releaseDuration = -2500;\r\n    }\r\n\r\n\r\n};\r\n\r\n\r\n\r\n  \r\n","\r\nconst KeyCode = {\r\n    Backspace: 8,\r\n    Tab: 9,\r\n    Enter: 13,\r\n    Shift: 16,\r\n    Ctrl: 17,\r\n    Alt: 18,\r\n    Pause: 19,\r\n    CapsLock: 20,\r\n    Escape: 27,\r\n    Space:32,\r\n    PageUp: 33,\r\n    PageDown: 34,\r\n    End: 35,\r\n    Home: 36,\r\n    Left: 37,\r\n    Up: 38,\r\n    Right: 39,\r\n    Down: 40,\r\n    Insert: 45,\r\n    Delete:\t46,\r\n    Num0: 48,\r\n    Num1: 49,\r\n    Num2: 50,\r\n    Num3: 51,\r\n    Num4: 52,\r\n    Num5:\t53,\r\n    Num6: 54,\r\n    Num7: 55,\r\n    Num8: 56,\r\n    Num9: 57,\r\n    A: 65,\r\n    B: 66,\r\n    C: 67,\r\n    D: 68,\r\n    E: 69,\r\n    F: 70,\r\n    G: 71,\r\n    H: 72,\r\n    I: 73,\r\n    J: 74,\r\n    K: 75,\r\n    L: 76,\r\n    M: 77,\r\n    N: 78,\r\n    O: 79,\r\n    P: 80,\r\n    Q: 81,\r\n    R: 82,\r\n    S: 83,\r\n    T: 84,\r\n    U: 85,\r\n    V: 86,\r\n    W: 87,\r\n    X: 88,\r\n    Y: 89,\r\n    Z: 90,\r\n    LSystem: 91,\r\n    RSystem: 92,\r\n    SelectK:\t93,\r\n    Numpad0: 96,\r\n    Numpad1: 97,\r\n    Numpad2: 98,\r\n    Numpad3: 99,\r\n    Numpad4: 100,\r\n    Numpad5: 101,\r\n    Numpad6: 102,\r\n    Numpad7: 103,\r\n    Numpad8: 104,\r\n    Numpad9: 105,\r\n    Multiply: 106,\r\n    Add: 107,\r\n    Subtract: 109,\r\n    DecimalPoint: 110,\r\n    Divide: 111,\r\n    F1:\t112,\r\n    F2:\t113,\r\n    F3:\t114,\r\n    F4:\t115,\r\n    F5:\t116,\r\n    F6:\t117,\r\n    F7:\t118,\r\n    F8:\t119,\r\n    F9:\t120,\r\n    F10: 121,\r\n    F11: 122,\r\n    F12: 123,\r\n    NumLock: 144,\r\n    ScrollLock: 145,\r\n    SemiColon: 186,\r\n    Equal: 187,\r\n    Comma: 188,\r\n    Dash: 189,\r\n    Period:\t190,\r\n    Slash: 191,\r\n    LBraket: 219,\r\n    BackSlash: 220,\r\n    RBracket: 221,\r\n    Quote: 222,\r\n};\r\n    \r\nmodule.exports = KeyCode;","\r\nconst KeyEvent = {\r\n    NONE : -1,\r\n    IDLE: 0,\r\n    PRESSED : 1,\r\n    RELEASED : 2,\r\n};\r\n\r\nexport default KeyEvent;","\r\nimport DataMap from '../../structures/Map'\r\nimport DataList from '../../structures/List';\r\nimport Key from './Key'\r\nimport KeyCode from './KeyCode'\r\nimport KeyEvent from './KeyEvent'\r\nimport ProcessKeyPress from './components/ProcessKeyPress';\r\nimport ProcessKeyRelease from './components/ProcessKeyRelease';\r\n\r\nexport default class Keyboard {\r\n  \r\n  constructor(game) {\r\n\r\n    this.game = game;\r\n    this._enabled = true;\r\n    this.eventTarget = null;\r\n    this.eventHandler = null;\r\n    this._eventQueue = new DataList();\r\n    this._keyMapping = new DataMap();\r\n    //this._keyWatch = new DataMap();\r\n    //this._keyGarbage = [];\r\n    this.lastKey = null;\r\n\r\n  }\r\n\r\n  get enabled() {return this._enabled;}\r\n  set enabled(value) {\r\n      value = !!value;\r\n\r\n      if (value !== this._enabled)\r\n      {\r\n          if (!value)\r\n              this.reset();\r\n\r\n          this._enabled = value;\r\n      }\r\n  }\r\n\r\n  reset() {\r\n\r\n    this._keyMapping.clear();\r\n    for (var prop in KeyCode){\r\n\r\n      if (KeyCode.hasOwnProperty(prop)) {\r\n        var value = KeyCode[prop];\r\n        this._keyMapping.set(value, new Key(value, this.game));\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  init() {\r\n\r\n    this.reset();\r\n\r\n    // window;\r\n    this.eventTarget = document; //this.game.system.render.canvas;\r\n\r\n    console.log(this.eventTarget)\r\n\r\n    var self = this;\r\n\r\n    // key event handler\r\n    let handler = function(event) {\r\n\r\n      if (event.defaultPrevented) {\r\n          return;\r\n      }\r\n\r\n      self._eventQueue.push(event);\r\n\r\n      //event.preventDefault();\r\n\r\n    }\r\n\r\n    this.eventHandler = handler;\r\n\r\n    this.eventTarget.addEventListener('keydown', handler, false);\r\n    this.eventTarget.addEventListener('keyup', handler, false);\r\n  }\r\n\r\n  stop() {\r\n\r\n    this.eventTarget.removeEventListener('keydown', this.eventHandler);\r\n    this.eventTarget.removeEventListener('keyup', this.eventHandler);\r\n    this._onKeyDown = null;\r\n    this._onKeyUp = null;\r\n    this._onKeyPress = null;\r\n\r\n    this._keyMapping.clear();\r\n  }\r\n\r\n  update() {\r\n\r\n    let eventSize = this._eventQueue.size;\r\n\r\n    if (!this._enabled || eventSize === 0)\r\n      return;\r\n\r\n    // clear and copy queue\r\n    let queue = this._eventQueue.splice(0,eventSize);\r\n\r\n    // process key events\r\n    for (let i = 0; i < eventSize; i++) {\r\n      var event = queue[i];\r\n      var keycode = event.keyCode;\r\n\r\n      // check if is valid scintilla key\r\n      let key = this._keyMapping.get(keycode)\r\n\r\n      if (key !== undefined || key !== null) {\r\n\r\n        if (event.type === 'keydown') {\r\n\r\n          // /*&& (this._keyMapping.at(keycode) === undefined || this._keyMapping[keycode].press === false)*/\r\n          ProcessKeyPress(event, key);\r\n\r\n        } else { // if (event.type === 'keyup') {\r\n          ProcessKeyRelease(event, key);\r\n        }\r\n\r\n      }\r\n    }\r\n  }\r\n\r\n  pressed(keycode) {\r\n    return this._keyMapping.get(keycode).isPressed();\r\n  }\r\n\r\n  release(keycode) {\r\n    return this._keyMapping.get(keycode).isReleased();\r\n  }\r\n\r\n  press(keycode) {\r\n    return this._keyMapping.get(keycode).status;\r\n  }\r\n}\r\n\r\n \r\n\r\n   /* this._keyWatch.each(function (key, value) {\r\n        //var value = this._keyWatch.get(key);\r\n        value.update();\r\n\r\n        //console.log(value);\r\n\r\n        if (value.event == KeyEvent.IDLE)\r\n        {\r\n            self._keyGarbage.push(key);\r\n        }\r\n    });\r\n\r\n      if (this._keyGarbage.length > 0)\r\n      {\r\n        this._keyWatch.deleteByIndexedArray(this._keyGarbage);\r\n        this._keyGarbage.splice(0, this._keyGarbage.length)\r\n      }*/\r\n","\r\n export default function ProcessKeyPress(event, key) { \r\n\r\n  if (key.preventDefault) \r\n      event.preventDefault();\r\n  \r\n  if (!key._enabled)\r\n    return;\r\n\r\n  if (key.press === false)\r\n  {\r\n\r\n      // set key properties\r\n      key.status = true;\r\n      key.press = true;\r\n      key.release = false;\r\n      // set press time duration\r\n      key.pressTime = event.timeStamp;//this.game.time.time;\r\n      key.pressDuration = 0;\r\n      key.releaseDuration = key.pressTime - key.releaseTime;\r\n  }\r\n\r\n    //this.lastKey = key;\r\n\r\n\r\n\r\n    /*var keyObj = this._keyMapping.get(key);\r\n    keyObj.onKeyDown();\r\n\r\n    if (!this._keyWatch.has(key))\r\n    {\r\n      this._keyWatch.set(key, keyObj);\r\n    }*/\r\n\r\n    //_keyMapping[]\r\n    //this._keys[key] = true;\r\n    /* if (this._keyLockPressed[key] != scintilla.KeyEvent.PRESSED && this._keyLockPressed[key] != scintilla.KeyEvent.PRESS) {\r\n      this._keyLockPressed[key] = scintilla.KeyEvent.PRESSED;\r\n      this._keyDownDuration[key] = 1;\r\n    }\r\n\r\n    this._keyLock[key] = scintilla.KeyEvent.PRESS;\r\n    this._keys[key] = true;\r\n    */\r\n\r\n\r\n  }","\r\nexport default function ProcessKeyRelease(event, key) {\r\n\r\n\r\n  if (key.preventDefault) \r\n    event.preventDefault();\r\n\r\n  if (!key._enabled)\r\n    return;\r\n  \r\n  // set key properties\r\n  key.status = false;\r\n  key.press = false;\r\n  key.release = true;\r\n\r\n  // set press time duration\r\n  key.releaseTime = event.timeStamp;\r\n  key.pressDuration = key.releaseTime - key.pressTime;\r\n  key.releaseDuration = 0;\r\n\r\n}","\r\nconst AssetsType = {\r\n    'none' : 0,\r\n    'image' : 1,\r\n    'audio' : 2,\r\n    'text' : 3,\r\n    'json' : 4,\r\n    'tilemapJSON' : 5,\r\n}\r\n\r\nexport default AssetsType;","\r\nimport ObjectUtils from '../utils/ObjectUtils'\r\nimport XHR from './XHR'\r\nimport {LOADER_STATE} from './LoaderState'\r\n\r\nexport default class File {\r\n\r\n    constructor(config) {\r\n\r\n        this.type = ObjectUtils.getValue(config, 'type', null);\r\n        this.tag = ObjectUtils.getValue(config, 'tag', null);\r\n        this.useExternal =  ObjectUtils.getValue(config, 'useExternal', false);\r\n\r\n        if (this.type == null || this.tag == null)\r\n        {\r\n            throw new Error('Loader.File: Invalid tag \\\"' + tag + \"\\\".\");\r\n        }\r\n\r\n        this.url = ObjectUtils.getValue(config, 'url', undefined);\r\n\r\n        if (this.url === undefined)\r\n            this.url = ObjectUtils.getValue(config, 'path', '') + this.tag + '.' + ObjectUtils.getValue(config, 'ext', '');\r\n        else\r\n        {\r\n            if (!this.useExternal || this.useExternal !== undefined)\r\n                this.url = ObjectUtils.getValue(config, 'path', '').concat(this.url);\r\n\r\n        }\r\n\r\n        this.xhrSettings = XHR.createSettings(ObjectUtils.getValue(config, 'responseType', undefined));\r\n        \r\n        if (ObjectUtils.getValue(config, 'xhrSettings', false))\r\n            this.xhrSettings = XHR.merge(this.xhrSettings, ObjectUtils.getValue(config, 'xhrSettings', {}));\r\n\r\n        \r\n        //console.log(this.xhrSettings);\r\n       \r\n        this.loader = null;\r\n        this.state = LOADER_STATE.PENDING;\r\n        this.totalBytes = 0;\r\n        this.loadedBytes = 0;\r\n        this.progress = 0;\r\n        this.data = undefined;\r\n        this.source = null;\r\n        this.xhrRequest = null;\r\n        this.config = ObjectUtils.getValue(config,'config',{});\r\n        this.crossOrigin = undefined;\r\n\r\n        // callbacks\r\n        //loaded: false,\r\n        //error: false,\r\n        //loading:false,\r\n\r\n    }\r\n\r\n    load(gameLoader)\r\n    {\r\n        this.loader = gameLoader;\r\n\r\n\r\n        if (this.state === LOADER_STATE.FINISHED)\r\n        {\r\n            this.onDone();\r\n\r\n            this.loader.nextFile(this);\r\n        }\r\n        else\r\n        {\r\n           \r\n\r\n            this.source = ObjectUtils.getURL(this.url, gameLoader.baseURL);\r\n\r\n            \r\n            if (this.source.indexOf('data:') === 0 || this.source == null)\r\n            {\r\n                console.warn(\"Loader.File.load: unsupported URI.\");\r\n            }\r\n            else\r\n            {\r\n                this.xhrRequest = XHR.createFileRequest(this, gameLoader.xhr);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    onLoad(event)\r\n    {\r\n       \r\n        this.XHRreset();\r\n\r\n        \r\n\r\n        if (event.target && event.target.status !== 200)\r\n        {\r\n            this.loader.next(this, true);\r\n        } else {\r\n            \r\n            if (this.onPostLoad !== undefined)\r\n                this.onPostLoad(this.loader, this.xhrRequest);\r\n\r\n            this.loader.next(this, false);\r\n        }\r\n        \r\n                \r\n    }\r\n\r\n    onError(event)\r\n    {\r\n        console.error(\"Loader.File: Error on load file: \" + this.url + \".\")\r\n\r\n        this.XHRreset();\r\n\r\n        this.loader.next(this, true);\r\n    }\r\n\r\n    onProgress(event)\r\n    {\r\n        if (event.lengthComputable)\r\n        {\r\n            this.loadedBytes = event.loaded;\r\n            this.totalBytes = event.total;\r\n\r\n            this.progress = Math.min((this.loadedBytes / this.totalBytes), 1);\r\n\r\n        }\r\n    }\r\n\r\n    onDone()\r\n    {\r\n        this.state = LOADER_STATE.DONE;\r\n    }\r\n\r\n    onProcessing(processingCallback)\r\n    {\r\n        this.state = LOADER_STATE.PROCESSING;\r\n\r\n        this.onDone();\r\n\r\n        processingCallback(this);\r\n    }\r\n\r\n\r\n    XHRreset()\r\n    {\r\n        if (this.xhrRequest)\r\n        {\r\n            this.xhrRequest.onload = undefined;\r\n            this.xhrRequest.onerror = undefined;\r\n            this.xhrRequest.onprogress = undefined;\r\n            //this.xhrRequest.onreadystatechange = undefined;\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\r\n","\r\nexport default class ListInjector {\r\n\r\n    constructor()\r\n    {\r\n        this.list = {};\r\n    }\r\n\r\n    inject(toObj)\r\n    {\r\n        for (var key in this.list)\r\n        {\r\n            toObj[key] = this.list[key];\r\n        }\r\n    }\r\n\r\n    register(key, func)\r\n    {\r\n        this.list[key] = func;\r\n    }\r\n\r\n    destroyfunction()\r\n    {\r\n        this.list = {};\r\n    }\r\n\r\n};","\r\nimport { LOADER_STATE, AssetTypeHandler} from './LoaderState'\r\nimport DataSet from '../structures/Set'\r\nimport XHR from './XHR'\r\nimport ObjectUtils from '../utils/ObjectUtils';\r\nimport GameSystemManager from '../core/GameSystemManager';\r\nimport AssetsType from './AssetsType';\r\n\r\n// Class LoaderManager\r\nexport default class LoadManager {\r\n  \r\n  constructor(game) {\r\n\r\n    this.game = game;\r\n    this.cache = null;\r\n\r\n    this._filesQueue = null;\r\n    this._filesLoading = null;\r\n    this._successFiles = null;\r\n    this._failedFiles = null;\r\n    this._processedFiles = null;\r\n\r\n    this._filesQueueCount = null;\r\n    this._loadedFilesCount = null;\r\n\r\n    this.isDownloading = false;\r\n    this._totalFiles = 0;\r\n\r\n    this.progress = null;\r\n    this.path = null;\r\n    this.baseURL = null;\r\n    this.state = null;\r\n\r\n    let gameConfig = game.config.loader;\r\n\r\n    this.xhr = XHR.createSettings(\r\n      ObjectUtils.getValue(config, 'responseType', gameConfig.responseType),\r\n      ObjectUtils.getValue(config, 'async', gameConfig.async),\r\n      //scintilla.ObjectUtils.getPropertyValue(config, 'user', gameConfig.loaderUser),\r\n      //scintilla.ObjectUtils.getPropertyValue(config, 'password', gameConfig.loaderPassword),\r\n      ObjectUtils.getValue(config, 'timeout', gameConfig.timeout)\r\n  );\r\n  \r\n\r\n    AssetTypeHandler.inject(this);\r\n\r\n  }\r\n\r\n  init()\r\n  {\r\n    this.cache = this.game.system.cache;\r\n\r\n    this._filesQueue = new DataSet();\r\n    this._filesLoading = new DataSet();\r\n    this._successFiles = new DataSet();\r\n    this._failedFiles = new DataSet();\r\n    this._processedFiles = new DataSet();\r\n\r\n    this._filesQueueCount = 0;\r\n    this._loadedFilesCount = 0;\r\n\r\n    this.progress = 0;\r\n    this.path = '';\r\n    this.baseURL = '';\r\n    this.state = LOADER_STATE.IDLE;\r\n  }\r\n\r\n\r\n  setPath(path) {\r\n    if (path !== '' && path.substr(-1) !== '/')\r\n        path = path.concat('/');\r\n\r\n    this.path = path;\r\n\r\n    return this;\r\n  }\r\n\r\n  setBaseURL(baseUrl) {\r\n    if (baseUrl !== '' && baseUrl.substr(-1) !== '/')\r\n    {\r\n      baseUrl = baseUrl.concat('/');\r\n    }\r\n\r\n    this.baseURL = baseUrl || '';\r\n\r\n    return this;\r\n  }\r\n\r\n  addAsset(asset, check) {\r\n\r\n    if (check === undefined) check = true;\r\n\r\n    if (!this.isOK() && check)\r\n        return -1;\r\n\r\n    asset.path = this.path;\r\n    this._filesQueue.set(asset);\r\n    this._filesQueueCount++;\r\n    return asset;\r\n\r\n  }\r\n\r\n  reset() {\r\n\r\n    this.isDownloading = false;\r\n    this._filesQueue.clear();\r\n    this._successFiles.clear();\r\n    this._failedFiles.clear();\r\n    this._processedFiles.clear();\r\n\r\n    this._filesQueueCount = 0;\r\n    this._loadedFilesCount = 0;\r\n\r\n    this.progress = 0\r\n    this.state = LOADER_STATE.IDLE;\r\n\r\n  }\r\n\r\n  start() {\r\n\r\n    if (!this.isOK())\r\n    {\r\n        return -1;\r\n    }\r\n\r\n    this.progress = 0;\r\n    this._loadedFilesCount = 0;\r\n    this.state = LOADER_STATE.LOADING;\r\n    this._filesQueueCount = this._filesQueue.size;\r\n\r\n    if (this._filesQueue.size === 0)\r\n    {\r\n      //console.log(0);\r\n      this.loadFinished();\r\n    }\r\n    else\r\n    {\r\n      this.isDownloading = true;\r\n      this._successFiles.clear();\r\n      this._failedFiles.clear();\r\n      this._filesLoading.clear();\r\n\r\n      this.processFileQueue();\r\n    }\r\n\r\n  }\r\n\r\n  /*end : function() {\r\n\r\n    if (this.state === LOADER_STATE.PROCESSING)\r\n        return;\r\n  \r\n    this.progress = 1;\r\n    this.isDownloading = false;\r\n    this.state = LOADER_STATE.PROCESSING;\r\n\r\n    \r\n    this._filesQueue.clear();\r\n    this._failedFiles.length = 0;\r\n    \r\n    this.processFiles();\r\n\r\n    this._successFiles.clear();\r\n\r\n    this.state = LOADER_STATE.DONE;\r\n    //this.game.scene.preloadComplete();\r\n\r\n  },*/\r\n\r\n  processFileQueue() {\r\n\r\n    var self = this;\r\n\r\n    this._filesQueue.each(function(file) {\r\n\r\n      //var file = this._filesQueue[i];\r\n\r\n      if (file.state === LOADER_STATE.FINISHED ||\r\n         file.state === LOADER_STATE.PENDING) //  && this.inflight.size < this.maxParallelDownloads))\r\n      {\r\n        \r\n\r\n        self._filesLoading.set(file);\r\n\r\n        self._filesQueue.delete(file);\r\n\r\n        self.loadAsset(file);\r\n      }\r\n\r\n    });\r\n\r\n  }\r\n\r\n  loadAsset(file) {\r\n    file.load(this);\r\n  }\r\n\r\n  next(concludedFile, hasError) {\r\n\r\n      if (hasError)\r\n          this._failedFiles.set(concludedFile);\r\n      else \r\n          this._successFiles.set(concludedFile);\r\n      \r\n\r\n      this._filesLoading.delete(concludedFile);\r\n      //this._filesQueue.delete(concludedFile);\r\n      this._loadedFilesCount++;\r\n\r\n      this.updateProgress();\r\n\r\n      if (this._filesQueue.size > 0)//(this._loadedFilesCount < this._filesQueueCount)\r\n      {\r\n          this.processFileQueue();\r\n      } else if (this._filesLoading.size === 0) {\r\n        \r\n          this.loadFinished();\r\n      }\r\n\r\n  }\r\n\r\n  loadFinished() {\r\n\r\n    if (this.state === LOADER_STATE.PROCESSING)\r\n        return;\r\n  \r\n    this.progress = 1;\r\n    this.isDownloading = false;\r\n    this.state = LOADER_STATE.PROCESSING;\r\n\r\n    this._processedFiles.clear();\r\n\r\n    if (this._successFiles.size === 0)\r\n    {\r\n        this.processingDone();\r\n    } else {\r\n     \r\n      this._successFiles.each(function(file) {\r\n        file.onProcessing(this.processingUpdate.bind(this));\r\n      },this);\r\n    }\r\n   \r\n  }\r\n\r\n\r\n  processingUpdate(file) {\r\n    \r\n    if (file.state === LOADER_STATE.ERROR)\r\n    {\r\n       this._failedFiles.set(file);\r\n\r\n        /*if (file.linkFile)\r\n        {\r\n            this.queue.delete(file.linkFile);\r\n        }*/\r\n        return this.deleteFromSuccessQueue(file);\r\n    }\r\n\r\n\r\n    this._processedFiles.set(file);\r\n\r\n    return this.deleteFromSuccessQueue(file);\r\n\r\n  }\r\n\r\n  deleteFromSuccessQueue(file) {\r\n    \r\n      this._successFiles.delete(file);\r\n\r\n      if (this._successFiles.size === 0 && this.state === LOADER_STATE.PROCESSING)\r\n          this.processingDone();\r\n  }\r\n\r\n  processingDone() {\r\n    this._successFiles.clear();\r\n    this._filesQueue.clear();\r\n\r\n    var cache = this.cache;\r\n\r\n          \r\n\r\n    if (this._processedFiles.size > 0)\r\n    {\r\n\r\n      // sort the assets by type priority \r\n      this._processedFiles.sort((a, b) => {\r\n        return (a.type > b.type);\r\n      });\r\n\r\n      this._processedFiles.each(function(file) {\r\n\r\n        switch (file.type)\r\n        {\r\n          default:\r\n            break;\r\n\r\n          case AssetsType.image: {\r\n            cache.image.add(file.tag,file.data);\r\n            break;\r\n          }\r\n          case AssetsType.audio: {\r\n\r\n            file.data = requestXHR.response;\r\n\r\n            cache.addSound(file.tag,file.url,file.data,true);\r\n\r\n            if (file.autoDecode)\r\n            {\r\n                this.game.sound.decode(file.tag);\r\n            }\r\n\r\n            break;\r\n          }\r\n          case AssetsType.json: {\r\n            cache.json.add(file.tag, file.data);\r\n            break;\r\n          }\r\n\r\n          case AssetsType.tilemapJSON: {\r\n            cache.tilemap.add(file.tag, file.data);\r\n            break;\r\n          }\r\n        }\r\n\r\n      })\r\n\r\n      this._processedFiles.clear();\r\n    }\r\n\r\n    this.state = LOADER_STATE.DONE;\r\n\r\n    this.game.scene.preloadComplete();\r\n  }\r\n\r\n  isLoading() {\r\n    return (this.state === LOADER_STATE.LOADING || this.state === LOADER_STATE.PROCESSING);\r\n  }\r\n\r\n  isOK() {\r\n    return (this.state === LOADER_STATE.IDLE || this.state === LOADER_STATE.DONE || this.state === LOADER_STATE.ERROR);\r\n  }\r\n\r\n  downloadIsDone() {\r\n    return (this._filesQueue.length == (this._successCount + this._fileErrorCount));\r\n  }\r\n\r\n  updateProgress() {\r\n\r\n    var progress = 0;\r\n\r\n    if (this._filesQueueCount != 0)\r\n    {\r\n      this.progress = 1 - (this._loadedFilesCount / this._filesQueueCount);\r\n    }\r\n     //progress = parseFloat(this._successCount) / parseFloat(this._filesQueueCount);\r\n\r\n    this.progress = progress;\r\n\r\n  }\r\n\r\n\r\n  get totalQueuedFiles() {\r\n    return this._filesQueueCount - this._loadedFilesCount;\r\n  }\r\n\r\n\r\n};\r\n\r\nGameSystemManager.register('Loader',LoadManager,'load');","\r\nimport ListInjector from './ListInjector'\r\n\r\nexport var AssetTypeHandler = new ListInjector();\r\n\r\nexport const LOADER_STATE = {\r\n    NONE : 0,\r\n    IDLE : 1,\r\n    PENDING : 2,\r\n    LOADING : 3,\r\n    PROCESSING : 4,\r\n    ERROR : 5,\r\n    FINISHED : 6,\r\n    DONE : 7, \r\n};\r\n","\r\nconst URLObject = {\r\n\r\n    create : function(asset, response, type)\r\n    {\r\n\r\n\r\n        if (typeof URL === 'function')\r\n        {\r\n            asset.src = URL.createObjectURL(response);\r\n        }\r\n        else\r\n        {\r\n            var reader = new FileReader();\r\n\r\n            reader.onload = function ()\r\n            {\r\n                asset.removeAttribute('crossOrigin');\r\n                asset.src = 'data:' + (response.type || type) + ';base64,' + reader.result.split(',')[1];\r\n            };\r\n\r\n            reader.onerror = asset.onerror;\r\n\r\n            reader.readAsDataURL(response);\r\n        }   \r\n    },\r\n\r\n    revoke : function(data)\r\n    {\r\n        if (typeof URL === 'function')\r\n        {\r\n            URL.revokeObjectURL(data.src);\r\n        }\r\n    }\r\n};\r\n\r\nmodule.exports = URLObject;","\r\n\r\nconst XHR = {\r\n\r\n    createFileRequest(file, settings) {\r\n        var xhrSettings = XHR.merge(settings, file.xhrSettings);\r\n\r\n        var xmlHttpRequest = new XMLHttpRequest();\r\n        xmlHttpRequest.open(\"GET\", file.source, xhrSettings.async);\r\n\r\n        if (file.xhrSettings.responseType !== undefined)\r\n            xmlHttpRequest.responseType = file.xhrSettings.responseType;\r\n\r\n        xmlHttpRequest.timeout = xhrSettings.timeout;\r\n\r\n        xmlHttpRequest.onload = file.onLoad.bind(file);\r\n        xmlHttpRequest.onerror = file.onError.bind(file);\r\n        xmlHttpRequest.onprogress = file.onProgress.bind(file);\r\n        \r\n        if (file.onReadyStateChange !== undefined)\r\n            xmlHttpRequest.onreadystatechange = file.onReadyStateChange.bind(file);\r\n\r\n        xmlHttpRequest.send();\r\n\r\n        return xmlHttpRequest;\r\n    },\r\n\r\n    createSettings(type, doAsync, timeout) {\r\n        if (type === undefined) \r\n            type = '';\r\n\r\n        if (doAsync === undefined) \r\n            doAsync = true;\r\n\r\n        if (timeout === undefined)\r\n            timeout = 0;\r\n\r\n        var settings = {\r\n            responseType: type,\r\n            timeout: timeout,\r\n            async: doAsync,\r\n        }\r\n\r\n        return settings;\r\n    },\r\n\r\n    merge(a, b) {\r\n        var out = {};\r\n\r\n        if (a === undefined)\r\n            out = XHR.createSettings(); // : Extend(global);\r\n        // else\r\n            // do something cool\r\n\r\n        if (b)\r\n        {\r\n            for (let setting in b)\r\n            {\r\n                if (b[setting] !== undefined)\r\n                    out[setting] = b[setting];\r\n            }\r\n        }\r\n    \r\n        return out;\r\n    }\r\n\r\n};\r\n\r\nexport default XHR;\r\n\r\n","\r\nimport { LOADER_STATE, AssetTypeHandler} from '../LoaderState'\r\nimport File from '../File'\r\nimport URLObject from '../URLObject'\r\nimport ObjectUtils from '../../utils/ObjectUtils'\r\nimport Path from '../../utils/Path'\r\nimport AssetsType from '../AssetsType';\r\n\r\nexport default class ImageFile extends File {\r\n    \r\n\r\n    constructor(tag, url, path, xhrSettings, config)\r\n    {\r\n        var assetTag = null;\r\n        \r\n        if (typeof tag === 'string')\r\n        {\r\n            assetTag = tag;\r\n        }\r\n        else\r\n        {\r\n            assetTag = ObjectUtils.getValue(tag, 'tag', '');\r\n        }\r\n\r\n        var fileConfig = {\r\n            type: AssetsType.image,\r\n            tag: assetTag,\r\n            ext: ObjectUtils.getValue(tag, 'ext', Path.getExtension(url)),\r\n            url: ObjectUtils.getValue(tag, 'file', url),\r\n            path: path,\r\n            responseType: 'blob',\r\n            xhrSettings: ObjectUtils.getValue(tag, 'xhr', xhrSettings),\r\n            config: ObjectUtils.getValue(tag, 'config', config)\r\n        };\r\n\r\n        super(fileConfig);\r\n    }\r\n\r\n    onProcessing(processingCallback)\r\n    {\r\n        this.state = LOADER_STATE.PROCESSING;\r\n        this.data = new Image();\r\n        this.data.crossOrigin = this.crossOrigin;\r\n\r\n\r\n        var self = this;\r\n\r\n        this.data.onload = function () {\r\n\r\n            URLObject.revoke(self.data);\r\n\r\n            self.onDone();\r\n\r\n            processingCallback(self);\r\n        };\r\n\r\n        this.data.onerror = function () {\r\n\r\n            URLObject.revoke(self.data);\r\n\r\n            console.warn(\"Loader.ImageFile: Error on load file: \" + self.url + \".\")\r\n\r\n            self.state = LOADER_STATE.ERROR;\r\n\r\n            processingCallback(self);\r\n\r\n        };\r\n\r\n\r\n        URLObject.create(this.data, this.xhrRequest.response, 'image/' + this.config.ext);\r\n    }\r\n\r\n}\r\n\r\nAssetTypeHandler.register('image', function (tag, url, path, xhrSettings, force)\r\n{\r\n\r\n    this.addAsset(new ImageFile(tag, url, this.path, xhrSettings), force);\r\n\r\n    return this;\r\n\r\n});\r\n\r\nmodule.exports = ImageFile;","import File from \"../File\";\r\nimport ObjectUtils from \"../../utils/ObjectUtils\";\r\nimport { LOADER_STATE, AssetTypeHandler } from \"../LoaderState\";\r\nimport AssetsType from \"../AssetsType\";\r\n\r\nexport default class JSONFile extends File {\r\n\r\n    constructor(tag, url, path, xhrSettings, config) {\r\n\r\n        var config = {\r\n            type: AssetsType.json,\r\n            ext: ObjectUtils.getValue(tag, 'ext', 'json'),\r\n            responseType: 'text',\r\n            tag: tag,\r\n            url: ObjectUtils.getValue(tag, 'file', url),\r\n            path: path,\r\n            xhrSettings: ObjectUtils.getValue(tag, 'xhr', xhrSettings)\r\n        };\r\n\r\n        super(config);\r\n\r\n        if (typeof config.url === 'object') {\r\n            this.data = config.url;\r\n            this.state = LOADER_STATE.DONE;\r\n        }\r\n\r\n    }\r\n\r\n    onProcess(processingCallback) {\r\n        this.state = LOADER_STATE.PROCESSING;\r\n        this.data = JSON.parse(this.xhrLoader.responseText);\r\n        this.onDone();\r\n        callback(this);\r\n    }\r\n\r\n}\r\n\r\nAssetTypeHandler.register('json', function (tag, url, path, xhrSettings) {\r\n    this.addAsset(new JSONFile(tag, url, this.path, xhrSettings));\r\n    return this;\r\n});","\r\nimport { LOADER_STATE, AssetTypeHandler} from '../LoaderState'\r\nimport File from '../File'\r\nimport ObjectUtils from '../../utils/ObjectUtils'\r\nimport Path from '../../utils/Path'\r\nimport AssetsType from '../AssetsType';\r\n\r\nexport default class TextFile extends File {\r\n\r\n    constructor(tag, url, path, xhrSettings, config)\r\n    {\r\n        let assetTag = null;\r\n        \r\n        if (typeof tag === 'string')\r\n        {\r\n            assetTag = tag;\r\n        }\r\n        else\r\n        {\r\n            assetTag = ObjectUtils.getValue(tag, 'tag', '');\r\n        }\r\n\r\n        let useExternal = false;\r\n\r\n        if (path !== undefined)\r\n        {\r\n            if (typeof(path) === \"boolean\")\r\n                useExternal = path;\r\n\r\n            \r\n        }\r\n\r\n        var fileConfig = {\r\n            type: AssetsType.text,\r\n            tag: assetTag,\r\n            ext: ObjectUtils.getValue(tag, 'ext', Path.getExtension(url)),\r\n            url: ObjectUtils.getValue(tag, 'file', url),\r\n            path: path,\r\n            responseType: '',\r\n            xhrSettings: ObjectUtils.getValue(tag, 'xhr', xhrSettings),\r\n            config: ObjectUtils.getValue(tag, 'config', config),\r\n            useExternal : useExternal\r\n        };\r\n\r\n        super(fileConfig);\r\n    }\r\n    \r\n    //onLoad(event) {}\r\n\r\n    /*onReadyStateChange(event)\r\n    {\r\n\r\n        console.log(event.target);\r\n        if (this.xhrRequest.status == 200)\r\n        {\r\n            if (this.xhrRequest.readyState == 4)\r\n            {\r\n                this.state = LOADER_STATE.PROCESSING;\r\n                //this.data = window.URL.createObjectURL(this.xhrRequest.response);\r\n                this.data = this.xhrRequest.responseText;\r\n                \r\n                //console.log(this.data);\r\n                this.onDone();\r\n\r\n                //processingCallback(this);\r\n                super.onLoad(event);\r\n            }  \r\n        } else {\r\n            super.onLoad(event);\r\n        }\r\n    }*/\r\n\r\n    onProcessing(processingCallback)\r\n    {\r\n        this.state = LOADER_STATE.PROCESSING;\r\n            //this.data = window.URL.createObjectURL(this.xhrRequest.response);\r\n            this.data = this.xhrRequest.responseText;\r\n            /*var style = document.createElement('style');\r\n            style.innerHTML = this.data;\r\n            document.head.appendChild(style)*/\r\n           // console.log(\"data:\" + this.data);\r\n            this.onDone();\r\n\r\n            processingCallback(this);\r\n    }\r\n\r\n}\r\n\r\nAssetTypeHandler.register('text', function (tag, url, path, xhrSettings)\r\n{\r\n    let endPointPath = this.path;\r\n\r\n    if (path !== undefined)\r\n    {\r\n        \r\n        if (typeof(path) === \"boolean\") // external link\r\n            endPointPath = path;\r\n        \r\n    }\r\n\r\n    this.addAsset(new TextFile(tag, url, endPointPath, xhrSettings));\r\n\r\n    return this;\r\n\r\n});\r\n\r\nmodule.exports = TextFile;","import File from '../File'\r\nimport JSONFile from './JSONFile';\r\nimport { AssetTypeHandler, LOADER_STATE } from '../LoaderState';\r\nimport Path from '../../utils/Path';\r\nimport AssetsType from '../AssetsType';\r\n\r\n\r\nfunction CheckImagesSources(loader, source, fullPath) {\r\n\r\n    if (source === undefined)\r\n        return;\r\n\r\n      \r\n\r\n    let size = source.length;\r\n\r\n   \r\n\r\n    if (size <= 0)\r\n        return;\r\n\r\n    for (let i = 0; i < size; i++) {\r\n\r\n        let tileset = source[i];\r\n\r\n        if (tileset.image) {\r\n            let name = Path.getFilenameWithoutExtension(tileset.image) || tileset.name;\r\n            let path = Path.getPathWithoutRoot(fullPath).concat(Path.getFilename(tileset.image));\r\n            loader.image(name, path, undefined, undefined, false);\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport default class TilemapFileJSON extends JSONFile {\r\n\r\n    constructor(tag, url, path, xhrSettings) {\r\n\r\n        super(tag, url, path, xhrSettings);\r\n        this.type = AssetsType.tilemapJSON;\r\n\r\n    }\r\n\r\n    onPostLoad(loader, xhrLoader) {\r\n\r\n        this.state = LOADER_STATE.PROCESSING;\r\n        this.data = JSON.parse(xhrLoader.responseText);\r\n\r\n        // check tileset images and pipe to the loader\r\n        CheckImagesSources(loader, this.data.tilesets, this.url);\r\n    }\r\n\r\n    onProcess(processingCallback) {\r\n        this.onDone();\r\n        callback(this);\r\n    }\r\n\r\n\r\n}\r\n\r\nAssetTypeHandler.register('tilemapJSON', function (tag, url, path, xhrSettings) {\r\n    this.addAsset(new TilemapFileJSON(tag, url, this.path, xhrSettings));\r\n    return this;\r\n});","\r\nmodule.exports = {\r\n    ImageFile : require('./ImageFile'),\r\n    TextFile : require('./TextFile'),\r\n    JSONFile : require('./JSONFile'),\r\n    TilemapJSON : require('./TilemapJSON')\r\n}","\r\nmodule.exports = {\r\n\r\n    File: require('./File'),\r\n    XHR: require('./XHR'),\r\n    URLObject : require('./URLObject'),\r\n    AssetsType : require('./AssetsType'),\r\n    Assets: require('./assets'),\r\n    LoaderState: require('./LoaderState'),    \r\n    LoaderManager: require('./LoaderManager'),\r\n\r\n};","\r\nimport Vector from './Vector'\r\nimport Rect from './Rect'\r\n\r\nexport default class BoundingBox {\r\n  \r\n  constructor(x, y, width, height) {\r\n\r\n    x = x || Infinity;\r\n    y = y || Infinity;\r\n    width = width || -Infinity;\r\n    height = height || -Infinity;\r\n    this.min = new Vector(x,y);\r\n    this.max = new Vector(x+width,y+height);\r\n    //this.box = new Rect(xx,yy,w,h);\r\n\r\n  }\r\n\r\n  \r\n  get center() {\r\n    return new Vector(\r\n      (this.max.x - this.min.x) / 2,\r\n      (this.max.y - this.min.y) / 2\r\n    );\r\n  }\r\n\r\n  get size() {\r\n    return new Vector(\r\n      (this.max.x - this.min.x),\r\n      (this.max.y - this.min.y)\r\n    );\r\n  }\r\n\r\n  \r\n  set(minX, minY, maxX, maxY) {\r\n\r\n    this.min.set(minX,minY);\r\n    this.max.set(maxX,maxY);\r\n    //this.box.set(this.min.x,this.min.y,this.max.x-this.min.x,this.max.y-this.min.y);\r\n    return this;\r\n\r\n  }\r\n\r\n  setMin(minX, minY) {\r\n    this.min.x = minX;\r\n    this.min.y = minY;\r\n    return this;\r\n  }\r\n\r\n  setMax(maxX, maxY) {\r\n    this.max.x = maxX;\r\n    this.max.y = maxY;\r\n    return this;\r\n  }\r\n\r\n  move(x, y) {\r\n    this.min.x += x;\r\n    this.min.y += y;\r\n    this.max.x += x;\r\n    this.max.y += y;\r\n  }\r\n\r\n  intersects(bounds) {\r\n    return (\r\n      (this.max.x >= bounds.min.x && \r\n      this.max.y >= bounds.min.y &&\r\n      this.min.x <= bounds.max.x && \r\n      this.min.y <= bounds.max.y) ||\r\n\r\n      (this.min.x >= bounds.max.x &&\r\n      this.min.y >= bounds.max.y &&\r\n      this.max.x <= bounds.min.x &&\r\n      this.max.y <= bounds.min.y));\r\n  }\r\n\r\n  contains(x, y) {\r\n    return (\r\n      x > this.min.x &&\r\n      y > this.min.y &&\r\n      x < this.max.x &&\r\n      y < this.max.y);\r\n  }\r\n\r\n  expand(xRadius, yRadius) {\r\n\r\n    yRadius = yRadius || xRadius;\r\n\r\n    if (this.max.x > this.min.x)\r\n\t\t{\r\n\t\t\tthis.min.x -= xRadius;\r\n\t\t\tthis.max.x += xRadius;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.min.x += xRadius;\r\n\t\t\tthis.max.x -= xRadius;\r\n\t\t}\r\n\r\n\t\tif (this.max.y > this.min.y)\r\n\t\t{\r\n\t\t\tthis.min.y -= yRadius;\r\n\t\t\tthis.max.y += yRadius;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.min.y += yRadius;\r\n\t\t\tthis.max.y -= yRadius;\r\n\t\t}\r\n  }\r\n\r\n  merge(value) {\r\n\r\n    // merge with another bounds\r\n    if (value instanceof BoundingBox) {\r\n      this.min.x = Math.min(this.min.x, value.min.x);\r\n      this.min.y = Math.min(this.min.y, value.min.y);\r\n      this.max.x = Math.max(this.max.x, value.max.x);\r\n      this.max.y = Math.max(this.max.y, value.max.y);\r\n      return this;\r\n    } \r\n    else if (value instanceof Vector) {\r\n      return this.mergeWithPoint(value.x, value.y);\r\n    } else {\r\n      this.min.x = Math.min(this.min.x, value);\r\n      this.min.y = Math.min(this.min.y, value);\r\n      this.max.x = Math.max(this.max.x, value);\r\n      this.max.y = Math.max(this.max.y, value);\r\n      return this;\r\n    }\r\n  }\r\n\r\n  mergeWithPoint(x, y) {\r\n    this.min.x = Math.min(this.min.x, x);\r\n    this.min.y = Math.min(this.min.y, y);\r\n    this.max.x = Math.max(this.max.x, x);\r\n    this.max.y = Math.max(this.max.y, y);\r\n    return this;\r\n  }\r\n\r\n  extend(bounds) {\r\n    // min merge\r\n    if (bounds.min.x < this.min.x)\r\n      this.min.x = bounds.min.x;\r\n\r\n    if (bounds.min.y < this.min.y)\r\n      this.min.y = bounds.min.y;\r\n      \r\n    // max merge\r\n    if (bounds.max.x > this.max.x)\r\n      this.max.x = bounds.max.x;\r\n\r\n    if (bounds.max.y > this.max.y)\r\n      this.max.y = bounds.max.y;\r\n\r\n    return this;\r\n  }\r\n\r\n  extendByPoint(x, y) {\r\n    if (x < this.min.x) this.min.x = x;\r\n\t\tif (y < this.min.y) this.min.y = y;\r\n\t\tif (x > this.max.x) this.max.x = x;\r\n\t\tif (y > this.max.y) this.max.y = y;\r\n\r\n\t\treturn this;\r\n  }\r\n\r\n  limit(xmin, ymin, xmax, ymax) {\r\n\t\tif (this.min.x < xmin)\r\n      this.min.x = xmin;\r\n\r\n\t\tif (this.min.y < ymin)\r\n      this.min.y = ymin;\r\n\r\n\t\tif (this.max.x > xmax)\r\n      this.max.x = xmax;\r\n\r\n\t\tif (this.max.y > ymax)\r\n      this.max.y = ymax;\r\n  }\r\n\r\n  offset(x, y) {\r\n    let o = {x:x, y:y};\r\n     o.x -= this.min.x;\r\n     o.y -= this.min.y;\r\n\r\n\t\tif (this.max.x > this.min.x)\r\n\t\t\to.x /= this.max.x - this.min.x;\r\n\r\n\t\tif (this.max.y > this.min.y)\r\n      o.y /= this.max.y - this.min.y;\r\n      \r\n    return o;\r\n  }\r\n\r\n  toString() {\r\n    return \"{ min: \" + this.min.toString() + \", max: \" + this.max.toString() + \" }\";\r\n  }\r\n\r\n  \r\n\r\n}\r\n","\r\n\r\n\r\n\r\nconst MathUtils = {\r\n\r\n\r\n  degToRad : Math.PI / 180,\r\n  radToDeg : 180 / Math.PI,\r\n  TAU : Math.PI * 2,\r\n  //HALFPI : Math.PI / 2,\r\n  EPSILON : Math.pow(2, -52),\r\n  HALFPI : 1.5707963267948966,\r\n\r\n  round : function(value) {\r\n\r\n      // With a bitwise or.\r\n      //let rounded = (0.5 + value) | 0;\r\n      \r\n      // FASTEST - A double bitwise not.\r\n      return ~~ (0.5 + value);\r\n\r\n      // Finally, a left bitwise shift.\r\n      //rounded = (0.5 + value) << 0;\r\n\r\n  },\r\n\r\n  clamp : function(value, min, max) {\r\n    return (value > min) ? (value < max) ? value : max : min;\r\n  },\r\n\r\n  randomRange : function(min, max) {\r\n\r\n    return Math.random() * (max - min) + min;\r\n\r\n  },\r\n\r\n  irandomRange : function(min, max) {\r\n\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n\r\n  },\r\n\r\n  lerp : function(fromValue,toValue,t) {\r\n\r\n    return (1.0-t) * fromValue + t * toValue;\r\n\r\n  },\r\n\r\n  lerpAngle : function(fromValue,toValue,t) {\r\n\r\n    /*var shortest_angle = ((((toValue - fromValue) % 360) + 540) % 360) - 180;\r\n    return shortest_angle * t;*/\r\n\r\n    var end = toValue;\r\n    var start = fromValue;\r\n\r\n    var difference = Math.abs(end - start);\r\n    if (difference > 180)\r\n    {\r\n        // We need to add on to one of the values.\r\n        if (end > start)\r\n        {\r\n            // We'll add it on to start...\r\n            start += 360;\r\n        }\r\n        else\r\n        {\r\n            // Add it on to end.\r\n            end += 360;\r\n        }\r\n    }\r\n\r\n          // Interpolate it.\r\n        var value = (start + ((end - start) * t));\r\n\r\n          // Wrap it..\r\n          var rangeZero = 360;\r\n\r\n          if (value >= 0 && value <= 360)\r\n              return value;\r\n\r\n          return (value % rangeZero);\r\n\r\n\r\n  },\r\n\r\n  distance : function(x0,y0,x1,y1) {\r\n\r\n    return Math.sqrt((x0 -= x1) * x0 + (y0 -= y1) * y0);\r\n\r\n  },\r\n\r\n  angleBetween : function(x0,y0,x1,y1) {\r\n\r\n    var angle = this.toDegree(Math.atan2(y1 - y0, x1 - x0));\r\n\r\n    if (angle < 0 && angle >= -180)\r\n      angle = 360 + angle;\r\n\r\n\r\n    return angle;\r\n\r\n  },\r\n\r\n  toDegree : function(radians) {\r\n\r\n    return radians * tobiJS.Math.radToDeg;\r\n\r\n  },\r\n\r\n  toRadian : function(degrees) {\r\n\r\n    return degrees * tobiJS.Math.degToRad;\r\n\r\n  }\r\n\r\n}\r\n\r\nexport default MathUtils;\r\n\r\n\r\n","\r\n/*\r\n\r\n\r\n* | a | b | x | * | 0 | 2 | 4 |\r\n* | c | d | y | * | 1 | 3 | 5 |\r\n* | 0 | 0 | 1 |\r\n\r\n* | 0 | 3 | 6 | * | a | c | x |\r\n* | 1 | 4 | 7 | * | b | d | y |\r\n* | 2 | 5 | 8 | * | 0 | 0 | 1 |\r\n\r\na = scale_x\r\nb = cos\r\nx = x translate\r\n\r\nc = scale_y\r\nd = sin\r\ny = y translate\r\n\r\nHTML5/CSS3 uses matrices in column-major order based.\r\n\r\n*/\r\n\r\nclass Matrix {\r\n  \r\n  /*\r\n  * Constructor is identity only\r\n  */\r\n  constructor(a, b) {\r\n\r\n    /*a = a || i;\r\n    b = b || 0;\r\n    x = x || 0;\r\n\r\n    c = c || 0;   \r\n    d = d || i;   \r\n    y = y || 0;*/\r\n\r\n    a = a || 0;\r\n    b = b || 0;\r\n\r\n    this.a = [];\r\n\r\n    // first column\r\n    this.a[0] = a;\r\n    this.a[1] = b;\r\n    this.a[2] = b;\r\n    // second column\r\n    this.a[3] = b;\r\n    this.a[4] = a;\r\n    this.a[5] = b;\r\n    // third column\r\n    this.a[6] = b; \r\n    this.a[7] = b;\r\n    this.a[8] = a;\r\n    //this.at = null;\r\n\r\n  }\r\n\r\n  at(i, j) {\r\n    return this.a[i + j * 3];\r\n  }\r\n\r\n  set(i, j, value) {\r\n    this.a[i + j * 3] = value;\r\n    return this;\r\n  }\r\n\r\n  setIdentity() {\r\n    return this.setTransform(\r\n      1,0,0,\r\n      0,1,0,\r\n      0,0,1\r\n    );\r\n  }\r\n\r\n  setTransform(a, b, c, d, e, f, g, h, i) {\r\n\r\n    this.a[0] = a;\r\n    this.a[1] = b;\r\n    this.a[2] = c; // 0\r\n\r\n    this.a[3] = d;\r\n    this.a[4] = e;\r\n    this.a[5] = f; // 0\r\n\r\n    this.a[6] = g; // x\r\n    this.a[7] = h; // y\r\n    this.a[8] = i;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  translate(x, y) {\r\n\r\n\r\n  /* | a | b | x | * | 0 | 2 | 4 |\r\n  *  | c | d | y | * | 1 | 3 | 5 |\r\n\r\n  * | 0 | 3 | 6 | * | a | c | x |\r\n  * | 1 | 4 | 7 | * | b | d | y |\r\n  * | 2 | 5 | 8 |\r\n  */\r\n    // 4 = 0 * x * 2 * y + 4\r\n    // 5 = 1 * x * 3 * y + 5\r\n\r\n    // 6 = 1 * x + 3 * y + 5\r\n    // 7 = 1 * x + 4 * y + 7\r\n    this.a[6] = this.a[0] * x + this.a[3] * y + this.a[6];\r\n    this.a[7] = this.a[1] * x + this.a[4] * y + this.a[7];\r\n    return this;\r\n  }\r\n\r\n  scale(x, y) {\r\n\r\n    this.a[0] *= x; // a\r\n    this.a[1] *= x; // b\r\n\r\n    this.a[3] *= y; // c\r\n    this.a[4] *= y; // d\r\n\r\n    this.a[6] *= x; // x\r\n    this.a[7] *= y; // y\r\n    return this;\r\n\r\n  }\r\n\r\n  rotate(radianAngle) {\r\n    let cos = Math.cos(radianAngle);\r\n    let sin = Math.sin(radianAngle);\r\n\r\n    return this.radianRotate(cos, sin);\r\n }\r\n\r\n radianRotate(cos, sin) {\r\n return this.transform(cos, sin, -sin, cos, 0, 0);\r\n }\r\n\r\n transform(a, b, c, d, x, y) {\r\n  let a00 = this.a[0]; // a\r\n  let a01 = this.a[1]; // b\r\n\r\n  let a10 = this.a[3]; // c\r\n  let a11 = this.a[4]; // d\r\n\r\n  let a20 = this.a[6]; // x\r\n  let a21 = this.a[7]; // y\r\n\r\n  this.a[0] = a * a00 + b * a10; // a * a0 + b * c0;\r\n  this.a[1] = a * a01 + b * a11; // a * b0 + b * d0;\r\n\r\n  this.a[3] = c * a00 + d * a10; // c * a0 + d * c0;\r\n  this.a[4] = c * a01 + d * a11; // c * b0 + d * d0;\r\n\r\n  this.a[6] = x * a00 + y * a10 + a20; // x * a0 + y * c0 + x0;\r\n  this.a[7] = x * a01 + y * a11 + a21; // x * b0 + y * d0 + y0;\r\n\r\n  return this;\r\n }  \r\n\r\n setModelMatrix(position, scale, rotation, origin) {\r\n    this.a[0] = rotation.x * scale.x; // a\r\n    this.a[1] = rotation.y * scale.x; // b\r\n    this.a[3] = -rotation.y * scale.y; // c\r\n    this.a[4] =  rotation.x * scale.y; // d\r\n    this.a[6] = position.x; // x\r\n    this.a[7] = position.y; // y\r\n\r\n    /*if (origin !== undefined) {\r\n      this.a[6] -= origin.x * this.a[0] + origin.y * this.a[3];\r\n      this.a[7] -= origin.y * this.a[1] + origin.y * this.a[4];\r\n    }*/\r\n\r\n    return this;\r\n    /*\r\n    a  =  transform._cosSin.x * transform.scale.x;\r\n    b  = transform._cosSin.y * transform.scale.x;\r\n    c  = -transform._cosSin.y * transform.scale.y;\r\n    d  =  transform._cosSin.x * transform.scale.y;\r\n    x =  transform.position.x;\r\n    y =  transform.position.y;\r\n\r\n    x -= transform.origin.x * a + transform.origin.y * c;\r\n    y -= transform.origin.y * b + transform.origin.y * d;\r\n    */\r\n\r\n    \r\n }\r\n\r\n\r\n multiply(other) {\r\n\r\n    // faster way\r\n    let a00 = this.a[0]; // a - 0\r\n    let a01 = this.a[1]; // b - 1\r\n    let a10 = this.a[3]; // c - 3\r\n    let a11 = this.a[4]; // d - 4\r\n    let a20 = this.a[6]; // x - 6\r\n    let a21 = this.a[7]; // y - 7\r\n\r\n    this.a[0] = other.a[0] * a00 + other.a[1] * a10; // a1 * a0 + b1 * c0;\r\n    this.a[1] = other.a[0] * a01 + other.a[1] * a11; // a1 * b0 + b1 * d0;\r\n\r\n    this.a[3] = other.a[3] * a00 + other.a[4] * a10; // c1 * a0 + d1 * c0;\r\n    this.a[4] = other.a[3] * a01 + other.a[4] * a11; // c1 * b0 + d1 * d0;\r\n\r\n    this.a[6] = other.a[6] * a00 + other.a[7] * a10 + a20; // x1 * a0 + y1 * c0 + x0;\r\n    this.a[7] = other.a[6] * a01 + other.a[7] * a11 + a21; // x1 * b0 + y1 * d0 + y0;\r\n\r\n    return this;\r\n }\r\n\r\n concat(other) {\r\n\r\n  let a = this.a[0]; // a - 0\r\n  let b = this.a[1]; // b - 1\r\n  let c = this.a[3]; // c - 3\r\n  let d = this.a[4]; // d - 4\r\n  let x = this.a[6]; // x - 6\r\n  let y = this.a[7]; // y - 7\r\n\r\n  this.a[0] = a * other.a[0] + b * other.a[3]; // a * pt.a + b * pt.c;\r\n  this.a[1] = a * other.a[1] + b * other.a[4]; // a * pt.b + b * pt.d;\r\n\r\n  this.a[3] = c * other.a[0] + d * other.a[3]; // c * pt.a + d * pt.c;\r\n  this.a[4] = c * other.a[1] + d * other.a[4]; // c * pt.b + d * pt.d;\r\n\r\n  this.a[6] = x * other.a[0] + y * other.a[3] + other.a[6]; // x * pt.a + y * pt.c + pt.x;\r\n  this.a[7] = x * other.a[1] + y * other.a[4] + other.a[7]; // x * pt.b + y * pt.d + pt.y;\r\n\r\n  return this;\r\n }\r\n\r\n transformPoint(x, y) {\r\n\r\n  let point = {x:0,y:0}\r\n\r\n  point.x = x * this.a[0] + y * this.a[3] + this.a[6];\r\n  point.y = x * this.a[1] + y * this.a[4] + this.a[7];\r\n\r\n  return point;\r\n}\r\n\r\n transpose() {\r\n  return this.setAll(\r\n    mat.a[0], mat.a[3], mat.a[6],\r\n    mat.a[1], mat.a[4], mat.a[7],\r\n    mat.a[2], mat.a[5], mat.a[8],\r\n  );\r\n }\r\n\r\n toString() {\r\n  let str = \"\";\r\n   for(let y = 0; y < 3; y++) {\r\n      for(let x = 0; x < 3; x++) {\r\n        let val = this.at(x, y); \r\n        //str += val.toString() + \" \";\r\n        //console.log(\"---- \" + (x + y * 3).toString());\r\n        str += val + \" \";\r\n      }\r\n      str += \"\\n\"\r\n   }\r\n\r\n   return str;\r\n    \r\n }\r\n \r\n \r\n static identity() { return new Matrix(1); }\r\n\r\n static zero() { return new Matrix(0); }\r\n\r\n static transpose(mat) {\r\n  let copy = Matrix.zero;\r\n  return copy.setAll(\r\n    mat.a[0], mat.a[3], mat.a[6],\r\n    mat.a[1], mat.a[4], mat.a[7],\r\n    mat.a[2], mat.a[5], mat.a[8],\r\n  );\r\n\r\n }\r\n\r\n static multiplySlow(a, b) {\r\n    var mat = Matrix.zero(); // zeroes\r\n    let val;\r\n\r\n    for (let i = 0; i < 3; ++i)\r\n    {\r\n      for (let j = 0; j < 3; ++j)\r\n      {\r\n        for (let k = 0; k < 3; ++k)\r\n        {\r\n          val = mat.at(i, k);\r\n          val += a.at(i, j) * b.at(j, k);\r\n          mat.set(i, k, val);\r\n        }\r\n      }\r\n    }\r\n\r\n    return mat;\r\n }\r\n\r\n}\r\n\r\nmodule.exports = Matrix;","\r\n/**\r\n* Simple class for rectangle. Usage for collision.\r\n* @class Rect\r\n* @constructor\r\n*/\r\n\r\nexport default class Rect {\r\n  \r\n  constructor(x, y, width, height) {\r\n    this.x = x || 0;\r\n    this.y = y || 0;\r\n    this.width = width || 0;\r\n    this.height = height || 0;\r\n  }\r\n\r\n  get center() {\r\n    var vec = {};\r\n    vec.x = this.x + this.width / 2;\r\n    vec.y = this.y + this.height / 2;\r\n    return vec;\r\n  }\r\n\r\n  set(x,y,width,height) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.width = width;\r\n    this.height = height;\r\n    return this;\r\n  }\r\n\r\n  setPostion(x,y) {\r\n    this.x = x;\r\n    this.y = y;\r\n    return this;\r\n  }\r\n\r\n  setSize(width, height) {\r\n    this.width = width;\r\n    this.height = height;\r\n    return this;\r\n  }\r\n\r\n  \r\n  intersects(rect) {\r\n    return Rect.intersects(this, rect);\r\n  }\r\n\r\n  contains(x,y) {\r\n  return Rect.contains(this,x,y);\r\n  }\r\n\r\n\r\n  static intersects(rect1, rect2) {\r\n\r\n    if (rect1.width <= 0 || rect1.height <= 0 || rect2.width <= 0 || rect2.height <= 0)\r\n      return false;\r\n  \r\n    return    !(rect1.x > rect2.x + rect2.width ||\r\n               rect1.x + rect1.width < rect2.x ||\r\n               rect1.y > rect2.y + rect2.height ||\r\n               rect1.y + rect1.height < rect2.y);\r\n  }\r\n\r\n  static contains(rect, x, y) {\r\n  \r\n    if (rect.width <= 0 && rect.height <= 0 )\r\n      return false;\r\n  \r\n    return (x > rect.x &&\r\n            x < rect.x + rect.width &&\r\n            y >= rect.y &&\r\n            y < rect.y + rect.height);\r\n  \r\n  }\r\n  \r\n  static intersectionArea(rect1,rect2) {\r\n  \r\n      var out = new scintilla.Rect();\r\n  \r\n      if (scintilla.Rect.intersects(rect1,rect2)) {\r\n  \r\n         out.y = Math.max(a.y, b.y);\r\n         out.x = Math.max(a.x, b.x);\r\n         out.width = Math.min(a.x + a.width, b.x + b.width) - out.x;\r\n         out.height = Math.min(a.y + a.height, b.y + b.height) - out.y;\r\n  \r\n      }\r\n  \r\n      return out;\r\n  \r\n  }\r\n  \r\n\r\n}\r\n\r\n\r\n\r\n","\r\n\r\nimport MathUtils from './MathUtils'\r\n\r\n/**\r\n* Class for points and vectors.\r\n* @class Vector\r\n* @constructor\r\n*/\r\nexport default class Vector {\r\n  \r\n  constructor(x,y, managed) {\r\n\r\n    this.x = x || 0;\r\n    this.y = y || 0;\r\n    this.managed = managed || undefined;\r\n  }\r\n\r\n  /*\r\n  set x(value) {\r\n    this.x = value;\r\n    return this.x;\r\n  }\r\n  get x() {return this.x;}\r\n  set y(value) {\r\n    this.y = value;\r\n    return this.y;\r\n  }\r\n  get y() {return this.y;}*/\r\n\r\n  set(x,y) {\r\n\r\n    this.x = x;\r\n    this.y = y || x\r\n\r\n    if (this.managed !== undefined)\r\n      this.managed.markDirty();\r\n\r\n    return this;\r\n  }\r\n\r\n  move(x,y) {\r\n\r\n    this.x += x;\r\n    this.y += y;\r\n\r\n    if (this.managed !== undefined)\r\n      this.managed.markDirty();\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  scale(x, y) {\r\n\r\n    this.x *= x;\r\n    this.y *= y || x;\r\n\r\n    if (this.managed !== undefined)\r\n      this.managed.markDirty();\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  rotate(radians) {\r\n\r\n    let x = this.x;\r\n    let y = this.y;\r\n    this.x = x * Math.cos(radians) - y * Math.sin(radians);\r\n    this.y = x * Math.sin(radians) + y * Math.cos(radians);\r\n\r\n    if (this.managed !== undefined)\r\n      this.managed.markDirty();\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  rotateAround(radians, other) {\r\n\r\n    /*var x = this.x;\r\n    var y = this.y;*/\r\n    let dx = this.x-other.x;\r\n    let dy = this.y-other.y;\r\n\r\n    let c = Math.cos(radians);\r\n    let s = Math.sin(radians);\r\n\r\n    /*this.x = c * (x-other.x) - s * (y-other.y) + other.x;\r\n    this.y = s * (x-other.x) + c * (y-other.y) + other.y;*/\r\n\r\n\r\n    this.x =  other.x + (c * dx - s * dy);\r\n    this.y =  other.y + (s * dx + c * dy);\r\n\r\n    if (this.managed !== undefined)\r\n      this.managed.markDirty();\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  copy(otherVector) {\r\n\r\n    this.x = otherVector.x;\r\n    this.y = otherVector.y;\r\n\r\n    if (this.managed !== undefined)\r\n      this.managed.markDirty();\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  normalize() {\r\n\r\n    let mag = this.length();\r\n    if (mag > 0) {\r\n      this.x = this.x / mag;\r\n      this.y = this.y / mag;\r\n    }\r\n\r\n    if (this.managed !== undefined)\r\n      this.managed.markDirty();\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  round() {\r\n    this.x = MathUtils.round(this.x);\r\n    this.y = MathUtils.round(this.y);\r\n    return this;\r\n  }\r\n\r\n  reverse() {\r\n    this.x = -this.x;\r\n    this.y = -this.y;\r\n\r\n    if (this.managed !== undefined)\r\n      this.managed.markDirty();\r\n\r\n    return this;\r\n  }\r\n\r\n  add(other) {\r\n    this.x += other.x;\r\n    this.y += other.y;\r\n\r\n    if (this.managed !== undefined)\r\n      this.managed.markDirty();\r\n\r\n    return this;\r\n  }\r\n\r\n  sub(other) {\r\n    this.x -= other.x;\r\n    this.y -= other.y;\r\n\r\n    if (this.managed !== undefined)\r\n      this.managed.markDirty();\r\n\r\n    return this;\r\n  }\r\n\r\n  perp() {\r\n\r\n    let x = this.x;\r\n    this.x = this.y;\r\n    this.y = -x;\r\n\r\n    if (this.managed !== undefined)\r\n      this.managed.markDirty();\r\n\r\n    return this;\r\n  }\r\n\r\n  \r\n\r\n  dot(other) {\r\n    return Vector.dot(this,other);\r\n  }\r\n\r\n  project(other) {\r\n    return Vector.project(this,other);\r\n  }\r\n\r\n  clone() {\r\n    return new Vector(this.x,this.y);\r\n  }\r\n\r\n  length() {\r\n    return Math.sqrt(this.squaredLenght());\r\n  }\r\n\r\n  toString() {\r\n    return \"{ x: \" + this.x + \", y: \" + this.y + \" }\"\r\n  }\r\n\r\n  squaredLenght() {\r\n    return Vector.dot(this,this);\r\n  }\r\n\r\n  static abs(vector) {\r\n    return new Vector(Math.abs(vector.x), Math.abs(vector.y));\r\n  }\r\n\r\n  static scalar(a, b) {\r\n    return a.x * b.y - a.y * b.x;\r\n  }\r\n\r\n  static distance(a, b) {\r\n    return MathUtils.distance(a.x,a.y,b.x,b.y);\r\n  }\r\n\r\n  static angleBetween(a, b) {\r\n    return MathUtils.angleBetween(a.x,a.y,b.x,b.y);\r\n  }\r\n\r\n  static dot(a, b) {\r\n    return (a.x * b.x) + (a.y * b.y);\r\n  }\r\n\r\n  static project(a,b) {\r\n    let dp = Vector.dot(a,b);\r\n    var proj = new Vector(\r\n      ( dp / (b.x*b.x + b.y*b.y) ) * b.x,\r\n      ( dp / (b.x*b.x + b.y*b.y) ) * b.y\r\n    );\r\n    return proj;\r\n  };\r\n\r\n  // project for unit vector\r\n  static projectNormal(a,b) {\r\n    let dp = Vector.dot(a,b);\r\n    let proj = new Vector(   dp / b.x,   dp / b.y );\r\n    return proj;\r\n  };\r\n\r\n  static reflect(vec,axis) {\r\n\r\n    let r = Vector.project(vec,axis);\r\n    r.scale(2);\r\n    r.sub(vec);\r\n    return r;\r\n\r\n  };\r\n\r\n  static reflectNormal(vec,axis) {\r\n\r\n    let r = Vector.projectNormal(vec,axis);\r\n    r.scale(2);\r\n    r.sub(vec);\r\n    return r;\r\n\r\n  };\r\n\r\n\r\n  static lerp(a, b, t) {\r\n    let vec = new Vector(\r\n      MathUtils.lerp(a.x,b.x,t),\r\n      MathUtils.lerp(a.y,b.y,t)\r\n    );\r\n    return vec;\r\n  }\r\n\r\n  get magnitude() {return Math.sqrt((this.x * this.x) + (this.y * this.y));}\r\n  get normal() {\r\n    let mag = this.magnitude;\r\n    let vec = new tobiJS.Vector(this.x / mag,this.y / mag);\r\n    return vec;\r\n  }\r\n\r\n}\r\n\r\nmodule.exports = Vector;","\r\nexport default class Module\r\n{\r\n    constructor(moduleType, moduleName, moduleManager)\r\n    {\r\n        this._moduleType = moduleType || \"none\";\r\n        this._moduleName = moduleName || \"noName\";\r\n        this._enabled = true;\r\n        this.entity = null;\r\n        this.moduleManager = moduleManager || undefined;\r\n\r\n        if (moduleManager !== undefined)\r\n        {\r\n            this.entity = moduleManager.entity;\r\n        }\r\n        //this.game = moduleManager.game || null;\r\n    }\r\n\r\n\r\n    get type() {return this._moduleType;}\r\n    get name() {return this._moduleName;}\r\n    get enabled() {return this._enabled;}\r\n    set enabled(value) {\r\n        value = !!value;\r\n\r\n        if (value !== this._enabled)\r\n        {\r\n            this._enabled = value;\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = Module;","import ModuleProvider from \"./ModuleProvider\";\r\n\r\n\r\nexport default class ModuleAttacher\r\n{\r\n    constructor(moduleManager) {\r\n        this.moduleManager = moduleManager;\r\n    }\r\n\r\n    sprite(tag) {\r\n        return ModuleProvider.attach(this.moduleManager, 'sprite', tag);\r\n    }\r\n\r\n    tilemap(tag) {\r\n\r\n        if (tag === undefined || tag == null)\r\n            throw new Error(\"ModuleAttacher.tilemap: Can not create Tilemap module without a proper tag name.\");\r\n\r\n        return ModuleProvider.attach(this.moduleManager, 'tilemap', tag);\r\n    }\r\n}","\r\nimport DataMap from '../structures/Map'\r\nimport DataList from '../structures/List'\r\nimport ModuleAttacher from './ModuleAttacher'\r\n\r\n\r\nexport default class ModuleManager\r\n{\r\n    constructor(entity)\r\n    {\r\n        this.entity = entity || null;\r\n        this.attached = new DataMap();\r\n        this._pendingModulesInitialization = new DataList();\r\n        this.attach = new ModuleAttacher(this);\r\n    }\r\n\r\n    detach(moduleName, index)\r\n    {\r\n        \r\n    }\r\n\r\n    has(moduleName) {\r\n        return this.attached.has(moduleName);\r\n    }\r\n\r\n    get(moduleName) {\r\n        return this.attached.get(moduleName);\r\n    }\r\n\r\n} ","\r\n\r\nimport DataMap from '../structures/Map'\r\nimport InitializeModuleBase from './components/InitializeModuleBase';\r\n\r\n\r\nclass ModuleProviderManager\r\n{\r\n    constructor()\r\n    {\r\n        this.proxyModules = new DataMap();\r\n    }\r\n\r\n    attach(modulesManager, moduleName, args)\r\n    {\r\n        let attached = modulesManager.attached;\r\n\r\n        if (attached.has(moduleName))\r\n            throw new Error('ModuleManager.attach: Could not attach module ' + moduleName + '. Already exists');\r\n\r\n        if (!this.proxyModules.has(moduleName))\r\n            throw new Error('ModuleManager.attach: Module type ' + moduleName + ' don\\'t exists.');\r\n\r\n        // create a new module\r\n        let newModule = this.proxyModules.get(moduleName)(modulesManager, args);\r\n\r\n        // initialize entity module\r\n        InitializeModuleBase(newModule, modulesManager.entity);\r\n\r\n        // attach the new module to manager\r\n        attached.set(newModule.type, newModule);\r\n\r\n        // add to pending initialization list\r\n        modulesManager._pendingModulesInitialization.push(newModule);\r\n\r\n        return newModule;\r\n    }\r\n\r\n    register(moduleName, func)\r\n    {\r\n        if (!ModuleProvider.proxyModules.has(moduleName))\r\n        ModuleProvider.proxyModules.set(moduleName, func); // { type: moduleType, func: func }\r\n        \r\n    }    \r\n}\r\n\r\nvar ModuleProvider = new ModuleProviderManager();\r\n\r\nexport default ModuleProvider;","import Renderable from \"../renderables/Renderable\";\r\nimport Tilemap from \"../renderables/Tilemap\";\r\nimport Sprite from \"../renderables/Sprite\";\r\n\r\nexport default function AttachModuleInGame(entityModule, modulesManager, game) {\r\n \r\n    // RENDERABLES\r\n    if (entityModule instanceof Sprite) \r\n    {\r\n        game.system.render.layer.renderLayers.at(0).add(entityModule);\r\n    } \r\n    else if (entityModule instanceof Tilemap) {\r\n        for (let i = 0; i < entityModule.layers.length; i++) {\r\n            game.system.render.layer.renderLayers.at(0).add(entityModule.layers[i]);\r\n        \r\n    }\r\n\r\n       \r\n    }\r\n\r\n}","\r\nexport default function InitializeModuleBase(entityModule, instace) {\r\n\r\n    entityModule.entity = instace;\r\n    entityModule.moduleManager = instace.modules;\r\n\r\n}","import InitializeModuleBase from \"./InitializeModuleBase\";\r\nimport UpdateRenderable from \"../renderables/components/UpdateRenderable\";\r\nimport AttachModuleInGame from \"./AttachModuleInGame\";\r\n\r\nexport default function ModulesUpdater(modulesManager, game)\r\n{\r\n    let size = modulesManager._pendingModulesInitialization.size;\r\n    let entity = modulesManager.entity;\r\n\r\n    if (size > 0)\r\n    {\r\n        // add pending modules\r\n        modulesManager._pendingModulesInitialization.each(mod => {\r\n            AttachModuleInGame(mod, modulesManager, game);\r\n        });\r\n\r\n        modulesManager._pendingModulesInitialization.clear();\r\n    }\r\n\r\n    \r\n    let render = modulesManager.attached.get('render');\r\n    if (render !== undefined || render != null) {\r\n        UpdateRenderable(entity, render, game.system.camera);\r\n    }\r\n    \r\n}\r\n\r\n","\r\nmodule.exports = {\r\n    Module : require('./Module'),\r\n    ModuleProvider : require('./ModuleProvider'),\r\n    ModuleAttacher : require('./ModuleAttacher'),\r\n    Renderables : require('./renderables')\r\n}","\r\nimport BoundingBox from '../../math/BoundingBox';\r\nimport Vector from '../../math/Vector'\r\nimport Module from '../Module';\r\n\r\nexport default class Renderable extends Module\r\n{\r\n    constructor(moduleName, moduleManager)\r\n    {\r\n        super('render', moduleName || 'renderable', moduleManager);\r\n\r\n        this._layerID = 0;\r\n        this._depth = 0;\r\n        this._alpha = 1;\r\n        this._depthDirty = true; \r\n        this._bounds = new BoundingBox();\r\n        this._originInPixels = {x:0, y:0};\r\n        this._originIsDirty = true;\r\n    }\r\n\r\n    get bounds() {return this._bounds;}\r\n\r\n    get depth() { return this._depthSorting; }\r\n    get layerName() { }\r\n    get layer() { return this._layerID; }\r\n    get alpha() { return this._alpha; }\r\n    set depth(value) {\r\n        if (value != this._depthSorting)\r\n        {\r\n            this._depthSorting = value;\r\n            this._depthDirty = true;\r\n        }\r\n        return this;\r\n    }\r\n    set layer(value) {\r\n        if (this.game != null)\r\n        {\r\n            if (value === 'number')\r\n            {\r\n                //this.game.render.get\r\n            }\r\n        }\r\n    }   \r\n\r\n    set alpha(value) {\r\n        this._alpha = alpha;\r\n        return this;\r\n    }\r\n\r\n\r\n\r\n}","import Renderable from \"./Renderable\";\r\nimport Rect from \"../../math/Rect\";\r\nimport DrawImage from \"./components/DrawImage\";\r\nimport ModuleProvider from \"../ModuleProvider\";\r\nimport UpdateTransformBounds from '../../transform/UpdateTransformBounds'\r\n\r\n\r\nexport default class Sprite extends Renderable {\r\n\r\n    constructor(moduleManager)\r\n    {\r\n        super('sprite', moduleManager);\r\n\r\n        //this._type = \"sprite\";\r\n        this.source = null;\r\n        this.frame = new Rect();\r\n   \r\n    \r\n    }\r\n\r\n    get width() {return this.frame.width; }\r\n    get height() {return this.frame.height; }\r\n\r\n    setFrame(x, y, width, height)\r\n    {\r\n        this.frame.set(x,y,width,height);\r\n    }\r\n\r\n    setFrameRect(rect)\r\n    {\r\n        this.frame.set(x,y,width,height);\r\n    }\r\n\r\n    setSprite(tag) {\r\n\r\n        if (this.entity != null || this.entity !== undefined) {\r\n            var sprite = this.entity.game.system.cache.image.get(tag);\r\n\r\n            if (sprite != null) {\r\n                this.setSource(sprite.data, true);\r\n            }\r\n        } else {\r\n            throw new Error(\"Sprite.setSprite: Can not set Sprite. The entity is not in the game\");\r\n        }\r\n        \r\n    }\r\n\r\n    setSource(image, changeFrame) {\r\n\r\n        if (changeFrame === undefined) changeFrame = false;\r\n      \r\n        if (this.source != image)\r\n          this.source = image;\r\n      \r\n        if (changeFrame)\r\n            this.setFrame(0,0,this.source.width,this.source.height);\r\n      \r\n      \r\n    }\r\n\r\n    render(context)\r\n    {\r\n        if (!this._enabled)\r\n            return false;\r\n\r\n        DrawImage(context, \r\n            this.source, this.frame,\r\n            this.entity.transform, this._originInPixels);\r\n   \r\n       return true;\r\n    }\r\n}\r\n\r\nModuleProvider.register('sprite', function(moduleManager, tag) {\r\n\r\n    var spr = new Sprite(moduleManager);\r\n\r\n    if (tag !== undefined)\r\n    {   \r\n        spr.setSprite(tag)\r\n    } \r\n\r\n\r\n    return spr;\r\n\r\n});","import Renderable from \"./Renderable\";\r\nimport ModuleProvider from \"../ModuleProvider\";\r\nimport TilemapLayer from \"./TilemapLayer\";\r\nimport UpdateBounds from '../../transform/UpdateBounds'\r\nimport CullTiles from \"./components/CullTiles\";\r\n\r\nexport default class Tilemap extends Renderable {\r\n    \r\n    constructor(moduleManager, resource)\r\n    {\r\n        super('tilemap', moduleManager);\r\n\r\n        //this._type = \"tilemap\";\r\n        this.tileWidth = resource.metaData.tileWidth;\r\n        this.tileHeight = resource.metaData.tileHeight;\r\n        this.width = resource.metaData.width;\r\n        this.height = resource.metaData.height;\r\n        this.orientation = resource.metaData.orientation;\r\n        this.pixelsWidth = resource.metaData.pixelsWidth;\r\n        this.pixelsHeight = resource.metaData.pixelsHeight;\r\n\r\n        this.culling = {\r\n            method : 0,\r\n            start : {x: 0, y: 0},\r\n            end : {x : 0, y : 0}\r\n        }\r\n\r\n        this.floorTiles = false;\r\n        this.tilesets = resource.tilesets;\r\n        this.layers = [];\r\n\r\n        for (let i = 0; i < resource.layers.length; i++)\r\n            this.layers.push(new TilemapLayer(this, resource.layers.at(i)));\r\n\r\n    }\r\n\r\n\r\n    \r\n\r\n}\r\n\r\nModuleProvider.register('tilemap', function(moduleManager, tag) {\r\n\r\n    let res = null;\r\n    let cache = moduleManager.entity.game.system.cache;\r\n\r\n    if (cache !== undefined)\r\n        res = cache.tilemap.get(tag);\r\n\r\n    var tilemap = new Tilemap(moduleManager, res);\r\n    tilemap.floorTiles = moduleManager.entity.game.config.floorTiles || false;\r\n\r\n    return tilemap;\r\n\r\n});","import Renderable from \"./Renderable\";\r\nimport DrawTilemapLayer from \"./components/DrawTilemapLayer\";\r\n\r\nexport default class TilemapLayer extends Renderable {\r\n\r\n    constructor(tilemap, layerData) {\r\n\r\n        super('tilemapLayer', tilemap.moduleManager);     \r\n        this.tilemap = tilemap;\r\n        this.layerData = layerData;\r\n       \r\n    }\r\n\r\n\r\n    get width() {return this.layerData.width * this.tilemap.tileWidth;}\r\n    get height() {return this.layerData.height * this.tilemap.tileHeight;}\r\n\r\n\r\n    render(context) {\r\n\r\n        if (!this._enabled && !this.tilemap._enabled)\r\n            return false;\r\n\r\n        return DrawTilemapLayer(context, this.tilemap, this.layerData, this.tilemap.moduleManager.entity.transform);\r\n\r\n    }\r\n\r\n}","import MathUtils from \"../../../math/MathUtils\";\r\nimport CullingMethod from \"./CullingMethod\";\r\n\r\nfunction LimitCulling(culling, tilemap) {\r\n\r\n    // limit culling\r\n\r\n    if (culling.start.x < 0)\r\n    culling.start.x = 0;\r\n\r\n    if (culling.start.y < 0)\r\n    culling.start.y = 0;\r\n\r\n    if (culling.end.x > tilemap.width)\r\n    culling.end.x = tilemap.width;\r\n    \r\n    if (culling.end.y > tilemap.height)\r\n    culling.end.y = tilemap.height;\r\n\r\n}\r\n\r\nexport default function CullTiles(tilemap, camera) {\r\n    \r\n    let t = tilemap.entity.transform;\r\n    let rot = camera.transform.rotation + t.rotation;\r\n\r\n    // 90 DEGREE ROTATION\r\n    // We will use the linear culling that is faster\r\n\r\n\r\n\r\n    if (rot % MathUtils.HALFPI === 0) {\r\n\r\n        let tx = t.position.x - tilemap._originInPixels.x;\r\n        let ty = t.position.y - tilemap._originInPixels.y;\r\n\r\n\r\n        tilemap.culling.method = CullingMethod.LINEAR;\r\n\r\n            tilemap.culling.start.x =  Math.floor((camera.viewBounds.min.x - tx) / tilemap.tileWidth);\r\n            tilemap.culling.start.y =  Math.floor((camera.viewBounds.min.y - ty) / tilemap.tileHeight);\r\n            tilemap.culling.end.x =  Math.ceil((camera.viewBounds.max.x - tx) / tilemap.tileWidth);\r\n            tilemap.culling.end.y =  Math.ceil((camera.viewBounds.max.y - ty) / tilemap.tileHeight);\r\n\r\n        LimitCulling(tilemap.culling, tilemap);\r\n\r\n        // TODO FOR 90 Deg TILES\r\n\r\n\r\n    } else {\r\n\r\n        tilemap.culling.method = 1;\r\n\r\n        // TODO ROTATED TILES\r\n\r\n    }\r\n    \r\n\r\n}","\r\nconst CullingMethod = {\r\n    LINEAR : 0,\r\n    LINEAR90DEG : 1 \r\n}\r\n\r\nexport default CullingMethod;","\r\n\r\nfunction DrawImage(context, source, frame, transform, destination)\r\n{\r\n    \r\n\r\n    if (context === undefined) return false;\r\n\r\n    if (source === undefined || source == null) return false;\r\n\r\n    let matrix = transform.matrix;\r\n\r\n    context.setTransform(\r\n        matrix.a[0], matrix.a[1], // 2\r\n        matrix.a[3], matrix.a[4], // 5\r\n        matrix.a[6],\r\n        matrix.a[7]);\r\n    \r\n    //context.globalAlpha = this.alpha;\r\n    \r\n    context.drawImage(\r\n            source, // image\r\n            frame.x, // sx - pos crop x\r\n            frame.y, // sy - pos crop y\r\n            frame.width, // sWidth - crop width\r\n            frame.height, // sHeight - crop height\r\n            -destination.x, // destination x\r\n            -destination.y, // destination y\r\n            frame.width,\r\n            frame.height\r\n            );\r\n      \r\n        return true;\r\n        \r\n}\r\n\r\n\r\nexport default DrawImage;","import MathUtils from \"../../../math/MathUtils\";\r\nimport CullingMethod from \"./CullingMethod\";\r\n\r\nexport default function DrawTilemapLayer(context, tilemap, layer, transform) {\r\n\r\n    let draws = 0;\r\n    let matrix = transform.matrix;\r\n    let x = matrix.a[6];\r\n    let y = matrix.a[7];\r\n\r\n    if (tilemap.floorTiles)\r\n    {\r\n       x = Math.round(x);\r\n       y = Math.round(y);\r\n    }\r\n    context.setTransform(\r\n        matrix.a[0], matrix.a[1], // 2\r\n        matrix.a[3], matrix.a[4], // 5\r\n        x, y);\r\n\r\n    if (tilemap.culling.method <= 1) {\r\n\r\n        let idx = 0;\r\n\r\n        for (let j = tilemap.culling.start.y; j < tilemap.culling.end.y; j++) {\r\n            for (let i = tilemap.culling.start.x; i < tilemap.culling.end.x; i++) {\r\n    \r\n                //if (tilemap.culling.method == CullingMethod.LINEAR)\r\n                    idx = i + j * tilemap.width;\r\n                //else if (tilemap.culling.method == CullingMethod.LINEAR90DEG)\r\n                //    idx = j + i * tilemap.width;\r\n\r\n                let tile = layer.tiles[idx];\r\n\r\n                if (tile == null || tile === undefined) continue;\r\n\r\n\r\n                context.drawImage(\r\n                tile.data.tileset.image.data, // image\r\n                tile.frame.x, // sx - pos crop x\r\n                tile.frame.y, // sy - pos crop y\r\n                tile.frame.width, // sWidth - crop width\r\n                tile.frame.height, // sHeight - crop height\r\n                tile.x - tilemap._originInPixels.x, // destination x\r\n                tile.y - tilemap._originInPixels.y,  // destination y\r\n                tile.frame.width,\r\n                tile.frame.height\r\n                    );\r\n\r\n                draws++;\r\n            }\r\n        }\r\n    }\r\n    \r\n   //for (let i = 0; i < layer.culledTiles.lenght; i++) {\r\n    /*for (let i = 0; i < layer.tiles.length; i++) {\r\n\r\n        let tile = layer.tiles[i];\r\n\r\n        if (tile == null || tile === undefined) continue;\r\n\r\n        context.drawImage(\r\n            tile.data.tileset.image.data, // image\r\n            tile.frame.x, // sx - pos crop x\r\n            tile.frame.y, // sy - pos crop y\r\n            tile.frame.width, // sWidth - crop width\r\n            tile.frame.height, // sHeight - crop height\r\n            tile.x, // destination x\r\n            tile.y,  // destination y\r\n            tile.frame.width,\r\n            tile.frame.height\r\n                );\r\n\r\n        draws++;\r\n\r\n    }*/\r\n\r\n    return draws;\r\n\r\n}","import ComputeBounds from \"../../../transform/ComputeBounds\";\r\nimport CullTiles from \"./CullTiles\";\r\n\r\n\r\nexport default function UpdateRenderable(entity, renderable, camera) {\r\n\r\n    if (!entity.transform._isDirty && !camera.transform._isDirty)\r\n        return;\r\n\r\n    \r\n\r\n\r\n    if (renderable.name == 'tilemap') {\r\n\r\n        if (renderable._originIsDirty) {\r\n            // destination\r\n            renderable._originInPixels.x = entity.transform.origin.x * renderable.pixelsWidth;\r\n            renderable._originInPixels.y = entity.transform.origin.y * renderable.pixelsHeight;\r\n        }\r\n\r\n        CullTiles(renderable, camera)\r\n\r\n        for (let i = 0; i < renderable.layers.length; i++) {\r\n            UpdateRenderable(entity, renderable.layers[i], camera);\r\n        }\r\n    } else {\r\n        \r\n        if (renderable._originIsDirty) {\r\n            // destination\r\n            renderable._originInPixels.x = entity.transform.origin.x * renderable.width;\r\n            renderable._originInPixels.y = entity.transform.origin.y * renderable.height;\r\n            // renderable._originIsDirty = false;\r\n        }\r\n    \r\n        ComputeBounds(\r\n            renderable._bounds, entity.transform, \r\n            renderable.width, renderable.height,\r\n            renderable._originInPixels);\r\n    }\r\n\r\n\r\n}","\r\nmodule.exports = {\r\n    Renderable : require('./Renderable'),\r\n    Sprite : require('./Sprite'),\r\n    TilemapLayer : require('./TilemapLayer'),\r\n    Tilemap : require('./Tilemap')\r\n}","\r\nexport default class Debug {\r\n  \r\n  constructor(game) {\r\n\r\n    this.game = game;\r\n    this.draw = game.system.draw;\r\n    this.context = game.system.render.context;\r\n    this.x = 8;\r\n    this.y = 12;\r\n    this.lineHeight = 14;\r\n    this.column = 100;\r\n    this.font =\"10px Verdana\";\r\n    this.textColor = 'white';\r\n    this.bgcolor = 'black';\r\n    this.textShadow = 'black';\r\n\r\n  }\r\n\r\n  test() {\r\n\r\n    //this.context.setTransform(1, 0, 0, 1, 0, 0);\r\n    this.context.strokeStyle = this.bgcolor;\r\n    this.context.font = this.font;\r\n    this.draw.alpha(0.5);\r\n    this.draw.rectangle(0,0,this.game.width,(14 * 4)+ 16,this.bgcolor);\r\n    this.draw.alpha(1);\r\n    this.drawLine(\"FPS: \" + Math.round(this.game.time.fps) + \" / \" + this.game.time.desiredFps);\r\n    //this.drawLine(\"Instances in view: \" + this.game.camera.instancesInView);\r\n    this.drawLine(\"Instances: \" + this.game.system.entityList.length);\r\n    this.drawLine(\"Draw Calls: \" + this.game.system.render.drawCalls);/*this.game.physics.length);*/\r\n    this.x += this.game.width / 2;\r\n    this.y = 12+8;\r\n    //this.drawLine(\"Sounds count \" + this.game.sound.length);\r\n    this.x = 8;\r\n    this.y = 12+8;\r\n\r\n  }\r\n\r\n  drawLine(textLine) {\r\n\r\n    var xx = this.x;\r\n\r\n            this.context.fillStyle = this.textShadow;\r\n            this.context.fillText(textLine, xx + 1, this.y + 1);\r\n            this.context.fillStyle = this.textColor;\r\n\r\n        this.context.fillText(textLine, xx, this.y);\r\n\r\n\r\n    this.y += this.lineHeight;\r\n\r\n  }\r\n\r\n\r\n\r\n}\r\n","\r\nimport SAT from './sat'\r\nimport SATResponse from './satresponse'\r\n\r\nexport default class Physics {\r\n\r\n  \r\n\r\n  constructor(game) {\r\n\r\n    this.game = null;\r\n    this.sat = null;\r\n    this.response = null;\r\n\r\n   \r\n    this.game = game;\r\n    this.colliadables = [];\r\n\r\n  }\r\n\r\n  init() {\r\n\r\n    this.sat = new SAT();\r\n    this.response = new SATResponse();\r\n\r\n  }\r\n\r\n  getColliadables() {\r\n    return this.colliadables;\r\n  }\r\n\r\n  addColliderObj(obj) {\r\n    this.colliadables.push(obj);\r\n  }\r\n\r\n  removeColliderObj(obj) {\r\n\r\n    var i = this.colliadables.indexOf(obj);\r\n\r\n    if(i != -1) {\r\n      this.colliadables.splice(i, 1);\r\n    }\r\n\r\n  }\r\n\r\n  clear() {\r\n\r\n    this.colliadables = [];\r\n    this.colliadables.length = 0;\r\n\r\n  }\r\n\r\n  update(time) {\r\n\r\n    let size = this.colliadables.length;\r\n\r\n    // CHECK COLLISION\r\n    if (size < 2) // at least we must have 2 objects\r\n      return;\r\n\r\n    //var collision = 0;\r\n\r\n    for (var i = 0; i < size; i++) {\r\n\r\n        var objA = this.colliadables[i];\r\n        var shapeA = objA.shape;\r\n\r\n        if (objA._gameObject._selfDestroy || !objA._gameObject.active)\r\n          continue;\r\n\r\n        var jit = i + 1;\r\n\r\n        if (jit >= size)\r\n          break;\r\n\r\n        for (var j = jit; j < size; j++) {\r\n\r\n          var objB = this.colliadables[j];\r\n          var shapeB = objB.shape;\r\n\r\n          if (objB._gameObject._selfDestroy || !objB._gameObject.active)\r\n            continue;\r\n\r\n          // AABB check of the shapes\r\n        if (objB.bounds.box.intersects(objA.bounds.box)) {\r\n\r\n          // check SAT\r\n          if (this.sat[\"test\" + shapeA.getType() + shapeB.getType()].call(this,\r\n            objA,objB,this.response.clear()) === true) {\r\n\r\n\r\n              if (objA._gameObject['onCollision'])\r\n              if (objA._gameObject.onCollision(objB._gameObject,this.response) !== false) {\r\n\r\n\r\n              }\r\n\r\n              if (objB._gameObject['onCollision'])\r\n              if (objB._gameObject.onCollision(objA._gameObject,this.response) !== false) {\r\n\r\n\r\n              }\r\n\r\n          } else\r\n            continue;\r\n          } else\r\n            continue;\r\n        }\r\n      }\r\n  }\r\n\r\n  get length() {return this.colliadables.length;}\r\n\r\n}\r\n\r\n","\r\nimport Vector from '../math/Vector' \r\n\r\nexport default class SAT {\r\n\r\n  constructor()\r\n  {\r\n\r\n    this.VECTORS = [];\r\n    for (var v = 0; v < 10; v++) { \r\n      VECTORS.push(new Vector()); \r\n    }\r\n\r\n    this.ARRAYS = [];\r\n    for (var a = 0; a < 5; a++) { \r\n      ARRAYS.push([]); \r\n    }\r\n  }\r\n\r\n  flattenPointsOn(points, normal, result) {\r\n          var min = Number.MAX_VALUE;\r\n          var max = -Number.MAX_VALUE;\r\n          var len = points.length;\r\n          for (var i = 0; i < len; i++) {\r\n              // The magnitude of the projection of the point onto the normal\r\n              var dot = points[i].dot(normal);\r\n              if (dot < min) { min = dot; }\r\n              if (dot > max) { max = dot; }\r\n          }\r\n          result[0] = min;\r\n          result[1] = max;\r\n  };\r\n\r\n  isSeparatingAxis(posA, posB, pointsA, pointsB, axis, response) {\r\n\r\n    var rangeA = ARRAYS.pop();\r\n    var rangeB = ARRAYS.pop();\r\n\r\n    // magnitude between the two polygons\r\n    var offsetV = VECTORS.pop().copy(posB).sub(posA);\r\n    var projectedOffset = offsetV.dot(axis);\r\n\r\n    // Project the polygons onto the axis.\r\n    flattenPointsOn(pointsA, axis, rangeA);\r\n    flattenPointsOn(pointsB, axis, rangeB);\r\n\r\n    // Move B's range to its position relative to A.\r\n    rangeB[0] += projectedOffset;\r\n    rangeB[1] += projectedOffset;\r\n\r\n    // Check if there is a gap. If there is, this is a separating axis and we can stop\r\n    if (rangeA[0] > rangeB[1] || rangeB[0] > rangeA[1]) {\r\n        VECTORS.push(offsetV);\r\n        ARRAYS.push(rangeA);\r\n        ARRAYS.push(rangeB);\r\n        return true;\r\n    }\r\n\r\n    if (response) {\r\n        var overlap = 0;\r\n        // A starts further left than B\r\n        if (rangeA[0] < rangeB[0]) {\r\n\r\n          response.aInB = false;\r\n\r\n          // A ends before B does. We have to pull A out of B\r\n          if (rangeA[1] < rangeB[1]) {\r\n\r\n            overlap = rangeA[1] - rangeB[0];\r\n            response.bInA = false;\r\n\r\n          // B is fully inside A.  Pick the shortest way out.\r\n          } else {\r\n\r\n            var option1 = rangeA[1] - rangeB[0];\r\n            var option2 = rangeB[1] - rangeA[0];\r\n            overlap = option1 < option2 ? option1 : -option2;\r\n\r\n          }\r\n        // B starts further left than A\r\n        } else {\r\n\r\n          response.bInA = false;\r\n\r\n          // B ends before A ends. We have to push A out of B\r\n          if (rangeA[1] > rangeB[1]) {\r\n\r\n            overlap = rangeA[0] - rangeB[1];\r\n            response.aInB = false;\r\n\r\n          // A is fully inside B.  Pick the shortest way out.\r\n          } else {\r\n\r\n            var option1 = rangeA[1] - rangeB[0];\r\n            var option2 = rangeB[1] - rangeA[0];\r\n            overlap = option1 < option2 ? option1 : -option2;\r\n\r\n          }\r\n        }\r\n        // If this is the smallest amount of overlap we've seen so far, set it as the minimum overlap.\r\n        var absOverlap = Math.abs(overlap);\r\n\r\n        if (absOverlap < response.overlap) {\r\n\r\n          response.overlap = absOverlap;\r\n          response.overlapN.copy(axis);\r\n\r\n          if (overlap < 0)\r\n            response.overlapN.reverse();\r\n        }\r\n      }\r\n\r\n      VECTORS.push(offsetV);\r\n      ARRAYS.push(rangeA);\r\n      ARRAYS.push(rangeB);\r\n\r\n\r\n\r\n      return false;\r\n\r\n  };\r\n\r\n  testPolygonPolygon(a,b,response) {\r\n\r\n    // collider a\r\n\r\n    var pointsA = a.shape.getPoints();\r\n    var normalsA =  a.shape.getNormals();\r\n    var normalsALen = normalsA.length;\r\n\r\n    // collider b\r\n\r\n    var pointsB = b.shape.getPoints();\r\n    var normalsB =  b.shape.getNormals();\r\n    var normalsBLen = normalsB.length;\r\n\r\n\r\n    // If any of the edge normals of A is a separating axis, no intersection.\r\n    while (normalsALen--) {\r\n        if (isSeparatingAxis(a.position, b.position, pointsA, pointsB, normalsA[normalsALen],response)) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n\r\n\r\n    // If any of the edge normals of B is a separating axis, no intersection.\r\n    while (normalsBLen--) {\r\n        if (isSeparatingAxis(a.position, b.position, pointsA, pointsB, normalsB[normalsBLen], response)) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n\r\n\r\n    // Since none of the edge normals of A or B are a separating axis, there is an intersection\r\n    // and we've already calculated the smallest overlap (in isSeparatingAxis).  Calculate the\r\n    // final overlap vector.\r\n      if (response) {\r\n          response.a = a;\r\n          response.b = b;\r\n          response.overlapV.copy(response.overlapN).scale(response.overlap);\r\n      }\r\n    return true;\r\n\r\n  };\r\n\r\n}\r\n\r\n\r\n","\r\nexport default class SATResponse {\r\n\r\n    constructor()\r\n    {\r\n        this.a = null;\r\n        this.b = null;\r\n        this.overlapN = new Vector();\r\n        this.overlapV = new Vector();\r\n        this.aInB = true;\r\n        this.bInA = true;\r\n        this.overlap = Number.MAX_VALUE;\r\n        this.indexShapeA = -1;\r\n        this.indexShapeB = -1;\r\n        this.clear();\r\n    }\r\n\r\n    clear()\r\n    {\r\n        this.aInB = true;\r\n        this.bInA = true;\r\n        this.overlap = Number.MAX_VALUE;\r\n        this.indexShapeA = -1;\r\n        this.indexShapeB = -1;\r\n        return this;\r\n    }\r\n}\r\n","\r\nexport const RENDERING_TYPE = {\r\n    NEAREST : 0,\r\n    LINEAR : 1\r\n}","import GameSystemManager from \"../core/GameSystemManager\";\r\n\r\nexport default class Draw {\r\n  \r\n  constructor(game) {\r\n    this.game = game;\r\n    this.cache = null;\r\n    this.context = null;\r\n  }\r\n\r\n  init()\r\n  {\r\n\r\n    this.cache = this.game.system.cache;\r\n    this.context = this.game.system.render.context;\r\n    return this;\r\n  }\r\n\r\n  font(fontname,size) {\r\n\r\n    this.context.font = size + \"px \" + fontname;\r\n\r\n  }\r\n\r\n  text(text,x,y,color) {\r\n\r\n    if (color === undefined) color = 'black';\r\n\r\n    this.context.fillStyle = color;\r\n    this.context.fillText(text, x, y);\r\n\r\n  }\r\n\r\n  sprite(tag, x, y, anchor) {\r\n\r\n      var img = this.cache.getAsset('images',tag);\r\n\r\n      if (img != null) {\r\n\r\n        if (anchor === undefined) {\r\n          anchor[0] = 0;\r\n          anchor[1] = 0;\r\n        }\r\n\r\n        var ctx = this.context;\r\n\r\n      ctx.save();\r\n\r\n      ctx.translate(x-img.width*anchor[0], y-img.height*anchor[1]);\r\n\r\n    ctx.drawImage(img,\r\n            0,\r\n            0,\r\n            img.width,\r\n            img.height);\r\n\r\n\r\n      ctx.restore();\r\n\r\n    }\r\n\r\n  }\r\n\r\n  spriteTransformed(tag, x, y, xscale, yscale, angle) {\r\n\r\n\r\n  }\r\n\r\n  rectangle(x, y, width, height, color) {\r\n\r\n    this.context.fillStyle=color;\r\n    this.context.fillRect(x,y,width,height);\r\n\r\n  }\r\n\r\n  outlineRectangle(x,y,width,height,color,outlineWidth) {\r\n\r\n    //this.context.beginPath();\r\n    this.context.lineWidth=outlineWidth;\r\n    //this.context.setLineDash([6]);\r\n    this.context.strokeStyle=color;\r\n    this.context.strokeRect(x, y, width, height);\r\n    //this.context.rect(x,y,width,height);\r\n    //this.context.stroke();\r\n\r\n  }\r\n\r\n  alpha(a) {\r\n\r\n    this.context.globalAlpha = a;\r\n\r\n  }\r\n\r\n  color(color) {\r\n\r\n    this.context.fillStyle = color;\r\n\r\n  }\r\n\r\n  bounds(bb,color) {\r\n\r\n  if (color === undefined)\r\n    color = 'red';\r\n  this.context.setTransform(1,0,0,1,0,0);\r\n  this.outlineRectangle(bb.min.x,bb.min.y,bb.max.x-bb.min.x,bb.max.y-bb.min.y,color,1);\r\n\r\n  }\r\n\r\n}\r\n\r\nGameSystemManager.register('Draw',Draw,'draw');","\r\nimport DataMap from '../structures/Map'\r\nimport RenderLayer from './RenderLayer'\r\nimport RenderLayerManagment from './RenderLayersManagement'\r\nimport Canvas from './canvas/Canvas'\r\nimport {RENDERING_TYPE} from './Define'\r\nimport GameSystemManager from '../core/GameSystemManager';\r\nimport CanvasSmoothing from './canvas/Smoothing';\r\nimport DrawRenderLayer from './components/DrawRenderLayer';\r\n\r\n\r\nexport default class Render {\r\n    \r\n\r\n    constructor(game) {\r\n        \r\n        this.game = game;\r\n        this.layer = new RenderLayerManagment(this.game);\r\n        this.canvas = Canvas.create(this.game.parent,this.game.width,this.game.height);\r\n        this.context = this.canvas.getContext(\"2d\", { alpha: false });  \r\n        this.imageRendering = (game.config.pixelated) ? RENDERING_TYPE.NEAREST : RENDERING_TYPE.LINEAR;\r\n        this.smooth = new CanvasSmoothing(this.context);\r\n        this.smooth.set(this.imageRendering);\r\n\r\n        this._backgroundColor = '#000'       \r\n        this._alpha = 1;\r\n        this._enable = true;\r\n        this.clear = true;\r\n        this.drawCalls = 0;\r\n    }\r\n\r\n    get backgroundColor() {return this._backgroundColor;}\r\n    set backgroundColor(value) {\r\n        this._backgroundColor = value;\r\n    }\r\n    get alpha() {return this._alpha;}\r\n    set alpha(value) {\r\n\r\n        if (this._alpha !== value)\r\n        {\r\n            this.currentContext.globalAlpha = value;\r\n            this._alpha = value;\r\n        }\r\n\r\n        return this._alpha;\r\n    }\r\n}\r\n\r\nGameSystemManager.register('Render', Render, 'render');","import DataList from \"../structures/List\";\r\n\r\n\r\nexport default class RenderLayer { \r\n    \r\n    constructor(game,layerName) {\r\n\r\n        this._name = layerName;\r\n        this.game = game;       \r\n        this.renderList = new DataList(true);\r\n        this.__drawCalls = 0;\r\n        this.__enable = true;\r\n        this.__isDirty = false;\r\n    }\r\n\r\n    get drawCalls() {return this.__drawCalls;}\r\n\r\n    // Add renderable components\r\n    add(renderer) {\r\n    \r\n        if (renderer === undefined)\r\n            return;\r\n\r\n        this.renderList.push(renderer);\r\n       // this.renderer.__renderLayer = this;\r\n        this.__isDirty = true;\r\n\r\n    }\r\n\r\n    remove(renderer)\r\n    {\r\n        return this.renderList.remove(renderer);\r\n    }\r\n\r\n    removeAt(index)\r\n    {\r\n        \r\n    }\r\n\r\n    at(index)\r\n    {\r\n        if (index < 0 || index >= this.__renderers.size)\r\n        {\r\n            throw new Error('RenderLayer.at: Renderer at '+ index +' does not exist in the render layer list: \\\"' + name + \"\\\".\");\r\n        }\r\n        return this.renderList.at(index);\r\n\r\n    }\r\n\r\n    sortDepth(a, b) { // sort ascending\r\n\r\n        return a._depthSorting - b._depthSorting;\r\n\r\n        /*this.__renderers.sort(\r\n\r\n          function(a, b) {\r\n      \r\n            if (a.depth > b.depth) {\r\n      \r\n              return 1;\r\n      \r\n            } else if (a.depth < b.depth) {\r\n      \r\n              return -1;\r\n      \r\n            } else {\r\n      \r\n              if (a.z > b.z) {\r\n                return 1;\r\n              } else {\r\n                return -1;\r\n              }\r\n      \r\n      \r\n            }\r\n          });*/\r\n\r\n    }\r\n\r\n    get length() {return this.__renderers.length;}\r\n    get name() {return this._name;}\r\n    get enable() {return this.__enable;}\r\n    set enable(value) {\r\n        value = !!value;\r\n    \r\n        if (value !== this._enabled)\r\n        {\r\n            //if (!value)\r\n            //    this.reset();\r\n\r\n            this._enabled = value;\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n","\r\nimport DataMap from '../structures/Map'\r\nimport RenderLayer from './RenderLayer'\r\nimport DataList from '../structures/List';\r\n\r\nexport default class RenderLayersManagement {\r\n\r\n    constructor(game) {\r\n        this.game = game;\r\n        this.renderLayers = new DataList();\r\n        //this.__renderLayersMap = new DataMap();\r\n        this.add('default');\r\n    }\r\n\r\n\r\n\r\n    add(name) {\r\n\r\n        if (this.contains(name))\r\n        {\r\n            throw new Error(\"Render.add: There is already a RenderLayer called: \\\"\" +  name + \"\\\".\");\r\n        }\r\n       \r\n        //this.__renderLayersMap.set(name, this.__renderLayers.length);\r\n        this.renderLayers.push(new RenderLayer(this.game, name));\r\n    }\r\n\r\n    remove(name)\r\n    {\r\n        if (typeof name !== 'string')\r\n            throw new Error(\"Render.remove: The value name is not a string.\");\r\n\r\n        if (name === \"default\")\r\n            throw new Error(\"Render.remove: You can not remove the \\\"default\\\" layer.\");\r\n\r\n        if (!this.__renderLayersMap.has(name))\r\n            throw new Error(\"Render.remove: Could not remove layer. There is no layer named \\\"\" + name + \"\\\".\");\r\n\r\n        var index = this.__renderLayersMap.get(name);\r\n\r\n        this.renderLayers.erase(name);\r\n    }\r\n\r\n    contains(layerName)\r\n    {\r\n        if (typeof layerName !== 'string')\r\n            throw new Error(\"Render.contains: The value name is not a string.\");\r\n\r\n        let val = this.renderLayers.each(function(layer) {\r\n           \r\n            if (layer.name == layerName)\r\n            {\r\n                return true;\r\n            }\r\n        });\r\n\r\n        return val || false;\r\n    }\r\n\r\n}","\r\n/**\r\n * Create a Canvas object.\r\n * @class Canvas\r\n */\r\nexport default (\r\n    class Canvas {\r\n\r\n  static create (parent,width, height) {\r\n\r\n  // default definition\r\n  let defaultDef = {\r\n    tabindex: '1',\r\n    width: width,\r\n    height: height,\r\n    id: Math.random().toString(36).substr(2, 9),\r\n    class: \"\",\r\n    container: \"body\",\r\n    style: \"padding: 0;margin: auto;display: block;top: 0; bottom: 0;left: 0;right: 0;border:1px solid #d3d3d3;background-color: #f1f1f1;\"\r\n  };\r\n\r\n  //var CO = Object.assign(defaultDef, options);\r\n  let CO = defaultDef;\r\n  let canvas;\r\n\r\n\r\n  canvas = document.createElement('canvas');\r\n  //canvas.parent = parent;\r\n  canvas.setAttribute(\"id\", CO.id);\r\n  canvas.setAttribute(\"width\", CO.width);\r\n  canvas.setAttribute(\"height\", CO.height);\r\n  canvas.setAttribute(\"style\", CO.style);\r\n  //canvas.style.position = 'absolute';\r\n  \r\n\r\n\r\n  Canvas.appendDOM(canvas,parent);\r\n  //document.body.appendChild(canvas);\r\n\r\n  return canvas;\r\n}\r\n\r\nstatic appendDOM(canvas,parent) {\r\n\r\n  let appendTo;\r\n  let overflowHidden = true;\r\n  let target = null;\r\n\r\n  //if (overflowHidden === undefined) { overflowHidden = true; }\r\n\r\n    if (parent)\r\n    {\r\n        if (typeof parent === 'string')\r\n        {\r\n            // hopefully an element ID\r\n            target = document.getElementById(parent);\r\n        }\r\n        else if (typeof parent === 'object' && parent.nodeType === 1)\r\n        {\r\n            // quick test for a HTMLelement\r\n            target = parent;\r\n        }\r\n    }\r\n\r\n    // Fallback, covers an invalid ID and a non HTMLelement object\r\n    if (!target)\r\n    {\r\n        target = document.body;\r\n    }\r\n\r\n    /*if (overflowHidden && target.style)\r\n    {\r\n        target.style.overflow = 'hidden';\r\n    }*/\r\n\r\n    target.appendChild(canvas);\r\n\r\n    return canvas;\r\n}\r\n\r\n})\r\n","import { RENDERING_TYPE } from \"../Define\";\r\n\r\n\r\nexport default class CanvasSmoothing {\r\n\r\n    constructor(context) {\r\n        this.context = context;\r\n        this.prefix = this.getPrefix(context);\r\n    }\r\n\r\n    getPrefix(context) {\r\n\r\n        let vendors = [ 'i', 'webkitI', 'msI', 'mozI', 'oI' ];\r\n        for (let i = 0; i < vendors.length; i++)\r\n        {\r\n            let s = vendors[i] + 'mageSmoothingEnabled';\r\n\r\n            if (s in context)\r\n                return s;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    setEnable(flag) {\r\n\r\n        if (flag === 'undefined') flag = true;\r\n\r\n        if (this.prefix === '' || this.prefix === undefined)\r\n            this.prefix = this.getPrefix(this.context);\r\n\r\n        if (this.prefix)\r\n            this.context[this.prefix] = flag;\r\n\r\n        return this.context;\r\n    }\r\n\r\n    set(renderType) {\r\n        if (renderType == RENDERING_TYPE.NEAREST)\r\n            this.setEnable(false);\r\n        else\r\n            this.setEnable(true);\r\n    }\r\n\r\n}\r\n","\r\nexport default function BeginDrawRender(render) {\r\n\r\n    if (render.clear)\r\n    {\r\n        render.context.clearRect(0, 0, render.canvas.width, render.canvas.height);\r\n    }\r\n\r\n    render.context.fillStyle = render._backgroundColor;  \r\n    render.context.fillRect(0, 0, render.canvas.width, render.canvas.height);\r\n\r\n    render.drawCalls = 0;\r\n\r\n}","\r\nimport DrawRenderLayer from './DrawRenderLayer'\r\n\r\nexport default function DrawRender(render, camera, delta) {\r\n        \r\n    if (!render._enable)\r\n        return;\r\n\r\n        let clip = (camera.x !== 0 ||\r\n             camera.y !== 0 ||\r\n             camera.width !== render.context.canvas.width ||\r\n             camera.height !== render.context.canvas.height);\r\n\r\n    // alpha\r\n    if (render._alpha !== 1)\r\n    {\r\n        render.context.globalAlpha = 1;\r\n        render._alpha = 1;\r\n    }\r\n\r\n    // blend\r\n    render.context.globalCompositeOperation = 'source-over';\r\n   \r\n    \r\n    /*if (clip)\r\n    {\r\n        let resolution = 1;\r\n        this.context.save();\r\n        this.context.beginPath();\r\n        this.context.rect(\r\n            0,\r\n            0,\r\n            320 * resolution,\r\n            240 * resolution);\r\n        this.context.clip();\r\n    }*/\r\n\r\n         \r\n\r\n    for (let i = 0; i < render.layer.renderLayers.length; i++)\r\n    {\r\n        let layer = render.layer.renderLayers.at(i);\r\n\r\n        if (!layer.enable)\r\n            continue;\r\n\r\n        let drawCalls = 0;   \r\n        drawCalls += DrawRenderLayer(layer,camera, render.context);\r\n\r\n        render.drawCalls += drawCalls;\r\n    }\r\n\r\n    camera.game.system.draw.bounds(camera.bounds);\r\n\r\n    render.context.setTransform(1, 0, 0, 1, 0, 0);\r\n\r\n    \r\n\r\n    render.game.scene.render();\r\n\r\n    if (render.game.debug != null) {\r\n\r\n        \r\n        render.game.debug.test();\r\n  \r\n    }\r\n\r\n    \r\n}","\r\n\r\n    export default function DrawRenderLayer(layer, camera, context)\r\n    {\r\n     \r\n        if (!layer.__enable)\r\n            return 0;\r\n\r\n        let drawCalls = 0;\r\n\r\n        if (layer.__isDirty)\r\n        {\r\n            layer.renderList.sort(layer.sortDepth);\r\n\r\n            layer.__isDirty = false;\r\n        }\r\n\r\n        var self = this;\r\n        let size = layer.renderList.size;\r\n\r\n        for (let i = 0; i < size; i++)\r\n        {\r\n            let element = layer.renderList.at(i);\r\n\r\n            if (camera.bounds.intersects(element.bounds))\r\n            {\r\n                drawCalls += element.render(context);\r\n\r\n            camera.game.system.draw.bounds(element.bounds);\r\n            }\r\n        }\r\n\r\n        return drawCalls;\r\n\r\n    }","\r\nexport default function EndDrawRender(render) {\r\n\r\n    \r\n    render.context.globalAlpha = 1;\r\n    render.context.globalCompositeOperation = 'source-over';\r\n}\r\n","\r\nmodule.exports = {\r\n    RenderLayer : require('./RenderLayer'),\r\n    RenderLayerManagement : require('./RenderLayersManagement'),\r\n    Render : require('./Render'),\r\n    Draw : require('./Draw')\r\n}","import Resource from \"./Resource\";\r\nimport ResourceType from \"./ResourceType\";\r\n\r\n/**\r\n* Image that holds image data.\r\n* @class Image\r\n* @constructor\r\n*/\r\nexport default class ImageResource extends Resource {\r\n\r\n    constructor(name, data) {\r\n\r\n      super(name);\r\n      \r\n      this.data = data;\r\n      this.width = 0;\r\n      this.height = 0;\r\n      this.imageUrl = null;\r\n      this.type = ResourceType.Image;\r\n\r\n      if ((this.data.complete || this.data.getContext) && this.data.width && this.data.height) {\r\n\r\n          this.width = this.data.naturalWidth || this.data.width;\r\n          this.height = this.data.naturalHeight || this.data.height;\r\n\r\n      }\r\n  }\r\n\r\n}","import ResourceType from \"./ResourceType\";\r\n\r\n\r\nexport default class Resource {\r\n\r\n    constructor(name, data)\r\n    {\r\n        //this.data = data || undefined;\r\n        this.name = name || 'Resource';\r\n        this.type = ResourceType.None;\r\n    }\r\n\r\n}","\r\nconst ResourceType = {\r\n    None : -1,\r\n    Image : 0,\r\n    Tilemap : 1,\r\n}\r\n\r\nexport default ResourceType;","import TilemapMetadata from \"./tilemap/TilemapMetadata\";\r\nimport Resource from \"./Resource\";\r\nimport ParseTilesets from \"./tilemap/ParseTileset\";\r\nimport ParseLayers from \"./tilemap/ParseLayers\";\r\nimport ResourceType from './ResourceType'\r\n\r\nexport default class TilemapResource extends Resource {\r\n\r\n    constructor(name, source, cache) {\r\n\r\n        super(name);\r\n\r\n        this.metaData = new TilemapMetadata ({\r\n            name: source.name,\r\n            width: source.width,\r\n            height: source.height,\r\n            tileWidth: source.tilewidth,\r\n            tileHeight: source.tileheight,\r\n            orietation: source.orietation\r\n        });\r\n\r\n        this.name = name;\r\n        this.tilesets = ParseTilesets(source, cache);\r\n        this.layers = ParseLayers(source, this);\r\n        //this.data.tiles = ParseTiles(this.data);\r\n        this.type = ResourceType.Tilemap;\r\n        \r\n\r\n    }\r\n\r\n    getTilesetByGID(gid) {\r\n\r\n        return this.tilesets.each((set)=>{\r\n            if (set.hasGID(gid)) {\r\n                return set;\r\n            }\r\n        }) || null;\r\n\r\n    }\r\n\r\n}\r\n","\r\nmodule.exports = {\r\n    ResourceType : require('./ResourceType'),\r\n    ImageResource : require('./ImageResource'),\r\n    TilemapResource : require('./TilemapResource')\r\n}","\r\n// Bits on the far end of the 32-bit global tile ID are used for tile flags\r\nconst FLIPPED_HORIZONTALLY_FLAG = 0x80000000;\r\nconst FLIPPED_VERTICALLY_FLAG   = 0x40000000;\r\nconst FLIPPED_DIAGONALLY_FLAG   = 0x20000000;\r\n\r\nfunction ParseGIDFlags(flipped_horizontally, flipped_vertically, flipped_diagonally) {\r\n\r\n    let flip = false;\r\n    let rot = 0;\r\n\r\n    return {flipped: flip, rotation : rot};\r\n\r\n}\r\n\r\n// http://docs.mapeditor.org/en/latest/reference/tmx-map-format/\r\nexport default function ParseGID(global_tile_id) {\r\n\r\n    // The global_tile_id is alredy parsed on Base64.decodeToUint32() phase.\r\n\r\n    /* unsigned global_tile_id = data[tile_index] |\r\n                              data[tile_index + 1] << 8 |\r\n                              data[tile_index + 2] << 16 |\r\n                              data[tile_index + 3] << 24;*/\r\n\r\n    // Read out the flags\r\n    let flipped_horizontally = Boolean(global_tile_id & FLIPPED_HORIZONTALLY_FLAG);\r\n    let flipped_vertically = Boolean(global_tile_id & FLIPPED_VERTICALLY_FLAG);\r\n    let flipped_diagonally = Boolean(global_tile_id & FLIPPED_DIAGONALLY_FLAG);\r\n\r\n    // Clear the flags\r\n     global_tile_id = global_tile_id & ~(FLIPPED_HORIZONTALLY_FLAG |\r\n        FLIPPED_VERTICALLY_FLAG |\r\n        FLIPPED_DIAGONALLY_FLAG);\r\n\r\n\r\n    let flags = ParseGIDFlags(flipped_horizontally, flipped_vertically, flipped_diagonally);\r\n\r\n    return {\r\n        gid : global_tile_id,\r\n        flipHorizontal : flipped_horizontally,\r\n        flipVertical : flipped_vertically,\r\n        flipDiagonal : flipped_diagonally,\r\n        flipped: flags.flipped,\r\n        rotation : flags.rotation        \r\n    };\r\n\r\n}","\r\nimport ObjectUtils from '../../utils/ObjectUtils'\r\nimport Base64Utils from '../../utils/Base64Utils';\r\nimport DataList from '../../structures/List';\r\nimport ParseGID from './ParseGID'\r\nimport TilemapLayerData from './TilemapLayerData';\r\nimport Tile from './Tile';\r\n\r\nexport default function ParseLayers(json, map) {\r\n\r\n    let size = json.layers.length;\r\n    let tileLayers = new DataList();\r\n\r\n    if (size <= 0)\r\n        return tileLayers;\r\n\r\n    for (let i = size - 1; i >= 0; i--) {\r\n\r\n        let jsonLayer = json.layers[i];\r\n\r\n        if (jsonLayer.type !== \"tilelayer\") continue;\r\n\r\n        if (jsonLayer.enconding) {\r\n            if (jsonLayer.enconding === 'base64') {\r\n                //  should be interpreted as an array of unsigned 32-bit integers using little-endian byte ordering.\r\n                jsonLayer.data = Base64Utils.decodeToUint32(jsonLayer.data);\r\n                delete jsonLayer.enconding;\r\n            }\r\n        }\r\n\r\n        let newLayer = new TilemapLayerData({\r\n            name: jsonLayer.name,\r\n            x: ObjectUtils.getValue(jsonLayer, 'offsetx', 0) + jsonLayer.x,\r\n            y: ObjectUtils.getValue(jsonLayer, 'offsety', 0) + jsonLayer.y,\r\n            width: jsonLayer.width,\r\n            height: jsonLayer.height,\r\n            tileWidth: jsonLayer.tilewidth,\r\n            tileHeight: jsonLayer.tileheight,\r\n            alpha: jsonLayer.opacity,\r\n            visible: jsonLayer.visible,\r\n            //properties: GetFastValue(layer, 'properties', {})\r\n        });\r\n\r\n        let tiles = [];\r\n        let x = 0;\r\n        let y = 0;\r\n\r\n        for (let j = 0; j < jsonLayer.data.length; j++) {\r\n\r\n            let gidProp = ParseGID(jsonLayer.data[j]);\r\n            let id = x + y * newLayer.width;\r\n            let tile = null;\r\n\r\n            // The first tileset always has a firstgid value of 1. \r\n            if (gidProp.gid > 0) {\r\n                let tileset = map.getTilesetByGID(gidProp.gid);\r\n                tile = new Tile(newLayer, tileset.getTile(gidProp.gid), x, y, id);\r\n            } \r\n\r\n            tiles.push(tile);\r\n\r\n            x++;\r\n\r\n            if (x >= newLayer.width) {\r\n                x = 0;\r\n                y++;\r\n            }\r\n        }\r\n\r\n        newLayer.tiles = tiles;\r\n\r\n        tileLayers.push(newLayer);\r\n\r\n    }\r\n\r\n   \r\n    return tileLayers;\r\n\r\n}","import Tileset from \"./Tileset\";\r\nimport DataList from \"../../structures/List\";\r\nimport Path from '../../utils/Path'\r\n\r\n\r\nexport default function ParseTilesets(json, cache) {\r\n\r\n    let size = json.tilesets.length || 0;\r\n\r\n    let tileSets = new DataList();    \r\n\r\n    for (let i = 0; i < size; i++) {\r\n\r\n        let jsonTileset = json.tilesets[i];\r\n\r\n        if (jsonTileset.image) {\r\n\r\n            var newTileSet = new Tileset(\r\n                jsonTileset.name, \r\n                jsonTileset.firstgid, \r\n                jsonTileset.tilewidth, \r\n                jsonTileset.tileheight, \r\n                jsonTileset.margin, \r\n                jsonTileset.spacing);\r\n\r\n            newTileSet.image = cache.image.get(Path.getFilenameWithoutExtension(jsonTileset.image) || jsonTileset.name);\r\n\r\n            newTileSet.updateData(jsonTileset.imagewidth, jsonTileset.imageheight);\r\n\r\n            // check tile properties\r\n\r\n            tileSets.push(newTileSet);\r\n        }\r\n    }\r\n\r\n    return tileSets;\r\n\r\n}","\r\nexport default class Tile {\r\n\r\n    constructor(layer, tileData, tileX, tileY, id) {\r\n        this.layer = layer;\r\n        this.data = tileData;\r\n        this.tileX = tileX;\r\n        this.tileY = tileY;\r\n        this.id = id;\r\n        this.frame = tileData.st;\r\n        // pixels positions\r\n        this.x = Math.round(tileX * tileData.st.width);\r\n        this.y = Math.round(tileY * tileData.st.height);\r\n    }\r\n\r\n}","import Rect from \"../../math/Rect\";\r\n\r\nexport default class TileData {\r\n\r\n    constructor(tileset, gid, u, v, umax, vmax) {\r\n        this.gid = gid;\r\n        this.tileset = tileset || null;\r\n        this.st = new Rect(u,v,umax,vmax); // tex coords\r\n        this.keyFrames = null;\r\n    }\r\n    \r\n}","\r\nimport ObjectUtils from '../../utils/ObjectUtils'\r\n\r\nexport default class TilemapLayerData {\r\n    constructor(config) {\r\n        this.width = ObjectUtils.getValue(config,'width', 0);\r\n        this.height = ObjectUtils.getValue(config,'height',0);\r\n        this.x = ObjectUtils.getValue(config,'x', 0);\r\n        this.y = ObjectUtils.getValue(config,'y', 0);\r\n        this.name = ObjectUtils.getValue(config,'name', 'tilemaplayer');\r\n        this.alpha = ObjectUtils.getValue(config,'alpha', 1);\r\n        //this.type =\"tilelayer\";\r\n        this.visible = ObjectUtils.getValue(config,'visible', true);\r\n        this.tiles =  ObjectUtils.getValue(config,'tiles', []);\r\n        \r\n    }\r\n}","import ObjectUtils from \"../../utils/ObjectUtils\";\r\nimport DataList from \"../../structures/List\";\r\n\r\nexport default class TilemapMetadata {\r\n\r\n    constructor(config) {\r\n\r\n        this.name = ObjectUtils.getValue(config,'name','tilemap');\r\n        this.width =  ObjectUtils.getValue(config,'width',0);\r\n        this.height =  ObjectUtils.getValue(config,'height',0);\r\n        this.tileWidth =  ObjectUtils.getValue(config,'tileWidth',16);\r\n        this.tileHeight =  ObjectUtils.getValue(config,'tileHeight',16);\r\n        this.pixelsWidth = ObjectUtils.getValue(config,'pixelsWidth',this.width * this.tileWidth);\r\n        this.pixelsHeight = ObjectUtils.getValue(config,'pixelsHeight',this.height * this.tileHeight);\r\n        this.orientation = ObjectUtils.getValue(config, 'orientation', 'orthogonal');\r\n    }\r\n\r\n\r\n}","import DataList from \"../../structures/List\";\r\nimport TileData from './TileData'\r\n\r\n\r\n\r\nexport default class Tileset {\r\n\r\n    constructor(name, firstgid, tileWidth, tileHeight, margin, spacing) {\r\n\r\n        this.name = name;\r\n        this.firstgid = firstgid || 1;\r\n        this.tileWidth = tileWidth || 16;\r\n        this.tileHeight = tileHeight || 16;\r\n        this.margin = margin || 0;\r\n        this.spacing = spacing || 0;\r\n        this.image = null;\r\n        this.data = new DataList();\r\n        this.rows = 0;\r\n        this.collumns = 0;\r\n        this.gidCount = 0;\r\n    }\r\n\r\n    getTile(gid) {\r\n\r\n        if (gid < this.firstgid && gid >= this.firstgid + this.gidCount)\r\n            return null;\r\n\r\n        return this.data.at(gid - this.firstgid);\r\n    } \r\n\r\n    hasGID(gid) {\r\n        return (\r\n            gid >= this.firstgid &&\r\n            gid < this.firstgid + this.gidCount\r\n        );\r\n    }\r\n\r\n    updateData(imageWidth, imageHeight) {\r\n\r\n        if (this.image !== undefined || this.image != null)\r\n        {\r\n            imageWidth = this.image.width;\r\n            imageHeight = this.image.height;\r\n        }\r\n\r\n        //slice into tiles\r\n        let columns = (imageHeight - this.margin * 2 + this.spacing) / (this.tileHeight + this.spacing);\r\n        let rows = (imageWidth - this.margin * 2 + this.spacing) / (this.tileWidth + this.spacing);\r\n\r\n        //rows = Math.floor(rows);\r\n        //columns = Math.floor(columns);\r\n\r\n\r\n        this.rows = rows;\r\n        this.collumns = columns;\r\n        this.gidCount = rows * columns;\r\n\r\n        let u = this.margin;\r\n        let v = this.margin;\r\n        let x = 0;\r\n\r\n        this.data.clear();\r\n        //let gid = 0;\r\n\r\n        for (let i = 0; i < this.gidCount; i++) {\r\n            //for (let x = 0; x < colCount; x++) {\r\n            \r\n               // let gid = x + y * this.rows;\r\n                this.data.push(new TileData(\r\n                    this, \r\n                    this.firstgid + i,\r\n                    u, v,\r\n                    this.tileWidth, this.tileHeight));\r\n\r\n            u += this.tileWidth + this.spacing;             \r\n            x++;\r\n\r\n            if (x >= rows)\r\n            {\r\n                x = 0;\r\n                u = this.margin;\r\n                v += this.tileHeight + this.spacing;\r\n            }\r\n\r\n            \r\n        }\r\n\r\n       \r\n    }\r\n\r\n    \r\n\r\n}","\r\nexport default class Scene {\r\n  \r\n  constructor(name) {\r\n\r\n    this.name = name || 'New Scene';\r\n    //this.childs = new EntityHierarchy(\"SceneHierarchy\", this.game);\r\n    /*this.camera = null;\r\n    this.x = 0;\r\n    this.y = 0;\r\n    this.width = 0;\r\n    this.height = 0;\r\n    this.view = 0;*/\r\n\r\n\r\n    /*if (myGame != null) {\r\n      this.width = myGame.width;\r\n      this.height = myGame.height;\r\n    }*/\r\n  }\r\n\r\n\r\n\r\n\r\n  instanceDestroy(gameObject) {\r\n\r\n    if (gameObject['destroy'])\r\n      gameObject.destroy();\r\n\r\n      //console.log(\"deleted \" + gameObject._id)\r\n\r\n    let index = this.instances.indexOf( gameObject);\r\n\r\n    this.instances.splice( index, 1 );\r\n\r\n  }\r\n\r\n  addGameObject(gameObject, clone) {\r\n\r\n    let obj;\r\n    let cl = false;\r\n\r\n    if (arguments.length == 0)\r\n      obj = new scintilla.GameObject();\r\n    else {\r\n\r\n      if (clone === undefined)\r\n        cl = false;\r\n      else\r\n        cl = clone;\r\n\r\n\r\n        if (cl)\r\n          obj = gameObject.clone();\r\n        else\r\n          obj = gameObject;\r\n\r\n    }\r\n\r\n    obj._id = this.instances.length;\r\n    obj._game = this.game;\r\n    this.instances.push(obj);\r\n\r\n    obj.start();\r\n    return obj;\r\n\r\n  }\r\n\r\n  setBounds(x,y,width,height) {\r\n\r\n    this.x = x;\r\n    this.y = y;\r\n    this.width = width;\r\n    this.height = height;\r\n    \r\n  }\r\n\r\n}\r\n\r\n\r\n\r\n","\r\nimport DataMap from '../structures/Map'\r\nimport Scene from './Scene'\r\n\r\nexport default class SceneManager {\r\n  \r\n  constructor(game) {\r\n\r\n    this.game = game;\r\n    this.entityUpdateList = null;\r\n    this._scenes = new DataMap();\r\n\r\n    this.currentScene = null;\r\n    this._currentSceneName = '';\r\n    this._changeScene = null;\r\n\r\n    this._setup = false;\r\n    this._clearCache = false;\r\n\r\n    // callbacks\r\n    \r\n    this.onStartCallback = null;\r\n    this.onLoadingCallback = null;\r\n    this.onLoadingRenderCallback = null;\r\n    this.onPreloadCallback = null;\r\n    //this.onUpdateCallback = null;\r\n    this.onRenderCallback = null;\r\n    this.onDestroyCallback = null;\r\n\r\n  }\r\n\r\n  add(sceneName,scene) {\r\n\r\n  var newScene;\r\n\r\n  if (scintilla.Scene.prototype.isPrototypeOf(scene)) {\r\n    newScene = scene;\r\n    newScene.game = this.game;\r\n  } else\r\n    newScene = null;\r\n\r\n\r\n  if (newScene != null)\r\n    this._scenes.set(sceneName,newScene);\r\n\r\n  }\r\n\r\n  new(sceneName)\r\n  {\r\n\r\n  if (this._scenes.has(sceneName))\r\n  {\r\n    throw \"Could not create new Scene. The scene name \\\"\" + name + \"\\\" already exists.\"; \r\n    return null;\r\n  }\r\n\r\n  var newScene = new Scene(this.game, sceneName);\r\n  this._scenes.set(sceneName,newScene);\r\n\r\n  return newScene;\r\n\r\n  }\r\n\r\n  set(sceneName, clearCache) {\r\n\r\n    if (!this._scenes.has(sceneName))\r\n      throw new Error('SceneManager.set: Scene' + sceneName + ' does not exist.')\r\n\r\n  if (clearCache === undefined) { clearCache = false; }\r\n\r\n  \r\n\r\n  this._changeScene = sceneName;\r\n  this._clearCache = clearCache;\r\n\r\n\r\n\r\n  }\r\n\r\n  restart(clearCache) {\r\n\r\n  if (clearCache === undefined) { clearCache = false; }\r\n\r\n  this._changeScene = this._currentSceneName;\r\n  this._clearCache = clearCache;\r\n\r\n  }\r\n\r\n  remove(sceneName) {\r\n\r\n  if (this._currentSceneName === sceneName) {\r\n\r\n    this.currentScene = null;\r\n\r\n    this.onStartCallback = null;\r\n    this.onLoadingCallback = null;\r\n    this.onLoadingRenderCallback = null;\r\n    this.onPreloadCallback = null;\r\n    this.onUpdateCallback = null;\r\n    this.onRenderCallback = null;\r\n    this.onDestroyCallback = null;\r\n\r\n\r\n  }\r\n\r\n  delete this.scenes[sceneName];\r\n\r\n  }\r\n\r\n  setupScene(sceneName) {\r\n\r\n\r\n  this.currentScene = this._scenes.get(sceneName);\r\n  this.onStartCallback = this.currentScene['start'] || null;\r\n  this.onLoadingCallback = this.currentScene['loading'] || null;\r\n  this.onLoadingRenderCallback = this.currentScene['loadingRender'] || null;\r\n  this.onPreloadCallback = this.currentScene['preload'] || null;\r\n  this.onRenderCallback = this.currentScene['render'] || null;\r\n  this.onDestroyCallback = this.currentScene['destroy'] || null;\r\n\r\n  this.game.system.inject(this.currentScene);\r\n\r\n  this._currentSceneName = sceneName;\r\n\r\n  //this.game.time.refresh();\r\n\r\n\r\n  //this.currentScene.camera = this.game.world.camera;\r\n\r\n  //this.game.instance.scene = this.currentScene;\r\n\r\n  this._setup = false;\r\n\r\n  }\r\n\r\n  clearCurrentScene() {\r\n\r\n  if (this._currentSceneName)\r\n  {\r\n\r\n    this.game.system.unject(this.currentScene);\r\n\r\n    if (this.onDestroyCallback)\r\n    {\r\n        this.onDestroyCallback.call(this.currentScene, this.game);\r\n    }\r\n\r\n    if (this._clearCache)\r\n    {\r\n          this.game.cache.clear();\r\n    }\r\n\r\n    //this.game.world.destroyAllChilds();\r\n\r\n  }\r\n\r\n  }\r\n\r\n  preUpdate() {\r\n\r\n    if (!this.game.systemInited || this._changeScene == null)\r\n      return;\r\n\r\n\r\n      this.clearCurrentScene();\r\n\r\n      this.setupScene(this._changeScene);\r\n\r\n      if (this._currentSceneName !== this._changeScene)\r\n      {\r\n          return;\r\n      }\r\n      else\r\n      {\r\n          this._changeScene = null;\r\n      }\r\n\r\n      if (this.onPreloadCallback) {\r\n\r\n        this.game.system.load.reset();\r\n        this.onPreloadCallback.call(this.currentScene, this.game);\r\n\r\n        if (this.game.system.load.totalQueuedFiles === 0)\r\n        {\r\n          this.preloadComplete();\r\n\r\n        } else {\r\n\r\n          this.game.system.load.start();\r\n        }\r\n\r\n      } else {\r\n\r\n        this.preloadComplete();\r\n      }\r\n\r\n    \r\n\r\n  }\r\n\r\n  preloadComplete() {\r\n\r\n    //this.currentScene.quadtree = new tobiJS.Quadtree({x: 0, y: 0, width: 640,height: 480});\r\n\r\n      if (this._setup === false && this.onLoadingCallback)\r\n      {\r\n          this.onLoadingCallback.call(this.currentScene, this.game);\r\n      }\r\n\r\n      if (this._setup === false && this.onStartCallback)\r\n      {\r\n          this._setup  = true;\r\n          this.onStartCallback.call(this.currentScene, this.game);\r\n      }\r\n      else\r\n      {\r\n          this._setup = true;\r\n\r\n      }\r\n  }\r\n\r\n    render() {\r\n\r\n      if (this._setup) {\r\n\r\n\r\n          if (this.onRenderCallback)\r\n          {\r\n              this.onRenderCallback.call(this.currentScene, this.game);\r\n          }\r\n\r\n      } else {\r\n\r\n        if (this.onLoadingRenderCallback)\r\n        {\r\n            this.onLoadingRenderCallback.call(this.currentScene, this.game);\r\n        }\r\n\r\n\r\n      }\r\n\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n","\r\nimport MergeSort from './useful/MergeSort'\r\n\r\nexport default class DataList\r\n{\r\n    constructor(elements, unique)\r\n    {\r\n        this.unique = unique || true;\r\n        this.childs = [];\r\n\r\n        if (Array.isArray(elements))\r\n        {\r\n            for (var i = 0; i < elements.length; i++)\r\n                this.push(elements[i]);\r\n        }\r\n\r\n    }\r\n\r\n    get size() {return this.childs.length;}\r\n    get length() {return this.childs.length;}\r\n\r\n    get first() {\r\n        if (this.list.length > 0) \r\n            return this.childs[0];\r\n        else\r\n            return null;\r\n        \r\n    }\r\n\r\n    get last() {\r\n          if (this.childs.length > 0) {\r\n            let idx = this.childs.length - 1;\r\n            return this.childs[idx];\r\n          } else\r\n            return null;\r\n    }\r\n\r\n    push(child) {\r\n\r\n        if (this.unique) {\r\n            if (this.indexOf(child) === -1)\r\n                this.childs.push(child);\r\n        } else {\r\n            this.childs.push(child);\r\n        }\r\n\r\n        return child;\r\n    }\r\n\r\n    pushFront(child) {\r\n        if (this.unique) {\r\n            if (this.indexOf(child) === -1)\r\n                this.childs.unshift(child);\r\n        } else {\r\n            this.childs.unshift(child);\r\n        }\r\n        return child;\r\n    }\r\n\r\n    insert(child, index) {\r\n\r\n        if (index === undefined) \r\n            index = 0;\r\n\r\n        if (this.childs.length === 0) \r\n            return this.push(child);\r\n\r\n        if (index >= 0 && index <= this.childs.length) {\r\n        \r\n            if (this.unique) {\r\n                if (this.indexOf(child) === -1) \r\n                    this.childs.splice(index, 0, child);\r\n            } else {\r\n                this.childs.splice(index, 0, child);\r\n            }\r\n            \r\n        }\r\n\r\n        return child;\r\n    \r\n    }\r\n\r\n    indexOf(child) {\r\n        return this.childs.indexOf(child);\r\n    }\r\n\r\n    at(index) {\r\n        return this.childs[index];\r\n    }\r\n\r\n    erase(child) {\r\n\r\n        let idx = this.childs.indexOf(child);\r\n        var childToErase = null;\r\n\r\n        if (idx !== -1)\r\n            childToErase = this.childs.splice(idx, 1);\r\n        \r\n        return childToErase;\r\n    }\r\n\r\n    eraseAt(index) {\r\n        var child = this.childs[index];\r\n\r\n        if (child)\r\n            this.childs.splice(index, 1);\r\n\r\n        return child;\r\n    }\r\n\r\n    eraseList(listToRemove, size)\r\n    {\r\n        \r\n        if (size === undefined) size = listToRemove.size;\r\n\r\n        for (let i = 0; i < size; i++)\r\n        {\r\n            var child = listToRemove.childs[i];\r\n            this.erase(child);\r\n            /*let child = this.listToRemove[i];\r\n            let index = this._instances.indexOf(gameObject);\r\n\r\n            if (index > -1)\r\n               this._instances.splice(index, 1);*/\r\n            \r\n        }\r\n    }\r\n\r\n    has(child) {\r\n        return (this.childs.indexOf(child) > -1);\r\n    }\r\n\r\n    empty() {\r\n        return (this.childs.length == 0)\r\n    }\r\n\r\n    clear() {\r\n        let i = this.childs.length;\r\n\r\n        while(i--) {\r\n            this.erase(this.childs[i]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    splice(start, count) {\r\n        return this.childs.splice(start, count);\r\n    }\r\n\r\n    destroy() {\r\n        this.clear();\r\n        this.childs = [];\r\n        this.parent = null;\r\n    }\r\n\r\n    concat(otherList, clearOther)\r\n    {\r\n        if (clearOther === undefined) clearOther = false;\r\n\r\n        if (clearOther) {\r\n            this.childs = this.childs.concat(otherList.childs.splice(0));\r\n        } else {\r\n            this.childs = this.childs.concat(otherList.childs);\r\n        }\r\n\r\n        \r\n        return this;\r\n    }\r\n\r\n    each(callback) {\r\n        let params = [ null ];\r\n\r\n        var content = this.childs;\r\n\r\n        for (let i = 0; i < arguments.length; i++)\r\n            params.push(arguments[i+1]);\r\n\r\n        for (let i = 0; i < content.length; i++) {\r\n            params[0] = i;\r\n            let r = callback(content[i], params);\r\n            if (r !== undefined)\r\n                return r;\r\n           //break;\r\n        }\r\n    }\r\n\r\n    sort(predicate) {\r\n        if (predicate === undefined) return;\r\n        return MergeSort(this.childs, predicate);\r\n        \r\n        //childs.sort(predicate);\r\n    }\r\n\r\n    swap(childA, childB) {\r\n\r\n        if (childA === childB)\r\n            return;\r\n\r\n        let idx0 = this.indexOf(childA);\r\n        let idx1 = this.indexOf(childB);\r\n\r\n        if (idx0 < 0 || idx1 < 0) {\r\n            throw new Error('DataList.swap: Could not swap childrens. The objects are not in the list.');\r\n        }\r\n\r\n        this.list[idx0] = childA;\r\n        this.list[idx1] = childB;\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    swapByIndex(indexA, indexB) {\r\n        if (indexA === indexB)\r\n            return;\r\n\r\n        var cA = this.at(indexA);\r\n        var cB = this.at(indexB);\r\n\r\n        if (cA === undefined || cB === undefined) {\r\n            throw new Error('DataList.swapByIndex: Could not swap childrens by index. The objects are not in the list.');\r\n        }\r\n\r\n        this.list[indexA] = cA;\r\n        this.list[indexB] = cB;\r\n\r\n        return this;\r\n    }\r\n\r\n    reverse() {\r\n        this.childs.reverse();\r\n        return this;\r\n    }\r\n\r\n\r\n    \r\n}","\r\n\r\n\r\n// DataMap simple class\r\nexport default class DataMap {\r\n  \r\n  constructor() {\r\n    this._content = {};\r\n    this._size = 0;\r\n  }\r\n\r\n  /* \r\n  Add or set value to the map\r\n  key = keyName\r\n  value = value\r\n  */\r\n  set(key, value) {\r\n\r\n    if (!this.has(key))\r\n    {\r\n        this._size++;\r\n    }\r\n\r\n    this._content[key] = value;\r\n    \r\n    return this;\r\n\r\n  }\r\n\r\n  get(key) {\r\n      if (this.has(key))\r\n      {\r\n        return this._content[key];\r\n      }\r\n      else\r\n      {\r\n        return null;\r\n      }\r\n  }\r\n\r\n  has(key) {\r\n    return this._content.hasOwnProperty(key);\r\n  }\r\n\r\n  contains(value) {\r\n    for (var key in this._content)\r\n    {\r\n      if (entries[key] === value)\r\n      {\r\n        return true;\r\n      } else\r\n        continue;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  keys() {\r\n    return Object.keys(this._content);\r\n  }\r\n\r\n  values() {\r\n    var values = [];\r\n    var content = this._content;\r\n\r\n    for (var key in content)\r\n      values.push(entries[key]);\r\n        \r\n    return values;\r\n  }\r\n\r\n  remove(key) {\r\n\r\n    if (!this.has(key))\r\n      return null;\r\n\r\n    var prop =  this._content[key];\r\n    delete this._content[key];\r\n    this._size--;\r\n    return prop;\r\n\r\n  }\r\n\r\n  delete(key) {\r\n\r\n    if (!this.has(key))\r\n      return false;\r\n\r\n      delete this._content[key];\r\n      this._size--;\r\n\r\n      return true;\r\n  }\r\n\r\n  deleteAt(key) {\r\n\r\n    //if (!this.hasTagInKey(key))\r\n    //  return false;\r\n      this._size--;\r\n     delete this._content[key];\r\n\r\n  }\r\n\r\n  deleteByIndexedArray(array) {\r\n    for (var i = 0; i < array.length; i++) {\r\n      delete this._content[array[i]];\r\n      this._size--;\r\n    }\r\n\r\n  }\r\n\r\n  clear() {\r\n\r\n    for (var property in this._content) \r\n      delete this._content[property];\r\n    \r\n\r\n    this._size = 0;\r\n\r\n  }\r\n\r\n  slowSize() {\r\n    return Object.keys(_contents).length;\r\n  }\r\n\r\n  each(callback) {\r\n    var content = this._content;\r\n\r\n    for (var property in content) {\r\n\r\n      if (callback(property, content[property]) === false)\r\n          break;\r\n      \r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  get size() {return this._size;}\r\n\r\n}\r\n\r\n","import MergeSort from \"./useful/MergeSort\";\r\n\r\n\r\nexport default class DataSet {\r\n\r\n    constructor(elements) {\r\n        this._content = [];\r\n        this._size = 0;\r\n\r\n        if (Array.isArray(elements))\r\n        {\r\n            for (var i = 0; i < elements.length; i++)\r\n                this.set(elements[i]);\r\n        }\r\n\r\n    }\r\n\r\n    set(value) {\r\n        if (this._content.indexOf(value) === -1)\r\n            this._content.push(value);\r\n\r\n        return this;\r\n    }\r\n\r\n    at(value) {\r\n        var index = this._content.indexOf(value);\r\n        if (index > -1)\r\n        {\r\n            return this._content[index];\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    has(value) {\r\n        return (this._content.indexOf(value) > -1);\r\n    }\r\n\r\n    delete(value) {\r\n        var idx = this._content.indexOf(value);\r\n\r\n        if (idx > -1)\r\n            this._content.splice(idx, 1);\r\n\r\n        return this;\r\n    }\r\n\r\n    clear() {\r\n        this._content.length = 0;\r\n        return this;\r\n    }\r\n\r\n    each(callback, scope) {\r\n        var content = this._content.slice();\r\n        var size = content.length;\r\n        var i;\r\n\r\n        if (scope)\r\n        {\r\n            for (i = 0; i < size; i++)\r\n            {\r\n                if (callback.call(scope, content[i], i) === false)\r\n                    break;                \r\n            }\r\n        } else {\r\n            for (i = 0; i < size; i++)\r\n            {\r\n                if (callback(content[i], i) === false)\r\n                    break;                \r\n            }\r\n        }\r\n\r\n      return this;\r\n    }\r\n\r\n    sort(predicate) {\r\n        if (predicate === undefined) return;\r\n        return MergeSort(this._content, predicate);\r\n    }\r\n\r\n    get size () { return this._content.length; }\r\n    get length () { return this._content.length; }\r\n\r\n}\r\n","\r\nmodule.exports = {\r\n    Utils : require('./useful'),\r\n    Set : require('./Set'),\r\n    Map : require('./Map'),\r\n    List : require('./List'),\r\n}\r\n    ","\r\n// http://www.stoimen.com/blog/2010/07/02/friday-algorithms-javascript-merge-sort/\r\n// https://codereview.stackexchange.com/questions/87000/fast-merge-sort-in-javascript\r\nexport default function MergeSort(array, predicate)\r\n{\r\n    var size = array.length;\r\n\r\n    if (size < 2)\r\n        return array;\r\n\r\n    if (predicate === undefined)\r\n    {\r\n        predicate = function (a, b) {\r\n            return a < b ? -1 : a === b ? 0 : 1;\r\n        };\r\n    }\r\n\r\n\r\n    /*function merge(left, right)\r\n    {\r\n        var result = [];\r\n \r\n        while (left.length && right.length) {\r\n            if (left[0] <= right[0]) {\r\n                result.push(left.shift());\r\n            } else {\r\n                result.push(right.shift());\r\n            }\r\n        }\r\n     \r\n        while (left.length)\r\n            result.push(left.shift());\r\n     \r\n        while (right.length)\r\n            result.push(right.shift());\r\n     \r\n        return result;\r\n    }*/\r\n\r\n    function merge (begin, begin_right, end) {\r\n        // Create a copy of the left and right halves.\r\n        let left_size = begin_right - begin;\r\n        let right_size = end - begin_right;\r\n        let left = array.slice(begin, begin_right);\r\n        let right = array.slice(begin_right, end);\r\n        // Merge left and right halves back into original array.\r\n        let i = begin, j = 0, k = 0;\r\n        while (j < left_size && k < right_size)\r\n            if (predicate(left[j], right[k]) <= 0)\r\n                array[i++] = left[j++];\r\n            else\r\n                array[i++] = right[k++];\r\n        // At this point, at least one of the two halves is finished.\r\n        // Copy any remaining elements from left array back to original array.\r\n        while (j < left_size) \r\n            array[i++] = left[j++];\r\n        // Copy any remaining elements from right array back to original array.\r\n        while (k < right_size) \r\n            array[i++] = right[k++];\r\n\r\n        return array;\r\n    }\r\n\r\n    function msort(start, end)\r\n    {\r\n        let len = end - start;\r\n\r\n        if (len < 2)\r\n            return;\r\n\r\n        let mid = start + (len >>> 1);\r\n        //let left = list.slice(start, mid);\r\n        //let right = list.slice(mid, end);\r\n        msort(start, mid);\r\n        msort(mid, end);\r\n        return merge(start, mid, end);\r\n        \r\n    }\r\n\r\n    //let mid = 0 + (size >>> 1);\r\n\r\n    return msort(0,size);//mid,size);\r\n\r\n    \r\n}\r\n","\r\nmodule.exports = {\r\n    MergeSort : require('./MergeSort')\r\n}","\r\n// Wrapper class for game time\r\n\r\nexport default class GameTime {\r\n\r\n    constructor(game) {\r\n        this.game = game;\r\n\r\n    }\r\n\r\n    init(gameLoop) {\r\n        this._updateStep = gameLoop.updateStep;\r\n    }\r\n\r\n    get now() {\r\n        return this._updateStep.time;\r\n    }\r\n\r\n    get fps() {\r\n        return this._updateStep.fps;\r\n    }\r\n\r\n    get desiredFps() {\r\n        return this._updateStep.fpsDesired;\r\n    }\r\n\r\n    get delta() {\r\n        return this._updateStep.deltaTime;\r\n    }\r\n\r\n    get elapsed() {\r\n        return this._updateStep.elapsed;\r\n    }\r\n\r\n    get rawDelta() {\r\n        return this._updateStep.hiDeltaTime;\r\n    }\r\n\r\n}","import RequestAnimationFrame from \"../dom/RequestAnimationFrame\";\r\nimport ObjectUtils from \"../utils/ObjectUtils\";\r\nimport MathUtils from '../math/MathUtils'\r\n\r\nexport default class UpdateStep {\r\n\r\n    constructor(game, config) {\r\n        // CORE\r\n        this.game = game;\r\n        this.requestAnimationFrame = new RequestAnimationFrame(config.time.timeoutMode);\r\n        this.isRunning = false;\r\n        this.loop = null;\r\n        this.render = null;\r\n\r\n        // TIMER\r\n        this.startTime = 0; // start time\r\n        this.time = 0; // current hi-time\r\n        this.previousTime = 0; // last hi-time\r\n        this.elapsed = 0; // elapsed time\r\n        this.hiDeltaTime = 0; // raw delta time\r\n        this.deltaTime = 0; // delta time in miliseconds\r\n        // FPS\r\n        this.requireFpsUpdate = true;\r\n        this.fpsDesired = ObjectUtils.getValue(config, 'fps', config.fps);\r\n        this.fps = this.fpsDesired;\r\n        this.currentFps = 0;\r\n        this._nextFpsUpdate = 0;\r\n        this._framesThisSecond = 0;\r\n\r\n        // ACCUMALATOR METHOD\r\n        this.interpolation = false;\r\n        this.timeStep = Math.ceil(1000 / this.fpsDesired);\r\n        this.minTimeStep = this.timeStep * 1.25;\r\n        this.accumalator = 0;\r\n        this.accumulatorMax = this.timeStep * 10;\r\n        this.updateLast = 0;\r\n        this.updateAverageDelta = 0;\r\n        this.frameCounter = 0;\r\n    }\r\n\r\n    init(gameLoop) {\r\n        \r\n        if (this.isRunning)\r\n            return;\r\n\r\n        this.reset();\r\n\r\n        this.loop = gameLoop.loop.bind(gameLoop);\r\n        this.render = gameLoop.render.bind(gameLoop);\r\n\r\n        this.startTime = window.performance.now();\r\n\r\n        this.requestAnimationFrame.start(this.update.bind(this));\r\n\r\n        this.isRunning = true;\r\n\r\n    }\r\n\r\n    update(timeStamp) {\r\n\r\n        this.hiDeltaTime = timeStamp - this.previousTime;\r\n\r\n        // current\r\n        this.time = timeStamp;\r\n\r\n        // game elapsed time\r\n        this.elapsed += this.hiDeltaTime;\r\n\r\n        // FPS Update\r\n        if (this.requireFpsUpdate)\r\n            this.fpsUpdate(timeStamp);\r\n\r\n         // set previous time\r\n         this.previousTime = timeStamp;\r\n\r\n         // game loop\r\n        this.accumalatorMethod(this.hiDeltaTime);\r\n\r\n        // game render\r\n        this.render(this.hiDeltaTime);\r\n\r\n    }\r\n\r\n    fpsUpdate(timeStamp) {\r\n\r\n        \r\n\r\n        if (timeStamp > this._nextFpsUpdate) {\r\n            this.currentFps = 0.25 * this._framesThisSecond + 0.75 * this.fps;\r\n            this.fps = MathUtils.clamp(~~this.currentFps, 0, this.fpsDesired);\r\n     \r\n            this._nextFpsUpdate = timeStamp + 1000;\r\n            this._framesThisSecond = 0;\r\n        }\r\n     \r\n        this._framesThisSecond++;\r\n    }\r\n\r\n\r\n\r\n    accumalatorMethod(deltaTime) {\r\n\r\n        if ((++this.frameCounter % this.frameRate) === 0) {\r\n\r\n            this.frameCounter = 0;\r\n\r\n            this.accumalator += deltaTime;//Math.max(Math.min(this.timeStep * 3, this.elapsed),0);\r\n            this.accumulator = Math.min(this.accumalator, this.accumalatorMax); //, this.updateAverage);\r\n\r\n            let deltaUpdate = (this.interpolation) ? deltaTime : this.timeStep;\r\n            let accumulatorUpdateDelta = (this.interpolation) ? deltaUpdate : Math.max(deltaUpdate, this.updateAverageDelta);\r\n            this.deltaTime = deltaUpdate / 1000;\r\n\r\n            while (this.accumalator >= accumulatorUpdateDelta || this.interpolation) {\r\n\r\n                let updateStart = window.performance.now();\r\n\r\n                // UPDATE GAME\r\n                this.loop(deltaUpdate / 1000);\r\n\r\n                let updateLast = window.performance.now();\r\n                this.updateAverageDelta = updateLast - updateStart;\r\n\r\n                this.accumalator -= accumulatorUpdateDelta;\r\n                if (this.interpolation) {\r\n                    this.accumalator = 0;\r\n                    break;\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    accumalatorReset() {\r\n        this.frameCounter = 0;\r\n        this.frameRate = ~~(0.5 + 60 / this.fpsDesired);\r\n        this.accumalator = 0;\r\n        this.timeStep = 1000 / this.fpsDesired;\r\n        this.accumulatorMax = this.stepSize * 10;\r\n    }\r\n    \r\n    reset() {\r\n        let now = window.performance.now();\r\n\r\n        this.deltaTime = 0;\r\n        this.hiDeltaTime = 0;\r\n        this.time = now;\r\n        this.previousTimeTime = now;\r\n        this._nextFpsUpdate = now + 1000;\r\n        this._framesThisSecond = 0;\r\n\r\n        this.accumalatorReset();\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n/*\r\nif (this.game.systemInited) {\r\n\r\n    this.time.update(time);\r\n\r\n    if (this._spiraling > 1) {\r\n\r\n        this.time.deltaTime = 0;\r\n        this._spiraling = 0;\r\n        this.time.accumalator = 0;\r\n\r\n        this.render(this.time.accumulatorDelta);\r\n\r\n    } else {\r\n\r\n    var countFrames = 0;\r\n\r\n    while (this.time.accumalator >= this.time.accumulatorDelta) {\r\n\r\n      //  this.time.updateStart = window.performance.now();\r\n\r\n        this.time.deltaTime = Math.min(this.time.accumalator,this.time.accumulatorDelta) / 1000;\r\n\r\n        this.logic(this.time.deltaTime);\r\n\r\n        //this.time.updateLast =  window.performance.now();\r\n      //  this.time.updateAverage = this.time.updateLast - this.time.updateStart;\r\n\r\n        this.time.accumalator -= this.time.accumulatorDelta;\r\n\r\n        countFrames++;\r\n\r\n        this.time.refresh();\r\n\r\n        if (countFrames >= 240) { // SPIRAL\r\n            //panic();\r\n            this.time.accumalator = 0;\r\n\r\n            break;\r\n        }\r\n    }\r\n\r\n      if (countFrames > this._lastFrameCount)\r\n         this._spiraling++;\r\n     else if (countFrames < this._lastFrameCount)\r\n        this._spiraling = 0;\r\n\r\n        this._lastFrameCount = countFrames;\r\n\r\n        this.render(this.time.accumalator/this.time.accumulatorDelta);\r\n\r\n    }\r\n\r\n\r\n\r\n}*/","\r\nexport default function ComputeBounds(bounds, transform, width, height, origin) {\r\n    \r\n  if (origin === undefined) origin = {x:0,y:0}\r\n\r\n    let top = transform.matrix.transformPoint(-origin.x, -origin.y);\r\n    let left = transform.matrix.transformPoint(width - origin.x, -origin.y);\r\n    let bottom = transform.matrix.transformPoint(-origin.x, height - origin.y);\r\n    let right = transform.matrix.transformPoint(width - origin.x, height - origin.y);\r\n  \r\n    bounds.min.x = Math.min(top.x,left.x,bottom.x,right.x);\r\n    bounds.min.y = Math.min(top.y,left.y,bottom.y,right.y);\r\n    bounds.max.x = Math.max(top.x,left.x,bottom.x,right.x);\r\n    bounds.max.y = Math.max(top.y,left.y,bottom.y,right.y);\r\n  \r\n  }","\r\n\r\nexport default function ComputeDelimiterPoint(x, y, rotation, anchor) {\r\n\r\n    let coord = {x:0, y:0};\r\n\r\n\r\n    if (anchor === undefined) {\r\n        coord.x = (x * rotation.x) - (y * rotation.y);\r\n        coord.y = (x * rotation.y) - (y * rotation.x);\r\n    } else {\r\n      \r\n        \r\n        let xa = x - anchor.x;\r\n        let ya = y - anchor.y;\r\n    // cx = anchor.x + ((x-anchor.x) * Math.cos(rotation)) - ((y-anchor.y) * Math.sin(rotation));\r\n        coord.x = anchor.x + (xa * rotation.x) - (ya * rotation.y);\r\n    // cy = anchor.y - ((x-anchor.x) * Math.sin(rotation)) - ((y-anchor.y) * Math.cos(rotation));\r\n        coord.y = anchor.y - (xa * rotation.y) - (ya * rotation.x);\r\n    }\r\n\r\n    return coord;\r\n}","\r\nimport Vector from '../math/Vector'\r\nimport Matrix from '../math/Matrix'\r\nimport BoundingBox from '../math/BoundingBox'\r\n\r\nexport default class Transform {\r\n\r\n\r\n  constructor() {\r\n\r\n    this.matrix = new Matrix(1);\r\n    this.position = new Vector(0,0, this);\r\n    this.scale = new Vector(1,1, this);\r\n    this.origin = new Vector(0,0, this);\r\n    this.angle = 0;\r\n    this.rotation = 0;\r\n    this._cosSin = {x:1,y:0};\r\n    this._oldRotation = -1;\r\n    this._isDirty = true;\r\n    //this.worldPosition = new Vector(0,0);\r\n    //this.worldScale =  new Vector(1,1);\r\n    //this.worldRotation = 0;\r\n    //this.bounds = new BoundingBox(0,0,1,1); // the full bounds of the node - defined by render\r\n    //this.globalBounds = new BoundingBox(0,0,1,1); // defined by render\r\n  }\r\n\r\n  markDirty() {\r\n    this._isDirty = true;\r\n  }\r\n\r\n    destroy() {\r\n\r\n      delete this.position;\r\n      delete this.scale;\r\n      delete this.matrix;\r\n      delete this.worldPosition;\r\n      delete this.worldScale;\r\n      delete this.origin;\r\n      delete this.bounds;\r\n      delete this.globalBounds;\r\n      delete this._cosSin;\r\n\r\n    }\r\n\r\n    reset() {\r\n      this.matrix.setIdentity();\r\n      this._isDirty = true;\r\n      this._cosSin.x = 1;\r\n      this._cosSin.y = 0;\r\n      this.position.set(0,0);\r\n      this.angle = 0;\r\n      this.rotation = 0;\r\n      this._oldRotation = 0;\r\n      this.origin.set(0,0);\r\n      this.scale.set(0,0);\r\n\r\n    }\r\n  }\r\n\r\n","import ComputeDelimiterPoint from \"./ComputeDelimiterPoint\";\r\n\r\n\r\nexport default function UpdateBounds(bounds, x, y, width, height, cosSin, origin) {\r\n\r\n    let coords = [];\r\n\r\n    coords[0] = ComputeDelimiterPoint( x, y, cosSin, origin);\r\n    coords[1] = ComputeDelimiterPoint( x + width,  y, cosSin, origin);\r\n    coords[2] = ComputeDelimiterPoint( x , y + height, cosSin, origin);\r\n    coords[3] = ComputeDelimiterPoint( x + width , y + height, cosSin, origin);\r\n  \r\n    bounds.min.x = Math.min(coords[0].x,coords[1].x,coords[2].x,coords[3].x);\r\n    bounds.min.y = Math.min(coords[0].y,coords[1].y,coords[2].y,coords[3].y);\r\n\r\n    bounds.max.x = Math.max(coords[0].x,coords[1].x,coords[2].x,coords[3].x);\r\n    bounds.max.y = Math.max(coords[0].y,coords[1].y,coords[2].y,coords[3].y);\r\n\r\n    \r\n\r\n}","\r\nimport MathUtils from '../math/MathUtils'\r\nimport Matrix from '../math/Matrix'\r\n\r\n/*\r\n\r\n* | a | b | x |\r\n* | c | d | y |\r\n* | 0 | 0 | 1 |\r\n\r\n* | 0 | 3 | 6 | * | a | d | x |\r\n* | 1 | 4 | 7 | * | b | e | y |\r\n* | 2 | 5 | 8 | * | c | f | 1 |\r\n\r\n*/\r\n\r\nexport default function UpdateTransform(transform, parentTransform) {\r\n\r\n    //if (parentMatrix === undefined) parentMatrix = null;\r\n    if (!transform._isDirty && !parentTransform._isDirty)\r\n        return;\r\n\r\n\r\n    transform.rotation = transform.angle * MathUtils.degToRad;\r\n\r\n     // if (transform.rotation % MathUtils.TAU) {\r\n      \r\n\r\n        if (transform.rotation !== transform._oldRotation)\r\n        {\r\n            transform._oldRotation = transform.rotation;\r\n            transform._cosSin.y = Math.sin(transform.rotation);\r\n            transform._cosSin.x = Math.cos(transform.rotation);\r\n        }\r\n\r\n\r\n        transform.matrix.setModelMatrix(\r\n          transform.position, \r\n          transform.scale, \r\n          transform._cosSin, \r\n          transform.origin)\r\n        .concat(parentTransform.matrix);\r\n\r\n\r\n\r\n     // } else {\r\n\r\n        /*a  = transform.scale.x;\r\n        d  = transform.scale.y;\r\n        x =  transform.position.x;\r\n        y =  transform.position.y;\r\n        x -= transform.origin.x * a;\r\n        y -= transform.origin.y * d;\r\n\r\n        wt.a  = a  * pt.a;\r\n        wt.b  = a  * pt.b;\r\n        wt.c  = d  * pt.c;\r\n        wt.d  = d  * pt.d;\r\n        wt.x = x * pt.a + y * pt.c + pt.x;\r\n        wt.y = x * pt.b + y * pt.d + pt.y;*/\r\n\r\n\r\n    //  }\r\n\r\n      //transform.worldPosition.set(wt.x ,wt.y);\r\n      //transform.worldScale.set(Math.sqrt(wt.a * wt.a + wt.b * wt.b), Math.sqrt(wt.c * wt.c + wt.d * wt.d));\r\n      //transform.worldRotation = Math.atan2(-wt.c, wt.d);\r\n    \r\n}\r\n","\r\nimport MathUtils from '../math/MathUtils'\r\nimport Vector from '../math/Vector'\r\nimport ComputeDelimiterPoint from './ComputeDelimiterPoint';\r\n\r\n\r\n\r\nexport default function UpdateTransformBounds(bounds, frame, transform) {\r\n    \r\n  let coords = [];\r\n /* let scale = Vector.abs(transform.scale);\r\n  let pos = transform.position;\r\n  let anchor = transform.origin;\r\n  let size = {\r\n    x : frame.width * scale.x,\r\n    y : frame.height * scale.y\r\n  };\r\n\r\n  anchor.x *= scale.x;\r\n  anchor.y *= scale.y;\r\n  pos.x -= anchor.x;\r\n  pos.y -= anchor.y;\r\n  anchor.x += pos.x;\r\n  anchor.y += pos.y;*/\r\n  \r\n  //coords[0] = ComputeDelimiterPoint( pos.x, pos.y, transform._cosSin, anchor);\r\n  //coords[1] = ComputeDelimiterPoint( pos.x + size.x,  pos.y, transform._cosSin, anchor);\r\n  //coords[2] = ComputeDelimiterPoint( pos.x , pos.y + size.y, transform._cosSin, anchor);\r\n  //coords[3] = ComputeDelimiterPoint( pos.x + size.x , pos.y + size.y, transform._cosSin, anchor);\r\n\r\n  let top = transform.matrix.transformPoint(0, 0);\r\n  let left = transform.matrix.transformPoint(frame.width, 0);\r\n  let bottom = transform.matrix.transformPoint(0, frame.height);\r\n  let right = transform.matrix.transformPoint(frame.width, frame.height);\r\n\r\n  bounds.min.x = Math.min(top.x,left.x,bottom.x,right.x);\r\n  bounds.min.y = Math.min(top.y,left.y,bottom.y,right.y);\r\n  bounds.max.x = Math.max(top.x,left.x,bottom.x,right.x);\r\n  bounds.max.y = Math.max(top.y,left.y,bottom.y,right.y);\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n  // position (vector)\r\n  // scale (vector)\r\n  // rotation (vector x = cos, y = sin)\r\n  /*\r\n  setup(pos, scale, rotation, anchor, width, height) {\r\n\r\n    var coords = [];\r\n    var negx = 1;\r\n    var negy = 1;\r\n\r\n    if (scale.x < 0)\r\n          negx = -1;\r\n    if (scale.y < 0)\r\n          negy = -1;\r\n\r\n\r\n\r\n    this.size.x = width*scale.x*negx;\r\n    this.size.y = height*scale.y*negy;\r\n    anchor.x *= scale.x*negx;\r\n    anchor.y *= scale.y*negy;\r\n    pos.x -= anchor.x;\r\n    pos.y -= anchor.y;\r\n    anchor.x += pos.x;\r\n    anchor.y += pos.y;\r\n\r\n    var callback = null;\r\n\r\n    if (rotation instanceof  scintilla.Vector)\r\n        callback = this['calcCoordsCosSin'];\r\n      else\r\n        callback = this['calcCoords'];\r\n\r\n    coords[0] = callback( pos.x, pos.y, anchor, rotation);\r\n    coords[1] = callback( pos.x + this.size.x,  pos.y, anchor,rotation);\r\n\r\n    coords[2] = callback( pos.x , pos.y + this.size.y, anchor,rotation);\r\n    coords[3] = callback( pos.x + this.size.x , pos.y + this.size.y,anchor, rotation);\r\n\r\n\r\n\r\n    this.min.x = Math.min(coords[0].x,coords[1].x,coords[2].x,coords[3].x);\r\n    this.min.y = Math.min(coords[0].y,coords[1].y,coords[2].y,coords[3].y);\r\n\r\n    this.max.x = Math.max(coords[0].x,coords[1].x,coords[2].x,coords[3].x);\r\n    this.max.y = Math.max(coords[0].y,coords[1].y,coords[2].y,coords[3].y);\r\n    this.center.x = pos.x+(this.max.x-this.min.x)/2;\r\n    this.center.y = pos.y+(this.max.y-this.min.y)/2;\r\n    this.box.set(this.min.x,this.min.y,this.max.x-this.min.x,this.max.y-this.min.y);\r\n\r\n  }\r\n\r\n\r\n  setByGameObject(gameObject, local) {\r\n\r\n    //if (gameObject.render != null) {\r\n\r\n      if (local) {\r\n        this.setup(gameObject.position,\r\n                gameObject.scale,\r\n                gameObject._cosSin,\r\n                gameObject.render.origin,\r\n                gameObject.render.width,\r\n                gameObject.render.height\r\n              );\r\n      } else {\r\n\r\n        var frame = gameObject.component['render'].frame;\r\n\r\n        var pos = {x:gameObject.worldPosition.x, y:gameObject.worldPosition.y};\r\n        var org = {\r\n          x:gameObject.origin.x * frame.width,\r\n          y:gameObject.origin.y * frame.height};\r\n\r\n        pos.x += gameObject.game.camera.view.x;\r\n        pos.y += gameObject.game.camera.view.y;\r\n\r\n        this.setup(pos,\r\n                gameObject.worldScale,\r\n                gameObject.worldRotation,\r\n                org,\r\n                frame.width,\r\n                frame.height\r\n              );\r\n      }\r\n\r\n\r\n    return this;\r\n\r\n\r\n  }\r\n\r\n\r\n  setByShape(shape,position) {\r\n\r\n\r\n    var minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\r\n    var type = shape.getType();\r\n\r\n    if (type == \"Polygon\") {\r\n\r\n      var points = shape.getPoints();\r\n\r\n      points.forEach(function (point) {\r\n          minX = Math.min(minX, point.x);\r\n          minY = Math.min(minY, point.y);\r\n          maxX = Math.max(maxX, point.x);\r\n          maxY = Math.max(maxY, point.y);\r\n\r\n      });\r\n    }\r\n\r\n    if (position !== undefined) {\r\n      minX += position.x;\r\n      minY += position.y;\r\n      maxX += position.x;\r\n      maxY += position.y;\r\n    }\r\n\r\n\r\n    this.min.set(minX,minY);\r\n    this.max.set(maxX,maxY)\r\n    this.box.set(minX,minY,maxX-minX,maxY-minY);\r\n\r\n  }\r\n\r\n  calcCoordsCosSin(x, y, anchor, cos_and_sin) {\r\n\r\n    var coord = {x:0,y:0};\r\n\r\n    coord.x = anchor.x + ((x-anchor.x) * cos_and_sin.x) - ((y-anchor.y) * cos_and_sin.y);\r\n    coord.y = anchor.y - ((x-anchor.x) * cos_and_sin.y) - ((y-anchor.y) * cos_and_sin.x);\r\n\r\n      return coord;\r\n\r\n  }\r\n\r\n  calcCoords(x,y,anchor,rotation) {\r\n\r\n    var coord = {x:0,y:0};\r\n\r\n    coord.x = anchor.x + ((x-anchor.x) * Math.cos(rotation)) - ((y-anchor.y) * Math.sin(rotation));\r\n    coord.y = anchor.y - ((x-anchor.x) * Math.sin(rotation)) - ((y-anchor.y) * Math.cos(rotation));\r\n\r\n      return coord;\r\n\r\n  }*/","\r\nconst Base64Utils = {\r\n    decode(str) {\r\n        return window.atob(str);\r\n        // Base64.decode(encodedString);\r\n    },\r\n\r\n    decodeToUint32(str) {\r\n        let bin = window.atob(str);\r\n        let len = bin.length;\r\n        let bytes = new Array(len);\r\n\r\n        for (let i = 0; i < len; i += 4) {\r\n            bytes[i / 4] = (\r\n                bin.charCodeAt(i) |\r\n                bin.charCodeAt(i + 1) << 8 |\r\n                bin.charCodeAt(i + 2) << 16 |\r\n                bin.charCodeAt(i + 3) << 24\r\n            ) >>> 0;\r\n        }\r\n\r\n        return bytes;\r\n    },\r\n\r\n    encode(str) {\r\n        return window.btoa(str);\r\n        // Base64.encode(string);\r\n    }\r\n}\r\n\r\nexport default Base64Utils;","\r\nexport const Color = {\r\n\r\nrgba : function(r,g,b,a) {\r\n\r\n  return 'rgba(' + r.toString() + ',' + g.toString() + ',' + b.toString() + ',' + (a / 255).toString() + ')';\r\n\r\n},\r\n\r\n/*\r\nSource code: https://github.com/mjackson/mjijackson.github.com/blob/master/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript.txt\r\n*/\r\nHSLtoRGB : function(h,s,l,a) {\r\n\r\n  var alp = 255;\r\n\r\n  if (a !== undefined || a !== null)\r\n    alp = a;\r\n\r\n  h = h / 255.0;\r\n  s = s / 255.0;\r\n  l = l / 255.0;\r\n\r\n  var result = {r:l,b:l,g:l};\r\n\r\n  if (s !== 0)\r\n  {\r\n      var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n      var p = 2 * l - q;\r\n      result.r = this.hueToColor(p, q, h + 1 / 3);\r\n      result.g = this.hueToColor(p, q, h);\r\n      result.b = this.hueToColor(p, q, h - 1 / 3);\r\n  }\r\n\r\n  result.r = Math.floor((result.r * 255));\r\n  result.g = Math.floor((result.g * 255));\r\n  result.b = Math.floor((result.b * 255));\r\n\r\n\r\n  return this.rgba(result.r,result.g,result.b,alp);\r\n\r\n},\r\n\r\n/*\r\nSource code: https://github.com/mjackson/mjijackson.github.com/blob/master/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript.txt\r\n*/\r\nhueToColor : function(p, q, t) {\r\n\r\n  if (t < 0)\r\n    t += 1;\r\n\r\n  if (t > 1)\r\n    t -= 1;\r\n\r\n  if (t < 1 / 6)\r\n      return p + (q - p) * 6 * t;\r\n\r\n  if (t < 1 / 2)\r\n      return q;\r\n\r\n  if (t < 2 / 3)\r\n      return p + (q - p) * (2 / 3 - t) * 6;\r\n\r\n  return p;\r\n\r\n},\r\n\r\n/*\r\nSource code: http://jsfiddle.net/mushigh/myoskaos/\r\n*/\r\nrgbToHex : function(r,g,b) {\r\n\r\n  return \"#\" + this.componentToHex(r) + this.componentToHex(g) + this.componentToHex(b);\r\n\r\n},\r\n\r\n/*\r\nSource code: http://jsfiddle.net/mushigh/myoskaos/\r\n*/\r\ncomponentToHex : function(c) {\r\n    var hex = c.toString(16);\r\n    return hex.length == 1 ? \"0\" + hex : hex;\r\n}\r\n\r\n}\r\n\r\nmodule.exports = Color;\r\n","\r\nclass ObjectUtils {\r\n\r\n    isFunction(obj) {\r\n    return !!(obj && obj.constructor && obj.call && obj.apply);\r\n  }\r\n\r\n  getValue(obj, key, defaultValue)\r\n  {\r\n    var type = typeof(obj);\r\n\r\n    if (!obj || type === 'number' || type === 'string')\r\n        return defaultValue;\r\n    else if (obj.hasOwnProperty(key) && obj[key] !== undefined)\r\n        return obj[key];\r\n    else\r\n        return defaultValue;\r\n\r\n  }\r\n\r\n  // Get value in complex object\r\n  getPropertyValue(source, key, defaultValue)\r\n    {\r\n        if (!source || typeof source === 'number')\r\n            return defaultValue;\r\n        else if (source.hasOwnProperty(key))\r\n            return source[key];\r\n        else if (key.indexOf('.'))\r\n        {\r\n            var keys = key.split('.');\r\n            var parent = source;\r\n            var value = defaultValue;\r\n\r\n            for (var i = 0; i < keys.length; i++)\r\n            {\r\n                if (parent.hasOwnProperty(keys[i]))\r\n                {\r\n                    value = parent[keys[i]];\r\n                    parent = parent[keys[i]];\r\n                }\r\n                else\r\n                {\r\n                    value = defaultValue;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            return value;\r\n        }\r\n        else\r\n        {\r\n            return defaultValue;\r\n        }\r\n    }\r\n\r\n  getURL(url, baseURL)\r\n  {\r\n    if (!url)\r\n        return null;\r\n    \r\n        \r\n    if (url.match(/^(?:blob:|data:|http:\\/\\/|https:\\/\\/|\\/\\/)/))\r\n        return url;\r\n    else\r\n        return baseURL + url;\r\n  }\r\n\r\n};\r\n\r\nexport default new ObjectUtils();","\r\nconst Path = {\r\n\r\n  getExtension(filename) {\r\n    return filename.substring(filename.lastIndexOf('.')+1, filename.length) || \"\";\r\n  },\r\n\r\n  getFilename(path) {\r\n    return path.split('\\\\').pop().split('/').pop() || path;\r\n  },\r\n  \r\n  getFilenameWithoutExtension(path) {\r\n    return this.removeExtension(this.getFilename(path));\r\n  },\r\n\r\n  removeExtension(path) {\r\n    return path.substr(0, path.lastIndexOf('.')) || path;\r\n  },\r\n\r\n  getPath(path) {\r\n    return path.substr(0, path.lastIndexOf(\"/\") + 1) || \"\";\r\n  },\r\n\r\n  getRootPath(path) {\r\n    return path.substr(0, path.indexOf(\"/\") + 1) || path;\r\n  },\r\n\r\n  getPathWithoutRoot(path) {\r\n    let s = (path.indexOf(\"/\") + 1) || 0;\r\n    let l = (path.lastIndexOf(\"/\") - s + 1) || path.length;\r\n    return path.substr(s, l) || path;\r\n  },\r\n\r\n  getDirectoryName(path) {\r\n      let dir = path.split('/');\r\n      let len = dir.length;\r\n      if (len <= 1)\r\n        return dir[dir.length - 1];\r\n      else\r\n        return dir[dir.length - 2];\r\n  },\r\n\r\n}\r\n\r\nexport default Path;"],"sourceRoot":""}